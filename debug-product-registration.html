<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆë“±ë¡ ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">ğŸ› ï¸ ìƒí’ˆë“±ë¡ ê¸°ëŠ¥ ì§„ë‹¨</h1>
        
        <div class="space-y-4">
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">1. ë©”ì¸ ì‹œìŠ¤í…œì—ì„œ í…ŒìŠ¤íŠ¸</h2>
                <button onclick="testMainSystem()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    ë©”ì¸ ì‹œìŠ¤í…œì—ì„œ ìƒí’ˆë“±ë¡ í…ŒìŠ¤íŠ¸
                </button>
                <div id="main-test-result" class="mt-2 text-sm"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">2. DOM ìš”ì†Œ ì¡´ì¬ í™•ì¸</h2>
                <button onclick="checkDOMElements()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                    DOM ìš”ì†Œ í™•ì¸
                </button>
                <div id="dom-check-result" class="mt-2 text-sm"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">3. JavaScript í•¨ìˆ˜ ì¡´ì¬ í™•ì¸</h2>
                <button onclick="checkJSFunctions()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    JavaScript í•¨ìˆ˜ í™•ì¸
                </button>
                <div id="js-check-result" class="mt-2 text-sm"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">4. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í™•ì¸</h2>
                <button onclick="checkEventListeners()" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600">
                    ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í™•ì¸
                </button>
                <div id="event-check-result" class="mt-2 text-sm"></div>
            </div>
        </div>
        
        <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
            <h3 class="font-semibold text-yellow-800">ğŸ“‹ ì§„ë‹¨ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</h3>
            <div id="diagnosis-result" class="mt-2 text-sm text-yellow-700"></div>
        </div>
    </div>

    <script>
        function testMainSystem() {
            const result = document.getElementById('main-test-result');
            
            // iframeìœ¼ë¡œ ë©”ì¸ ì‹œìŠ¤í…œ ë¡œë“œí•˜ì—¬ í…ŒìŠ¤íŠ¸
            const iframe = document.createElement('iframe');
            iframe.src = 'index.html';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            iframe.onload = function() {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const addProductBtn = iframeDoc.getElementById('add-product-btn');
                    
                    if (addProductBtn) {
                        result.innerHTML = '<span class="text-green-600">âœ… ìƒí’ˆë“±ë¡ ë²„íŠ¼ ë°œê²¬ë¨</span>';
                        
                        // ë²„íŠ¼ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜
                        addProductBtn.click();
                        
                        setTimeout(() => {
                            const modal = iframeDoc.getElementById('product-modal');
                            if (modal && !modal.classList.contains('hidden')) {
                                result.innerHTML += '<br><span class="text-green-600">âœ… ëª¨ë‹¬ì°½ ì •ìƒ ì—´ë¦¼</span>';
                            } else {
                                result.innerHTML += '<br><span class="text-red-600">âŒ ëª¨ë‹¬ì°½ì´ ì—´ë¦¬ì§€ ì•ŠìŒ</span>';
                            }
                        }, 500);
                        
                    } else {
                        result.innerHTML = '<span class="text-red-600">âŒ ìƒí’ˆë“±ë¡ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ</span>';
                    }
                } catch (error) {
                    result.innerHTML = '<span class="text-red-600">âŒ í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜: ' + error.message + '</span>';
                }
                
                // ì •ë¦¬
                setTimeout(() => {
                    document.body.removeChild(iframe);
                }, 2000);
            };
        }
        
        function checkDOMElements() {
            const result = document.getElementById('dom-check-result');
            const iframe = document.createElement('iframe');
            iframe.src = 'index.html';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            iframe.onload = function() {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const elements = [
                        'add-product-btn',
                        'product-modal',
                        'product-form-name',
                        'product-form-category',
                        'product-form-price'
                    ];
                    
                    let output = '<ul class="list-disc list-inside">';
                    elements.forEach(id => {
                        const element = iframeDoc.getElementById(id);
                        if (element) {
                            output += `<li class="text-green-600">âœ… ${id} - ì¡´ì¬í•¨</li>`;
                        } else {
                            output += `<li class="text-red-600">âŒ ${id} - ì—†ìŒ</li>`;
                        }
                    });
                    output += '</ul>';
                    
                    result.innerHTML = output;
                } catch (error) {
                    result.innerHTML = '<span class="text-red-600">âŒ DOM í™•ì¸ ì¤‘ ì˜¤ë¥˜: ' + error.message + '</span>';
                }
                
                setTimeout(() => {
                    document.body.removeChild(iframe);
                }, 1000);
            };
        }
        
        function checkJSFunctions() {
            const result = document.getElementById('js-check-result');
            
            window.open('index.html', '_blank').onload = function() {
                // ìƒˆ ì°½ì—ì„œ í™•ì¸ (CORS ì œí•œìœ¼ë¡œ ì¸í•´ ì½˜ì†” ë©”ì‹œì§€ë¡œ ì•ˆë‚´)
                result.innerHTML = `
                    <div class="text-blue-600">
                        ğŸ“‹ ìƒˆ ì°½ì´ ì—´ë ¸ìŠµë‹ˆë‹¤. ê°œë°œì ë„êµ¬(F12)ë¥¼ ì—´ê³  ì½˜ì†”ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:
                        <pre class="bg-gray-100 p-2 mt-2 rounded text-xs">
orderSystem.openProductModal(); // ëª¨ë‹¬ ì—´ê¸° í…ŒìŠ¤íŠ¸
console.log(typeof orderSystem.saveProduct); // í•¨ìˆ˜ ì¡´ì¬ í™•ì¸
                        </pre>
                    </div>
                `;
            };
        }
        
        function checkEventListeners() {
            const result = document.getElementById('event-check-result');
            result.innerHTML = `
                <div class="text-blue-600">
                    ğŸ“‹ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í™•ì¸ì„ ìœ„í•´ ë©”ì¸ ì‹œìŠ¤í…œ(index.html)ì„ ì—´ê³  ê°œë°œì ë„êµ¬ì—ì„œ í™•ì¸í•˜ì„¸ìš”:
                    <pre class="bg-gray-100 p-2 mt-2 rounded text-xs">
// ë²„íŠ¼ ìš”ì†Œ í™•ì¸
const btn = document.getElementById('add-product-btn');
console.log('ë²„íŠ¼ ì¡´ì¬:', !!btn);

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í™•ì¸ (í¬ë¡¬ì—ì„œ)
getEventListeners(btn);

// ìˆ˜ë™ìœ¼ë¡œ ì´ë²¤íŠ¸ ë°œìƒ
btn.click();
                    </pre>
                </div>
            `;
        }
    </script>
</body>
</html>