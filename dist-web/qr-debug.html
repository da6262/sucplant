<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ› ï¸ QR ì½”ë“œ ë””ë²„ê·¸ ë„êµ¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">ğŸ› ï¸ QR ì½”ë“œ ë””ë²„ê·¸ ë„êµ¬</h1>
        
        <div class="space-y-4">
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">1. QR ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒíƒœ í™•ì¸</h2>
                <button onclick="checkQRLibrary()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    QR ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒíƒœ í™•ì¸
                </button>
                <div id="qr-check-result" class="mt-2 text-sm"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">2. QR ì½”ë“œ ì„ì‹œ ë¹„í™œì„±í™”</h2>
                <button onclick="disableQR()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                    QR ì½”ë“œ ê¸°ëŠ¥ ë¹„í™œì„±í™”
                </button>
                <button onclick="enableQR()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 ml-2">
                    QR ì½”ë“œ ê¸°ëŠ¥ í™œì„±í™”
                </button>
                <div id="qr-toggle-result" class="mt-2 text-sm"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg shadow">
                <h2 class="font-semibold mb-2">3. ìƒí’ˆë“±ë¡ í…ŒìŠ¤íŠ¸ (QR ì—†ì´)</h2>
                <button onclick="testProductWithoutQR()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    QR ì—†ì´ ìƒí’ˆë“±ë¡ í…ŒìŠ¤íŠ¸
                </button>
                <div id="product-test-result" class="mt-2 text-sm"></div>
            </div>
        </div>
        
        <div class="mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <h3 class="font-semibold text-blue-800">ğŸ“‹ ì‚¬ìš©ë²•</h3>
            <ol class="mt-2 text-sm text-blue-700 list-decimal list-inside space-y-1">
                <li>ë¨¼ì € QR ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”</li>
                <li>ë¬¸ì œê°€ ìˆìœ¼ë©´ QR ì½”ë“œë¥¼ ì„ì‹œ ë¹„í™œì„±í™”í•˜ì„¸ìš”</li>
                <li>ë©”ì¸ ì‹œìŠ¤í…œì—ì„œ ìƒí’ˆë“±ë¡ì„ ì‹œë„í•˜ì„¸ìš”</li>
                <li>ë“±ë¡ ì„±ê³µ í›„ QR ì½”ë“œë¥¼ ë‹¤ì‹œ í™œì„±í™”í•˜ì„¸ìš”</li>
            </ol>
        </div>
    </div>

    <script>
        function checkQRLibrary() {
            const result = document.getElementById('qr-check-result');
            
            let status = '<ul class="list-disc list-inside">';
            
            // QRious ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
            if (typeof QRious !== 'undefined') {
                status += '<li class="text-green-600">âœ… QRious ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œë¨</li>';
            } else {
                status += '<li class="text-red-600">âŒ QRious ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ìŒ</li>';
            }
            
            // ì „ì—­ ë³€ìˆ˜ í™•ì¸
            if (window.QRCodeDisabled) {
                status += '<li class="text-orange-600">âš ï¸ QR ì½”ë“œ ê¸°ëŠ¥ ë¹„í™œì„±í™”ë¨</li>';
            } else {
                status += '<li class="text-green-600">âœ… QR ì½”ë“œ ê¸°ëŠ¥ í™œì„±í™”ë¨</li>';
            }
            
            // ë©”ì¸ ì‹œìŠ¤í…œ ì—°ê²° í™•ì¸
            try {
                const iframe = document.createElement('iframe');
                iframe.src = 'index.html';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                iframe.onload = function() {
                    const iframeWindow = iframe.contentWindow;
                    if (iframeWindow.orderSystem && typeof iframeWindow.orderSystem.generateQRCodeBase64 === 'function') {
                        status += '<li class="text-green-600">âœ… ë©”ì¸ ì‹œìŠ¤í…œ QR í•¨ìˆ˜ ì¡´ì¬</li>';
                    } else {
                        status += '<li class="text-red-600">âŒ ë©”ì¸ ì‹œìŠ¤í…œ QR í•¨ìˆ˜ ì—†ìŒ</li>';
                    }
                    
                    status += '</ul>';
                    result.innerHTML = status;
                    
                    // ì •ë¦¬
                    setTimeout(() => {
                        document.body.removeChild(iframe);
                    }, 1000);
                };
            } catch (error) {
                status += '<li class="text-red-600">âŒ ë©”ì¸ ì‹œìŠ¤í…œ ì—°ê²° ì‹¤íŒ¨</li>';
                status += '</ul>';
                result.innerHTML = status;
            }
        }
        
        function disableQR() {
            window.QRCodeDisabled = true;
            localStorage.setItem('qr_disabled', 'true');
            
            // ë©”ì¸ ì‹œìŠ¤í…œì—ë„ ì ìš©
            try {
                const iframe = document.createElement('iframe');
                iframe.src = 'index.html';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                iframe.onload = function() {
                    iframe.contentWindow.QRCodeDisabled = true;
                    iframe.contentWindow.localStorage.setItem('qr_disabled', 'true');
                    
                    document.getElementById('qr-toggle-result').innerHTML = 
                        '<span class="text-orange-600">âš ï¸ QR ì½”ë“œ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ìƒí’ˆë“±ë¡ì„ ì‹œë„í•´ë³´ì„¸ìš”.</span>';
                    
                    setTimeout(() => {
                        document.body.removeChild(iframe);
                    }, 1000);
                };
            } catch (error) {
                document.getElementById('qr-toggle-result').innerHTML = 
                    '<span class="text-red-600">âŒ QR ë¹„í™œì„±í™” ì¤‘ ì˜¤ë¥˜: ' + error.message + '</span>';
            }
        }
        
        function enableQR() {
            window.QRCodeDisabled = false;
            localStorage.removeItem('qr_disabled');
            
            document.getElementById('qr-toggle-result').innerHTML = 
                '<span class="text-green-600">âœ… QR ì½”ë“œ ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</span>';
        }
        
        function testProductWithoutQR() {
            const result = document.getElementById('product-test-result');
            
            // ì„ì‹œë¡œ QR ë¹„í™œì„±í™”í•˜ê³  í…ŒìŠ¤íŠ¸
            const originalQRState = window.QRCodeDisabled;
            window.QRCodeDisabled = true;
            
            result.innerHTML = `
                <div class="text-blue-600">
                    ğŸ“‹ QR ì½”ë“œ ì—†ì´ ìƒí’ˆë“±ë¡ í…ŒìŠ¤íŠ¸ ì¤€ë¹„ë¨<br>
                    ë©”ì¸ ì‹œìŠ¤í…œ(index.html)ìœ¼ë¡œ ê°€ì„œ ìƒí’ˆë“±ë¡ì„ ì‹œë„í•˜ì„¸ìš”.<br><br>
                    <strong>í…ŒìŠ¤íŠ¸ ìƒí’ˆ ì •ë³´:</strong><br>
                    â€¢ ìƒí’ˆëª…: White Platter í…ŒìŠ¤íŠ¸<br>
                    â€¢ íŒë§¤ê°€: 50000<br>
                    â€¢ ì¹´í…Œê³ ë¦¬: ë‹¤ìœ¡ì‹ë¬¼<br>
                    â€¢ ë°°ì†¡ì˜µì…˜: ì¼ë°˜ë°°ì†¡
                </div>
            `;
            
            // 5ì´ˆ í›„ ì›ë˜ ìƒíƒœë¡œ ë³µì›
            setTimeout(() => {
                window.QRCodeDisabled = originalQRState;
                result.innerHTML += '<br><span class="text-gray-500">QR ì„¤ì •ì´ ì›ë˜ëŒ€ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.</span>';
            }, 5000);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í™•ì¸
        window.onload = function() {
            // localStorageì—ì„œ QR ë¹„í™œì„±í™” ìƒíƒœ ë³µì›
            if (localStorage.getItem('qr_disabled') === 'true') {
                window.QRCodeDisabled = true;
            }
            
            checkQRLibrary();
        };
    </script>
</body>
</html>