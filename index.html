<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>경산다육식물농장 - 관리시스템</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzEwYjk4MSIvPgo8c3ZnIHg9IjgiIHk9IjgiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiPgo8cGF0aCBkPSJNMTIgMkM2LjQ4IDIgMiA2LjQ4IDIgMTJzNC40OCAxMCAxMCAxMCAxMC00LjQ4IDEwLTEwUzE3LjUyIDIgMTIgMnptMCAxOGMtNC40MSAwLTgtMy41OS04LTggczMuNTktOCA4LTggOCAzLjU5IDggOC0zLjU5IDgtOCA4eiIvPgo8cGF0aCBkPSJNMTIgNnY2bDQgMiIvPgo8L3N2Zz4KPC9zdmc+">
    
    <!-- 카카오 주소 API -->
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" onerror="console.warn('⚠️ 카카오 주소 API 로딩 실패');"></script>
    
    <!-- Tailwind CSS 경고 차단 -->
    <script>
        // Tailwind CSS 프로덕션 경고 메시지 무시
        (function() {
            const originalWarn = console.warn;
            const originalError = console.error;
            
            console.warn = function(message) {
                if (typeof message === 'string' && 
                    (message.includes('cdn.tailwindcss.com should not be used in production') ||
                     message.includes('should not be used in production'))) {
                    return; // 이 경고는 무시
                }
                originalWarn.apply(console, arguments);
            };
            
            console.error = function(message) {
                if (typeof message === 'string' && 
                    (message.includes('cdn.tailwindcss.com should not be used in production') ||
                     message.includes('should not be used in production'))) {
                    return; // 이 에러도 무시
                }
                originalError.apply(console, arguments);
            };
        })();
    </script>
    
    <!-- Tailwind CSS Play CDN (CORS 호환) -->
    <script src="https://cdn.tailwindcss.com/3.3.0" onerror="console.warn('⚠️ Tailwind CSS 로딩 실패 - 기본 스타일 사용'); document.head.innerHTML += '<style>body{font-family:Arial,sans-serif;margin:0;padding:20px;background:#f5f5f5;} .bg-green-600{background:#16a34a;color:white;padding:10px;border-radius:5px;} .text-white{color:white;} .px-4{padding-left:16px;padding-right:16px;} .py-2{padding-top:8px;padding-bottom:8px;} .rounded{border-radius:4px;} .mb-4{margin-bottom:16px;} .flex{display:flex;} .items-center{align-items:center;} .space-x-2 > * + * {margin-left:8px;}</style>';" onload="console.log('✅ Tailwind CSS 로딩 성공 - 개발 모드에서 사용 중');"></script>
    <script>
        // Tailwind 설정
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Noto Sans KR', 'sans-serif']
                    }
                }
            }
        }
        
        // Tailwind CDN 프로덕션 경고 무시
        console.log('🌱 Tailwind CSS 개발 모드로 로딩됨 - 프로덕션 경고는 무시하세요');
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" onerror="console.warn('⚠️ Font Awesome 로딩 실패 - 아이콘 없이 사용');">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet" onerror="console.warn('⚠️ Google Fonts 로딩 실패 - 시스템 폰트 사용');">
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    
    <!-- QRCode.js for QR Code Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" 
            onerror="console.warn('⚠️ QRious 라이브러리 로딩 실패 - QR 코드 기능 비활성화'); window.QRCodeDisabled = true;"
            onload="console.log('✅ QRious 라이브러리 로딩 성공:', typeof QRious !== 'undefined');"></script>
    
    <!-- Chart.js for Dashboard -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- SweetAlert2 for Alerts and Notifications -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" 
            onerror="console.warn('⚠️ SweetAlert2 라이브러리 로딩 실패 - 알림 기능 비활성화'); window.SwalDisabled = true;"
            onload="console.log('✅ SweetAlert2 라이브러리 로딩 성공:', typeof Swal !== 'undefined');"></script>
    
    <!-- CryptoJS for Solapi HMAC Authentication -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" 
            onerror="console.warn('⚠️ CryptoJS 라이브러리 로딩 실패 - SMS 기능 비활성화'); window.CryptoJSDisabled = true;"
            onload="console.log('✅ CryptoJS 라이브러리 로딩 성공:', typeof CryptoJS !== 'undefined');"></script>
    
    <!-- Supabase Client -->
    <!-- Supabase CDN (중복 제거) -->
    
        <!-- 주문 표시 문제 자동 해결 스크립트 -->
        <script>
            // 주문 표시 문제 자동 해결
            function fixOrderDisplay() {
                console.log('🔧 주문 표시 문제 자동 해결 시작...');
                
                if (typeof orderSystem !== 'undefined') {
                    // 1. 데이터 복구
                    orderSystem.emergencyDataRecovery();
                    
                    // 2. 주문 테이블 강제 렌더링
                    setTimeout(() => {
                        orderSystem.renderOrdersTable();
                        orderSystem.updateStatusCounts();
                        console.log('✅ 주문 표시 문제 해결 완료');
                    }, 1000);
                } else {
                    console.log('⚠️ orderSystem이 아직 로드되지 않음, 3초 후 재시도...');
                    setTimeout(fixOrderDisplay, 3000);
                }
            }
            
            // 페이지 로드 후 자동 실행
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(fixOrderDisplay, 2000);
            });
        </script>

        <!-- 캐시 무효화 스크립트 -->
        <script>
            // 캐시 무효화를 위한 버전 관리
            const CACHE_VERSION = 'v1.0.4-' + Date.now();
            console.log('🔄 캐시 버전:', CACHE_VERSION);
        
        // Service Worker 캐시 무효화
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    registration.unregister();
                    console.log('🗑️ 기존 Service Worker 제거됨');
                }
            });
        }
        
        // 브라우저 캐시 무효화
        if ('caches' in window) {
            caches.keys().then(function(cacheNames) {
                return Promise.all(
                    cacheNames.map(function(cacheName) {
                        console.log('🗑️ 캐시 삭제:', cacheName);
                        return caches.delete(cacheName);
                    })
                );
            }).then(function() {
                console.log('✅ 모든 캐시가 삭제되었습니다');
            });
        }
        
        // localStorage 캐시 관련 데이터 정리
        const cacheKeys = ['systemLoadingIssue', 'apiMode', 'lastUpdateCheck'];
        cacheKeys.forEach(key => {
            if (localStorage.getItem(key)) {
                localStorage.removeItem(key);
                console.log('🗑️ localStorage 정리:', key);
            }
        });
        
        // 강제 새로고침 안내
        console.log('🔄 캐시 무효화 완료! 이제 일반 새로고침(F5)으로도 최신 파일이 로드됩니다.');
        
        // 이벤트 리스너 재등록을 위한 지연 실행
        setTimeout(() => {
            if (typeof orderSystem !== 'undefined') {
                console.log('🔄 이벤트 리스너 자동 재등록 시작...');
                orderSystem.reinitializeEventListeners();
            }
        }, 2000);
    </script>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json?v=1.0.3">
    
    <!-- PWA iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="경산다육농장">
    <!-- PWA 아이콘 (cfimages 오류 해결을 위해 제거) -->
    <!-- <link rel="apple-touch-icon" href="https://sspark.genspark.ai/cfimages?u1=9Glvot%2FUg9bCx1S5eD1Yj7ENmpCcErRtyt9llYOKt2aokovpY4%2BGRzxilIvP9SfXEUqhFyNXpB9MeCIPaKT9SRj8r0krCRDUQRWiaa0cA72j1SeGGXPIUIMbDME1gNWY%2BME18oCZ2BsuRPG3qwUMY18%2Ft7nUsLi2AzgI7beJ0PN%2Fq3VS18Y%3D&u2=WhwSXgPwWR7TzWSN&width=180"> -->
    
    <!-- PWA Android Meta Tags -->
    <meta name="theme-color" content="#16a34a">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- 즉시 연결 상태 수정 (가장 먼저 실행) -->
    <script>
        // 페이지 로드 전에 즉시 실행
        (function() {
            // 외부 API 요청 차단 (400 오류 방지)
            const originalFetch = window.fetch;
            window.fetch = function(url, options = {}) {
                // cfimages 요청 차단
                if (typeof url === 'string' && url.includes('cfimages')) {
                    console.log('🚫 cfimages 요청 차단:', url);
                    return Promise.reject(new Error('cfimages 요청 차단됨'));
                }
                
                // 기타 외부 API 요청 차단
                if (typeof url === 'string' && (url.includes('sspark.genspark.ai') || url.includes('tables/'))) {
                    console.log('🚫 외부 API 요청 차단:', url);
                    return Promise.reject(new Error('외부 API 요청 차단됨'));
                }
                
                return originalFetch(url, options);
            };
            
            // DOM이 로드되면 즉시 실행
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', fixConnectionImmediately);
            } else {
                fixConnectionImmediately();
            }
            
            function fixConnectionImmediately() {
                // 즉시 실행
                setTimeout(function() {
                    const statusText = document.getElementById('api-status-text');
                    if (statusText) {
                        statusText.textContent = '로컬 전용';
                        statusText.style.color = '#1d4ed8';
                    }
                    
                    const statusDot = document.getElementById('api-status-dot');
                    if (statusDot) {
                        statusDot.style.backgroundColor = '#3b82f6';
                        statusDot.style.animation = 'none';
                    }
                    
                    const statusIndicator = document.getElementById('api-status-indicator');
                    if (statusIndicator) {
                        statusIndicator.style.backgroundColor = '#dbeafe';
                        statusIndicator.style.color = '#1e40af';
                    }
                }, 0);
            }
        })();
    </script>
    
    <style>
        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', '맑은 고딕', Arial, sans-serif;
        }
        
        /* 연결 상태 즉시 수정 */
        #api-status-text {
            color: #1d4ed8 !important;
        }
        #api-status-dot {
            background-color: #3b82f6 !important;
            animation: none !important;
        }
        #api-status-indicator {
            background-color: #dbeafe !important;
            color: #1e40af !important;
        }
        
        /* 오프라인 모드 백업 스타일 */
        .offline-fallback {
            display: none;
        }
        
        /* 네트워크 오류 시 표시될 기본 스타일 */
        .connection-error-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #ef4444;
            color: white;
            padding: 10px;
            text-align: center;
            z-index: 9999;
            font-size: 14px;
        }
        
        .connection-error-banner.hidden {
            display: none;
        }
        
        /* PWA 설치 버튼 스타일 */
        .pwa-install-banner {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
        }
        
        /* 모바일 최적화 */
        @media (max-width: 768px) {
            .desktop-only {
                display: none !important;
            }
            
            .mobile-optimized {
                font-size: 16px;
                line-height: 1.5;
            }
            
            .mobile-button {
                min-height: 44px;
                min-width: 44px;
            }
            
            .mobile-input {
                min-height: 44px;
                font-size: 16px;
            }
            
            /* 모바일 네비게이션 스타일 */
            .mobile-tab-button.active {
                color: #16a34a;
                background-color: rgba(22, 163, 74, 0.1);
                border-radius: 8px;
            }
            
            /* 모바일에서 버튼 크기 조정 */
            .mobile-nav-optimized button {
                padding: 12px 16px;
                font-size: 14px;
            }
            
            /* 모바일에서 테이블 최적화 */
        }
        
        /* 아코디언 애니메이션 스타일 */
        .order-chevron {
            transition: transform 0.2s ease-in-out;
        }
        
        .rotate-180 {
            transform: rotate(180deg);
        }
        
        .order-summary-row:hover {
            background-color: #f9fafb;
        }
        
        .order-details-row {
            transition: all 0.3s ease-in-out;
        }
        
        /* 펼쳐진 상태의 배경색 */
        .order-details-expanded {
            background-color: #f8fafc;
        }
        
        .mobile-table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .mobile-table-responsive table {
            min-width: 600px;
        }
        
        /* 인라인 상품 등록 폼 애니메이션 */
        .inline-form-enter {
            animation: slideDown 0.3s ease-out;
        }
        
        .inline-form-exit {
            animation: slideUp 0.3s ease-in;
        }
        


        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
                max-height: 0;
            }
            to {
                opacity: 1;
                transform: translateY(0);
                max-height: 500px;
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 1;
                transform: translateY(0);
                max-height: 500px;
            }
            to {
                opacity: 0;
                transform: translateY(-20px);
                max-height: 0;
            }
        }
        
        /* 인라인 편집 스타일 */
        .inline-edit-input {
            padding: 2px 6px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background-color: #ffffff;
            font-size: 0.875rem;
            min-width: 80px;
        }
        
        .inline-edit-input:focus {
            outline: none;
            border-color: #16a34a;
            box-shadow: 0 0 0 2px rgba(22, 163, 74, 0.1);
        }
        
        .inline-editable {
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background-color 0.15s ease;
        }
        
        .inline-editable:hover {
            background-color: #f3f4f6;
        }
        
        .inline-editing {
            background-color: #f0fdf4;
            border: 1px solid #16a34a;
            border-radius: 4px;
        }
        
        /* QR 라벨 스타일 */
        .qr-label {
            width: 1.3cm;
            height: 4cm;
            border: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 1mm;
            font-family: 'Noto Sans KR', sans-serif;
            page-break-inside: avoid;
            background: white;
        }
        
        .qr-label .product-name {
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            line-height: 1.0;
            color: #1f2937;
            word-break: break-all;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            line-clamp: 4;
            -webkit-box-orient: vertical;
            margin-bottom: 1mm;
            height: 12mm;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .qr-label .product-price {
            font-size: 10px;
            font-weight: 700;
            text-align: center;
            color: #000000;
            letter-spacing: 0.2px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0.5mm 1.5mm;
            padding: 0 1mm;
            text-shadow: 0.1px 0.1px 0px rgba(0,0,0,0.1);
            border-top: 0.5px solid #ddd;
            border-bottom: 0.5px solid #ddd;
            white-space: nowrap;
        }
        
        .qr-label .qr-code {
            width: 11mm;
            height: 11mm;
            margin: 0.5mm 0;
            flex-shrink: 0;
        }
        
        .labels-grid {
            display: grid;
            grid-template-columns: repeat(12, 1.3cm);
            grid-template-rows: repeat(6, 4cm);
            gap: 1.2mm;
            justify-content: center;
            align-content: start;
            margin: 0 auto;
            width: fit-content;
        }
        
        /* 프린트 스타일 */
        @media print {
            * {
                margin: 0 !important;
                padding: 0 !important;
                box-sizing: border-box !important;
            }
            
            @page {
                size: A4 portrait;
                margin: 5mm 8mm;
            }
            
            html, body {
                width: 210mm !important;
                height: 297mm !important;
                background: white !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                overflow: hidden !important;
            }
            
            body * {
                visibility: hidden;
            }
            
            #qr-labels-container,
            #qr-labels-container * {
                visibility: visible;
            }
            
            #qr-labels-container {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 210mm !important;
                height: 297mm !important;
                margin: 0 !important;
                padding: 5mm 8mm !important;
                page-break-after: avoid !important;
                page-break-inside: avoid !important;
                overflow: visible !important;
                background: white !important;
                box-sizing: border-box !important;
            }
            
            .labels-grid {
                display: grid !important;
                grid-template-columns: repeat(12, 1.3cm) !important;
                grid-template-rows: repeat(6, 4cm) !important;
                gap: 1.0mm !important;
                justify-content: center !important;
                align-content: start !important;
                width: fit-content !important;
                height: fit-content !important;
                margin: 0 auto !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
            }
            
            .qr-label {
                width: 1.3cm !important;
                height: 4cm !important;
                border: 0.5px solid #000 !important;
                page-break-inside: avoid !important;
                background: white !important;
                margin: 0 !important;
                padding: 0.8mm !important;
                font-size: 7px !important;
                display: flex !important;
                flex-direction: column !important;
                justify-content: space-evenly !important;
                align-items: center !important;
                box-sizing: border-box !important;
            }
            
            .qr-label .product-name {
                font-size: 10px !important;
                font-weight: bold !important;
                text-align: center !important;
                line-height: 1.0 !important;
                color: #1f2937 !important;
                word-break: break-all !important;
                overflow: hidden !important;
                display: -webkit-box !important;
                -webkit-line-clamp: 4 !important;
                line-clamp: 4 !important;
                -webkit-box-orient: vertical !important;
                margin-bottom: 1mm !important;
                height: 12mm !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }
            
            .qr-label .product-price {
                font-size: 10px !important;
                font-weight: 700 !important;
                text-align: center !important;
                color: #000000 !important;
                letter-spacing: 0.2px !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                margin: 0.5mm 1.5mm !important;
                padding: 0 1mm !important;
                text-shadow: 0.1px 0.1px 0px rgba(0,0,0,0.1) !important;
                border-top: 0.5px solid #ddd !important;
                border-bottom: 0.5px solid #ddd !important;
                white-space: nowrap !important;
            }
            
            .qr-label .qr-code {
                width: 11mm !important;
                height: 11mm !important;
                margin: 0.5mm 0 !important;
                flex-shrink: 0 !important;
            }
            
            .qr-label .qr-code canvas {
                max-width: 100% !important;
                max-height: 100% !important;
            }
            
            /* 빈 라벨은 프린트에서 숨김 */
            .qr-label[style*="dashed"] {
                display: none !important;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- 로그인 모달 -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-lg shadow-xl p-8 w-full max-w-md mx-4">
            <div class="text-center mb-6">
                <div class="mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4">
                    <i class="fas fa-seedling text-2xl text-green-600"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">경산다육식물농장</h2>
                <p class="text-gray-600 mt-2">관리자 로그인이 필요합니다</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-1">
                        사용자명
                    </label>
                    <input type="text" 
                           id="username" 
                           name="username"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                           placeholder="관리자 사용자명"
                           required>
                </div>
                
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1">
                        비밀번호
                    </label>
                    <div class="relative">
                        <input type="password" 
                               id="password" 
                               name="password"
                               class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                               placeholder="관리자 비밀번호"
                               required>
                        <button type="button" 
                                id="togglePassword"
                                class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none"
                                onclick="togglePasswordVisibility()"
                                style="cursor: pointer; z-index: 10; pointer-events: auto;"
                                tabindex="0">
                            <i id="passwordIcon" class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div id="loginError" class="text-red-600 text-sm text-center" style="display: none;"></div>
                
                <button type="submit" 
                        id="loginButton"
                        class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200"
                        onclick="handleLoginClick(event)">
                    <i class="fas fa-sign-in-alt mr-2"></i>
                    로그인
                </button>
            </form>
            
            <div class="mt-6 text-center text-sm text-gray-500">
                <p>🔐 보안이 강화된 관리자 전용 시스템입니다</p>
                <p class="mt-1">잘못된 접근 시도는 자동으로 차단됩니다</p>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-green-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-seedling text-2xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold">경산다육식물농장</h1>
                        <p class="text-green-100 text-sm">White Platter 전문 관리시스템</p>
                    </div>
                </div>
                
                <!-- 사용자 정보 및 로그아웃 버튼 -->
                <div id="userInfo" class="flex items-center space-x-4">
                    <!-- 인증된 사용자 정보가 여기에 표시됩니다 -->
                </div>
                </div>
                <div class="text-right flex items-center space-x-3">
                    <!-- API 상태 표시 -->
                    <div id="api-status-indicator" class="flex items-center space-x-2 px-3 py-1 rounded-lg text-sm">
                        <div id="api-status-dot" class="w-2 h-2 rounded-full bg-yellow-400 animate-pulse"></div>
                        <span id="api-status-text" class="text-xs">연결 확인중...</span>
                        <button id="api-reconnect-btn" class="hidden ml-2 bg-blue-500 hover:bg-blue-400 px-2 py-1 rounded text-xs font-medium transition-colors" title="API 재연결 시도">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button id="force-api-mode-btn" class="ml-2 bg-orange-500 hover:bg-orange-400 px-2 py-1 rounded text-xs font-medium transition-colors" title="핸드폰 API 모드 전환">
                            📱→🌐
                        </button>
                        <button onclick="window.open('connection-diagnostic.html', '_blank')" class="ml-2 bg-purple-500 hover:bg-purple-400 px-2 py-1 rounded text-xs font-medium transition-colors" title="연결 진단 도구">
                            🔧
                        </button>
                        <button onclick="orderSystem.emergencyDataRecovery()" class="ml-2 bg-red-500 hover:bg-red-400 px-2 py-1 rounded text-xs font-medium transition-colors" title="긴급 데이터 복구 (F5로 사라진 데이터 복구)">
                            🚨
                        </button>
                        <button onclick="orderSystem.reinitializeEventListeners()" class="ml-2 bg-yellow-500 hover:bg-yellow-400 px-2 py-1 rounded text-xs font-medium transition-colors" title="이벤트 리스너 재등록 (F5 후 아이콘 비활성화 해결)">
                            🔄
                        </button>
                        <button onclick="fixOrderDisplay()" class="ml-2 bg-blue-500 hover:bg-blue-400 px-2 py-1 rounded text-xs font-medium transition-colors" title="주문 표시 문제 해결">
                            🔧
                        </button>
                    </div>
                    <button id="pwa-install-btn" class="hidden bg-green-500 hover:bg-green-400 px-3 py-1 rounded-lg text-sm font-medium transition-colors">
                        <i class="fas fa-download mr-1"></i>
                        앱 설치
                    </button>
                    <p class="text-sm text-green-100">부대장님 환영합니다! 🌱</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation - Desktop -->
    <nav class="bg-white shadow-md hidden md:block">
        <div class="container mx-auto px-4">
            <div class="flex space-x-8">
                <button id="tab-dashboard" class="py-4 px-6 text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors font-medium tab-button active">
                    <i class="fas fa-tachometer-alt mr-2"></i>실시간 운영현황
                </button>
                <button id="tab-orders" class="py-4 px-6 text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors font-medium tab-button">
                    <i class="fas fa-shopping-cart mr-2"></i>주문관리
                </button>
                <button id="tab-customers" class="py-4 px-6 text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors font-medium tab-button">
                    <i class="fas fa-users mr-2"></i>고객관리
                </button>
                <button id="tab-products" class="py-4 px-6 text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors font-medium tab-button">
                    <i class="fas fa-leaf mr-2"></i>상품관리
                </button>
                <button id="tab-shipping" class="py-4 px-6 text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors font-medium tab-button">
                    <i class="fas fa-truck mr-2"></i>배송관리
                </button>
                <button id="tab-waitlist" class="py-4 px-6 text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors font-medium tab-button">
                    <i class="fas fa-clock mr-2"></i>대기자관리
                </button>
                <!-- 환경설정 드롭다운 메뉴 -->
                <div class="relative">
                    <button id="settings-dropdown" class="py-4 px-6 text-gray-600 hover:text-purple-600 border-b-2 border-transparent hover:border-purple-600 transition-colors font-medium flex items-center">
                        <i class="fas fa-cog mr-2"></i>환경설정
                        <i class="fas fa-chevron-down ml-2 text-xs transform transition-transform" id="settings-chevron"></i>
                    </button>
                    <!-- 드롭다운 메뉴 -->
                    <div id="settings-menu" class="absolute top-full left-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-xl z-[9999] hidden" style="z-index: 9999;">
                        <div class="py-2">
                            <button id="tab-channels" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                                <i class="fas fa-store mr-3 w-4"></i>판매 채널 관리
                            </button>
                            <button id="tab-order-status" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                                <i class="fas fa-tasks mr-3 w-4"></i>주문 상태 관리
                            </button>
                            <button id="tab-shipping-settings" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                                <i class="fas fa-truck mr-3 w-4"></i>배송비 관리
                            </button>
                            <button id="tab-customer-grade" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                                <i class="fas fa-crown mr-3 w-4"></i>고객등급 관리
                            </button>
                            <div class="border-t border-gray-200 my-1"></div>
                            <button onclick="deployToProduction()" class="w-full text-left px-4 py-2 text-green-600 hover:bg-green-50 hover:text-green-700 transition-colors flex items-center font-semibold">
                                <i class="fas fa-rocket mr-3 w-4"></i>프로덕션 모드 전환
                            </button>
                        </div>
                    </div>
                </div>
                <button id="tab-analytics" class="py-4 px-6 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 transition-colors font-medium tab-button">
                    <i class="fas fa-chart-line mr-2"></i>경영 대시보드
                </button>
                <button id="tab-backup" class="py-4 px-6 text-gray-600 hover:text-orange-600 border-b-2 border-transparent hover:border-orange-600 transition-colors font-medium tab-button">
                    <i class="fas fa-shield-alt mr-2"></i>데이터백업
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 md:hidden z-50">
        <div class="flex justify-around">
            <button id="mobile-tab-dashboard" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-green-600 transition-colors font-medium mobile-tab-button active">
                <i class="fas fa-tachometer-alt text-lg mb-1"></i>
                <span class="text-xs">운영현황</span>
            </button>
            <button id="mobile-tab-orders" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-green-600 transition-colors font-medium mobile-tab-button">
                <i class="fas fa-shopping-cart text-lg mb-1"></i>
                <span class="text-xs">주문</span>
            </button>
            <button id="mobile-tab-customers" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-green-600 transition-colors font-medium mobile-tab-button">
                <i class="fas fa-users text-lg mb-1"></i>
                <span class="text-xs">고객</span>
            </button>
            <button id="mobile-tab-products" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-green-600 transition-colors font-medium mobile-tab-button">
                <i class="fas fa-leaf text-lg mb-1"></i>
                <span class="text-xs">상품</span>
            </button>
            <button id="mobile-tab-shipping" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-green-600 transition-colors font-medium mobile-tab-button">
                <i class="fas fa-truck text-lg mb-1"></i>
                <span class="text-xs">배송</span>
            </button>
            <button id="mobile-tab-waitlist" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-green-600 transition-colors font-medium mobile-tab-button">
                <i class="fas fa-clock text-lg mb-1"></i>
                <span class="text-xs">대기</span>
            </button>
            <!-- 모바일 환경설정 메뉴 -->
            <button id="mobile-settings-toggle" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-purple-600 transition-colors font-medium">
                <i class="fas fa-cog text-lg mb-1"></i>
                <span class="text-xs">설정</span>
            </button>
            <button id="mobile-tab-backup" class="flex flex-col items-center py-2 px-1 text-gray-600 hover:text-orange-600 transition-colors font-medium mobile-tab-button">
                <i class="fas fa-shield-alt text-lg mb-1"></i>
                <span class="text-xs">백업</span>
            </button>
        </div>
    </nav>

    <!-- 모바일 환경설정 바텀 시트 -->
    <div id="mobile-settings-sheet" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden md:hidden">
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-xl shadow-lg transform translate-y-full transition-transform" id="mobile-settings-content">
            <div class="p-4">
                <div class="w-12 h-1 bg-gray-300 rounded-full mx-auto mb-4"></div>
                <h3 class="text-lg font-medium text-gray-800 mb-4 text-center">
                    <i class="fas fa-cog mr-2 text-purple-600"></i>환경설정
                </h3>
                <div class="space-y-2">
                    <button id="mobile-tab-channels" class="w-full text-left p-3 rounded-lg text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                        <i class="fas fa-store mr-3 w-5 text-center"></i>판매 채널 관리
                    </button>
                    <button id="mobile-tab-order-status" class="w-full text-left p-3 rounded-lg text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                        <i class="fas fa-tasks mr-3 w-5 text-center"></i>주문 상태 관리
                    </button>
                    <button id="mobile-tab-shipping-settings" class="w-full text-left p-3 rounded-lg text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                        <i class="fas fa-truck mr-3 w-5 text-center"></i>배송비 관리
                    </button>
                    <button id="mobile-tab-customer-grade" class="w-full text-left p-3 rounded-lg text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors flex items-center">
                        <i class="fas fa-crown mr-3 w-5 text-center"></i>고객등급 관리
                    </button>
                    <div class="border-t border-gray-200 my-2"></div>
                    <button onclick="deployToProduction()" class="w-full text-left p-3 rounded-lg text-green-600 hover:bg-green-50 hover:text-green-700 transition-colors flex items-center font-semibold">
                        <i class="fas fa-rocket mr-3 w-5 text-center"></i>프로덕션 모드 전환
                    </button>
                </div>
                <button id="mobile-settings-close" class="w-full mt-4 p-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors">
                    닫기
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main id="mainContent" class="container mx-auto px-4 py-6 pb-20 md:pb-6">
        <!-- 실시간 운영 현황 섹션 -->
        <div id="dashboard-section" class="tab-content">
            <!-- 실시간 운영 현황 헤더 -->
            <div class="mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900 flex items-center">
                            <i class="fas fa-tachometer-alt text-green-600 mr-3"></i>
                            실시간 운영 현황
                        </h1>
                        <p class="text-gray-600 mt-1">오늘 처리해야 할 핵심 업무를 한눈에 확인하고 바로 이동하세요</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm text-gray-500">
                            <i class="fas fa-clock mr-1"></i>
                            <span id="current-time">실시간 업데이트</span>
                        </span>
                        <button id="refresh-realtime" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                            <i class="fas fa-sync-alt mr-2"></i>새로고침
                        </button>
                    </div>
                </div>
            </div>

            <!-- 핵심 업무 요약 카드 그리드 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-6">
                
                <!-- 1. 포장할 주문 카드 -->
                <div id="pack-orders-card" class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer border-l-4 border-orange-500 hover:border-orange-600">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="flex items-center">
                                    <i class="fas fa-box text-2xl text-orange-500 mr-3"></i>
                                    <div>
                                        <p class="text-sm font-medium text-gray-600">포장할 주문</p>
                                        <p class="text-xs text-gray-500">입금확인 완료</p>
                                    </div>
                                </div>
                                <p class="text-3xl font-bold text-orange-600 mt-2" id="pack-orders-count">-</p>
                                <p class="text-xs text-gray-500 mt-1">건의 주문 대기중</p>
                            </div>
                            <div class="text-orange-500">
                                <i class="fas fa-arrow-right text-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. 오늘 보낼 택배 카드 -->
                <div id="ship-orders-card" class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer border-l-4 border-purple-500 hover:border-purple-600">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="flex items-center">
                                    <i class="fas fa-truck text-2xl text-purple-500 mr-3"></i>
                                    <div>
                                        <p class="text-sm font-medium text-gray-600">오늘 보낼 택배</p>
                                        <p class="text-xs text-gray-500">배송준비 완료</p>
                                    </div>
                                </div>
                                <p class="text-3xl font-bold text-purple-600 mt-2" id="ship-orders-count">-</p>
                                <p class="text-xs text-gray-500 mt-1">건의 택배 발송</p>
                            </div>
                            <div class="text-purple-500">
                                <i class="fas fa-arrow-right text-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. 재고 부족 상품 카드 -->
                <div id="low-stock-card" class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer border-l-4 border-red-500 hover:border-red-600">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="flex items-center">
                                    <i class="fas fa-exclamation-triangle text-2xl text-red-500 mr-3"></i>
                                    <div>
                                        <p class="text-sm font-medium text-gray-600">재고 부족 상품</p>
                                        <p class="text-xs text-gray-500">긴급 보충 필요</p>
                                    </div>
                                </div>
                                <p class="text-3xl font-bold text-red-600 mt-2" id="low-stock-count">-</p>
                                <p class="text-xs text-gray-500 mt-1">개 상품 부족</p>
                            </div>
                            <div class="text-red-500">
                                <i class="fas fa-arrow-right text-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4. 연락할 대기자 카드 -->
                <div id="contact-waitlist-card" class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer border-l-4 border-blue-500 hover:border-blue-600">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="flex items-center">
                                    <i class="fas fa-phone text-2xl text-blue-500 mr-3"></i>
                                    <div>
                                        <p class="text-sm font-medium text-gray-600">연락할 대기자</p>
                                        <p class="text-xs text-gray-500">입고완료 알림</p>
                                    </div>
                                </div>
                                <p class="text-3xl font-bold text-blue-600 mt-2" id="contact-waitlist-count">-</p>
                                <p class="text-xs text-gray-500 mt-1">명 연락 대기중</p>
                            </div>
                            <div class="text-blue-500">
                                <i class="fas fa-arrow-right text-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5. 이번 달 신규 고객 카드 -->
                <div id="new-customers-card" class="bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer border-l-4 border-green-500 hover:border-green-600">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="flex items-center">
                                    <i class="fas fa-user-plus text-2xl text-green-500 mr-3"></i>
                                    <div>
                                        <p class="text-sm font-medium text-gray-600">이번 달 신규 고객</p>
                                        <p class="text-xs text-gray-500">새로운 고객님들</p>
                                    </div>
                                </div>
                                <p class="text-3xl font-bold text-green-600 mt-2" id="new-customers-count">-</p>
                                <p class="text-xs text-gray-500 mt-1">명 신규 가입</p>
                            </div>
                            <div class="text-green-500">
                                <i class="fas fa-arrow-right text-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 빠른 업무 처리 섹션 -->
            <div class="bg-white rounded-lg shadow-md mb-6">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                        <i class="fas fa-bolt text-green-600 mr-2"></i>빠른 업무 처리
                    </h2>
                    <p class="text-sm text-gray-600 mt-1">자주 사용하는 기능들을 바로 실행하세요</p>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                        <!-- 새 주문 등록 -->
                        <button id="quick-new-order" class="flex flex-col items-center p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors border border-green-200 hover:border-green-300">
                            <i class="fas fa-plus-circle text-2xl text-green-600 mb-2"></i>
                            <span class="text-sm font-medium text-green-700">새 주문 등록</span>
                        </button>



                        <!-- 피킹 리스트 생성 -->
                        <button id="quick-picking-list" class="flex flex-col items-center p-4 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors border border-purple-200 hover:border-purple-300">
                            <i class="fas fa-clipboard-list text-2xl text-purple-600 mb-2"></i>
                            <span class="text-sm font-medium text-purple-700">피킹 리스트</span>
                        </button>

                        <!-- 포장 라벨 생성 -->
                        <button id="quick-packaging-labels" class="flex flex-col items-center p-4 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors border border-indigo-200 hover:border-indigo-300">
                            <i class="fas fa-tags text-2xl text-indigo-600 mb-2"></i>
                            <span class="text-sm font-medium text-indigo-700">포장 라벨</span>
                        </button>

                        <!-- 새 고객 등록 -->
                        <button id="quick-new-customer" class="flex flex-col items-center p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors border border-blue-200 hover:border-blue-300">
                            <i class="fas fa-user-plus text-2xl text-blue-600 mb-2"></i>
                            <span class="text-sm font-medium text-blue-700">새 고객 등록</span>
                        </button>

                        <!-- 상품 재고 업데이트 -->
                        <button id="quick-stock-update" class="flex flex-col items-center p-4 bg-red-50 hover:bg-red-100 rounded-lg transition-colors border border-red-200 hover:border-red-300">
                            <i class="fas fa-boxes text-2xl text-red-600 mb-2"></i>
                            <span class="text-sm font-medium text-red-700">재고 업데이트</span>
                        </button>

                        <!-- 대기자 등록 -->
                        <button id="quick-add-waitlist" class="flex flex-col items-center p-4 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors border border-yellow-200 hover:border-yellow-300">
                            <i class="fas fa-clock text-2xl text-yellow-600 mb-2"></i>
                            <span class="text-sm font-medium text-yellow-700">대기자 등록</span>
                        </button>

                        <!-- 엑셀 내보내기 -->
                        <button id="quick-excel-export" class="flex flex-col items-center p-4 bg-emerald-50 hover:bg-emerald-100 rounded-lg transition-colors border border-emerald-200 hover:border-emerald-300">
                            <i class="fas fa-file-excel text-2xl text-emerald-600 mb-2"></i>
                            <span class="text-sm font-medium text-emerald-700">엑셀 내보내기</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 2-2. 인기 태그 TOP 10 섹션 -->
            <div class="bg-white rounded-lg shadow-md mb-6">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                        <i class="fas fa-tags text-purple-600 mr-2"></i>인기 태그 TOP 10
                    </h2>
                </div>
                <div class="p-6">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-white">
                                    <tr>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">순위</th>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">태그</th>
                                        <th class="px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase">판매횟수</th>
                                    </tr>
                                </thead>
                                <tbody id="popular-tags-table" class="divide-y divide-gray-200">
                                    <!-- 동적으로 채워짐 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2-3. 고객 분석 섹션 -->
            <div class="bg-white rounded-lg shadow-md mb-6">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                        <i class="fas fa-users text-green-600 mr-2"></i>고객 분석
                    </h2>
                </div>
                <div class="p-6">
                    <!-- 이번 달 고객 현황 카드 -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 text-center">
                            <i class="fas fa-user-plus text-3xl text-blue-600 mb-3"></i>
                            <p class="text-2xl font-bold text-blue-600" id="new-customers-count">0</p>
                            <p class="text-sm font-medium text-blue-700">이번 달 신규 고객</p>
                        </div>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-6 text-center">
                            <i class="fas fa-user-check text-3xl text-green-600 mb-3"></i>
                            <p class="text-2xl font-bold text-green-600" id="returning-customers-count">0</p>
                            <p class="text-sm font-medium text-green-700">이번 달 재구매 고객</p>
                        </div>
                    </div>
                    
                    <!-- VIP 고객 순위 -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-medium text-gray-800 mb-4">VIP 고객 순위 TOP 10</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-white">
                                    <tr>
                                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">순위</th>
                                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">고객명</th>
                                        <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">등급</th>
                                        <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">총 구매금액</th>
                                        <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase">주문횟수</th>
                                    </tr>
                                </thead>
                                <tbody id="vip-customers-table" class="divide-y divide-gray-200">
                                    <!-- 동적으로 채워짐 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 주문관리 섹션 -->
        <div id="orders-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-semibold text-gray-800">
                            <i class="fas fa-shopping-cart mr-2 text-green-600"></i>주문 관리
                        </h2>
                        <div class="flex space-x-3">
                            <!-- 일괄 처리 버튼들 -->
                            <button id="bulk-status-change-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors hidden">
                                <i class="fas fa-edit mr-2"></i>상태변경
                            </button>
                            <button id="bulk-export-logen-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors hidden">
                                <i class="fas fa-file-excel mr-2"></i>로젠택배 엑셀 내보내기
                            </button>
                            <button id="bulk-tracking-import-btn" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-barcode mr-2"></i>송장번호 일괄입력
                            </button>
                            <button id="generate-picking-list-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-clipboard-list mr-2"></i>피킹 리스트
                            </button>
                            <button id="generate-packaging-labels-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-tags mr-2"></i>포장 라벨
                            </button>
                            <button id="add-order-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-plus mr-2"></i>새 주문 등록
                            </button>
                        </div>
                    </div>
                    
                    <!-- 주문 상태별 필터 탭 -->
                    <div class="mt-4 border-b border-gray-200">
                        <nav class="flex space-x-1">
                            <button id="status-all" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors active">
                                <i class="fas fa-list mr-2"></i>전체 <span class="ml-1 bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs" id="count-all">0</span>
                            </button>
                            <button id="status-주문접수" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-yellow-600 border-b-2 border-transparent hover:border-yellow-600 transition-colors">
                                <i class="fas fa-receipt mr-2"></i>주문접수 <span class="ml-1 bg-yellow-100 text-yellow-600 px-2 py-1 rounded-full text-xs" id="count-주문접수">0</span>
                            </button>
                            <button id="status-입금확인" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors">
                                <i class="fas fa-money-check mr-2"></i>입금확인 <span class="ml-1 bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs" id="count-입금확인">0</span>
                            </button>
                            <button id="status-배송준비" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-orange-600 border-b-2 border-transparent hover:border-orange-600 transition-colors">
                                <i class="fas fa-box mr-2"></i>배송준비 <span class="ml-1 bg-orange-100 text-orange-600 px-2 py-1 rounded-full text-xs" id="count-배송준비">0</span>
                            </button>
                            <button id="status-배송시작" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-purple-600 border-b-2 border-transparent hover:border-purple-600 transition-colors">
                                <i class="fas fa-truck mr-2"></i>배송시작 <span class="ml-1 bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs" id="count-배송시작">0</span>
                            </button>
                            <button id="status-배송완료" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-emerald-600 border-b-2 border-transparent hover:border-emerald-600 transition-colors">
                                <i class="fas fa-check-circle mr-2"></i>배송완료 <span class="ml-1 bg-emerald-100 text-emerald-600 px-2 py-1 rounded-full text-xs" id="count-배송완료">0</span>
                            </button>
                            <button id="status-주문취소" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-gray-600 border-b-2 border-transparent hover:border-gray-600 transition-colors">
                                <i class="fas fa-times-circle mr-2"></i>주문취소 <span class="ml-1 bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs" id="count-주문취소">0</span>
                            </button>
                            <button id="status-환불처리" class="status-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-red-600 border-b-2 border-transparent hover:border-red-600 transition-colors">
                                <i class="fas fa-undo mr-2"></i>환불처리 <span class="ml-1 bg-red-100 text-red-600 px-2 py-1 rounded-full text-xs" id="count-환불처리">0</span>
                            </button>
                        </nav>
                    </div>
                </div>
                
                <!-- 주문 목록 -->
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-3 py-3 text-center text-sm font-medium text-gray-500 w-12" title="전체 선택">
                                        <input type="checkbox" id="select-all-orders" class="rounded text-green-600 focus:ring-green-500">
                                    </th>
                                    <th class="px-3 py-3 text-left text-sm font-medium text-gray-500 w-20 cursor-pointer hover:bg-gray-100" 
                                        onclick="orderSystem.sortOrders('order_date')" title="주문일자 정렬">
                                        주문일자 <i class="fas fa-sort text-gray-400 ml-1"></i>
                                    </th>
                                    <th class="px-3 py-3 text-left text-sm font-medium text-gray-500 w-24 cursor-pointer hover:bg-gray-100" 
                                        onclick="orderSystem.sortOrders('order_number')" title="주문번호 정렬">
                                        주문번호 <i class="fas fa-sort text-gray-400 ml-1"></i>
                                    </th>
                                    <th class="px-3 py-3 text-left text-sm font-medium text-gray-500 w-20 cursor-pointer hover:bg-gray-100" 
                                        onclick="orderSystem.sortOrders('customer_name')" title="고객명 정렬 (클릭시 고객 상세)">
                                        고객명 <i class="fas fa-sort text-gray-400 ml-1"></i>
                                    </th>
                                    <th class="px-3 py-3 text-left text-sm font-medium text-gray-500 w-24">연락처</th>

                                    <th class="px-3 py-3 text-left text-sm font-medium text-gray-500 w-20 cursor-pointer hover:bg-gray-100" 
                                        onclick="orderSystem.sortOrders('order_status')" title="주문상태 정렬">
                                        주문상태 <i class="fas fa-sort text-gray-400 ml-1"></i>
                                    </th>
                                    <th class="px-3 py-3 text-center text-sm font-medium text-gray-500 w-16" title="주문서 출력 상태">
                                        <i class="fas fa-print"></i>
                                    </th>
                                    <th class="px-3 py-3 text-center text-sm font-medium text-gray-500 w-16" title="SMS 발송 상태">
                                        <i class="fas fa-comment-sms"></i>
                                    </th>
                                    <th class="px-3 py-3 text-center text-sm font-medium text-gray-500 w-20">관리</th>
                                </tr>
                            </thead>
                            <tbody id="orders-table-body" class="divide-y divide-gray-200">
                                <!-- 주문 목록이 여기에 표시됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 고객관리 섹션 -->
        <div id="customers-section" class="tab-content hidden">
            <!-- Master-Detail 레이아웃: 40/60 분할 -->
            <div class="flex h-screen bg-gray-50 gap-4">
                
                <!-- 왼쪽 Master Panel: 고객 목록 (40%) -->
                <div class="w-2/5 bg-white rounded-lg shadow-md flex flex-col">
                    <!-- 헤더 -->
                    <div class="p-4 border-b border-gray-200 flex-shrink-0">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-semibold text-gray-800">
                                <i class="fas fa-users mr-2 text-green-600"></i>고객 목록
                            </h2>
                            <button id="add-customer-btn" class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg transition-colors text-sm">
                                <i class="fas fa-user-plus mr-1"></i>새 고객
                            </button>
                        </div>
                        
                        <!-- 검색 바 및 정렬 -->
                        <div class="flex space-x-2">
                            <div class="flex-1 relative">
                                <input type="text" id="customer-search" placeholder="고객명, 전화번호로 검색..." 
                                       class="w-full p-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm"
                                       autocomplete="off">
                                <button id="add-customer-from-search" class="absolute right-1 top-1 px-2 py-1 bg-green-600 hover:bg-green-700 text-white rounded transition-colors hidden text-xs">
                                    <i class="fas fa-user-plus"></i>
                                </button>
                                <div id="customer-search-suggestions" class="absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-b-lg shadow-lg z-10 max-h-40 overflow-y-auto hidden">
                                    <!-- 고객 검색 자동완성 목록이 여기에 표시됩니다 -->
                                </div>
                            </div>
                            
                            <!-- 고객 정렬 드롭다운 -->
                            <select id="customer-sort" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white">
                                <option value="newest">최근 등록순</option>
                                <option value="name_asc">고객명 오름차순 (ㄱ→ㅎ)</option>
                                <option value="name_desc">고객명 내림차순 (ㅎ→ㄱ)</option>
                            </select>
                            
                            <button id="reset-customer-search" class="bg-gray-400 hover:bg-gray-500 text-white px-3 py-2 rounded-lg transition-colors text-sm">
                                <i class="fas fa-refresh"></i>
                            </button>
                        </div>
                        
                        <!-- 고객 등급별 필터 탭 (축약형) -->
                        <div class="mt-3 border-b border-gray-200">
                            <nav class="flex space-x-1 text-xs">
                                <button id="customer-grade-all" class="customer-tab-btn py-1 px-2 font-medium text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors active">
                                    전체 <span class="ml-1 bg-gray-100 text-gray-600 px-1 py-0.5 rounded-full text-xs" id="customer-count-all">0</span>
                                </button>
                                <button id="customer-grade-BLACK_DIAMOND" class="customer-tab-btn py-1 px-2 font-medium text-gray-600 hover:text-gray-900 border-b-2 border-transparent hover:border-gray-900 transition-colors">
                                    💎블랙다이아몬드 <span class="ml-1 bg-gray-100 text-gray-900 px-1 py-0.5 rounded-full text-xs" id="customer-count-BLACK_DIAMOND">0</span>
                                </button>
                                <button id="customer-grade-PURPLE_EMPEROR" class="customer-tab-btn py-1 px-2 font-medium text-gray-600 hover:text-purple-600 border-b-2 border-transparent hover:border-purple-600 transition-colors">
                                    🟣퍼플엠페러 <span class="ml-1 bg-purple-100 text-purple-600 px-1 py-0.5 rounded-full text-xs" id="customer-count-PURPLE_EMPEROR">0</span>
                                </button>
                                <button id="customer-grade-RED_RUBY" class="customer-tab-btn py-1 px-2 font-medium text-gray-600 hover:text-red-600 border-b-2 border-transparent hover:border-red-600 transition-colors">
                                    🔴레드루비 <span class="ml-1 bg-red-100 text-red-600 px-1 py-0.5 rounded-full text-xs" id="customer-count-RED_RUBY">0</span>
                                </button>
                                <button id="customer-grade-GREEN_LEAF" class="customer-tab-btn py-1 px-2 font-medium text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors">
                                    🟢그린리프 <span class="ml-1 bg-green-100 text-green-600 px-1 py-0.5 rounded-full text-xs" id="customer-count-GREEN_LEAF">0</span>
                                </button>
                                <button id="customer-grade-GENERAL" class="customer-tab-btn py-1 px-2 font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 transition-colors">
                                    🙋‍♂️일반 <span class="ml-1 bg-blue-100 text-blue-600 px-1 py-0.5 rounded-full text-xs" id="customer-count-GENERAL">0</span>
                                </button>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- 고객 목록 테이블 (스크롤 가능) -->
                    <div class="flex-1 overflow-y-auto">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50 sticky top-0">
                                    <tr>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">고객명</th>
                                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">전화번호</th>
                                        <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">등급</th>
                                        <th class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">관리</th>
                                    </tr>
                                </thead>
                                <tbody id="customer-list-container" class="bg-white divide-y divide-gray-200">
                                    <!-- 고객 목록이 테이블 형태로 표시 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- 오른쪽 Detail Panel: 고객 상세정보 + 주문내역 (60%) -->
                <div class="w-3/5 bg-white rounded-lg shadow-md flex flex-col">
                    <!-- 상세 정보 헤더 -->
                    <div class="p-4 border-b border-gray-200 flex-shrink-0">
                        <div id="customer-detail-header" class="flex justify-between items-start">
                            <div id="customer-detail-empty" class="flex flex-col items-center justify-center w-full py-12 text-gray-500">
                                <i class="fas fa-user-circle text-6xl mb-4 text-gray-300"></i>
                                <h3 class="text-lg font-medium mb-2">고객을 선택해주세요</h3>
                                <p class="text-sm">왼쪽 목록에서 고객을 클릭하면 상세정보가 표시됩니다.</p>
                            </div>
                            
                            <!-- 이 부분은 이제 상세 정보 영역에서 처리되므로 숨김 -->
                            <div id="customer-detail-content" class="w-full hidden">
                                <!-- 이 영역은 더 이상 사용하지 않음 -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- 상세 정보 내용 (스크롤 가능) -->
                    <div class="flex-1 overflow-y-auto">
                        <div id="customer-detail-body" class="p-4">
                            <!-- 빈 상태 (선택된 고객 없음) -->
                            <div id="customer-detail-info-empty" class="text-center py-12">
                                <i class="fas fa-arrow-left text-4xl text-gray-300 mb-4"></i>
                                <h3 class="text-lg font-medium text-gray-500 mb-2">고객을 선택해주세요</h3>
                                <p class="text-sm text-gray-400">왼쪽 목록에서 고객을 클릭하면 상세정보가 표시됩니다</p>
                            </div>
                            
                            <!-- 선택된 고객 상세 정보 (초기에는 숨김) -->
                            <div id="customer-detail-info" class="hidden space-y-3">
                                <!-- 1. 최상단: 고객 식별 정보 + 수정 버튼 (압축) -->
                                <div class="flex items-start justify-between pb-2 border-b border-gray-200">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                            <i id="customer-detail-icon" class="fas fa-user text-lg text-green-600"></i>
                                        </div>
                                        <div>
                                            <h2 id="customer-detail-name" class="text-xl font-bold text-gray-900 mb-1">고객명</h2>
                                            <span id="customer-detail-grade" class="inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800">등급</span>
                                        </div>
                                    </div>
                                    <button id="edit-customer-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg transition-colors text-sm">
                                        <i class="fas fa-edit mr-1"></i>수정
                                    </button>
                                </div>

                                <!-- 2. 두 번째: 핵심 요약 정보 (주문 통계) - 압축 -->
                                <div class="grid grid-cols-3 gap-3">
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-2.5 text-center">
                                        <p id="detail-total-orders" class="text-2xl font-bold text-green-600 mb-0.5">0</p>
                                        <p class="text-xs font-medium text-green-700">총 주문수</p>
                                    </div>
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-2.5 text-center">
                                        <p id="detail-total-amount" class="text-2xl font-bold text-blue-600 mb-0.5">0원</p>
                                        <p class="text-xs font-medium text-blue-700">총 주문금액</p>
                                    </div>
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-2.5 text-center">
                                        <p id="detail-avg-amount" class="text-2xl font-bold text-purple-600 mb-0.5">0원</p>
                                        <p class="text-xs font-medium text-purple-700">평균 주문금액</p>
                                    </div>
                                </div>

                                <!-- 3. 세 번째: 기본 연락 정보 - 압축 + 가로 배치 -->
                                <div class="bg-gray-50 rounded-lg p-3">
                                    <h3 class="text-base font-semibold text-gray-800 mb-2">
                                        <i class="fas fa-address-card text-gray-600 mr-1"></i>연락 정보
                                    </h3>
                                    <div class="space-y-2 text-sm">
                                        <!-- 전화번호 + 이메일 (한 줄에 나란히) -->
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <span class="text-gray-600 font-medium">📞 전화번호:</span>
                                                <p id="detail-phone" class="text-gray-900 font-medium">-</p>
                                            </div>
                                            <div>
                                                <span class="text-gray-600 font-medium">📧 이메일:</span>
                                                <p id="detail-email" class="text-gray-900 font-medium">-</p>
                                            </div>
                                        </div>
                                        <!-- 주소 -->
                                        <div>
                                            <span class="text-gray-600 font-medium">🏠 주소:</span>
                                            <p id="detail-address" class="text-gray-900 font-medium">-</p>
                                        </div>
                                        <!-- 메모 (축소된 높이) -->
                                        <div>
                                            <span class="text-gray-600 font-medium">📝 메모:</span>
                                            <div id="detail-memo" class="text-gray-900 font-medium max-h-12 overflow-y-auto bg-white rounded px-2 py-1 mt-1 border">-</div>
                                        </div>
                                        <!-- 등록일 -->
                                        <div>
                                            <span class="text-gray-600 font-medium">📅 등록일:</span>
                                            <span id="detail-registration-date" class="text-gray-900 font-medium ml-2">-</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 4. 네 번째: 상세 주문 내역 테이블 (압축된 헤더) -->
                                <div class="bg-white border border-gray-200 rounded-lg">
                                    <div class="p-2.5 border-b border-gray-200">
                                        <h3 class="text-base font-semibold text-gray-800 flex items-center justify-between">
                                            <span>
                                                <i class="fas fa-shopping-cart text-orange-600 mr-1"></i>전체 주문 내역
                                            </span>
                                            <span id="detail-orders-count" class="text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded-full font-medium">총 0건</span>
                                        </h3>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <div id="customer-orders-list" class="min-h-[200px]">
                                            <!-- 고객의 주문 내역 테이블이 여기에 표시 -->
                                            <div class="p-4 text-center text-gray-500">
                                                <i class="fas fa-shopping-cart text-3xl mb-2 text-gray-300"></i>
                                                <p class="font-medium">주문 내역이 없습니다</p>
                                                <p class="text-xs mt-1">첫 주문을 기다리고 있어요! 🌱</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 상품관리 섹션 -->
        <div id="products-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">
                            <i class="fas fa-leaf mr-2 text-green-600"></i>상품 관리
                        </h2>
                        <div class="flex space-x-2">
                            <button id="manage-categories-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-tags mr-2"></i>카테고리 관리
                            </button>
                            <button id="print-labels-btn" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors hidden">
                                <i class="fas fa-print mr-2"></i>라벨 인쇄 (<span id="selected-count">0</span>)
                            </button>
                            <button id="toggle-inline-product-form" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-edit mr-2"></i><span id="inline-form-toggle-text">빠른 등록</span>
                            </button>
                            <button id="add-product-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-plus mr-2"></i>새 상품 등록
                            </button>
                        </div>
                    </div>
                    
                    <!-- 검색 및 필터 바 -->
                    <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
                        <div class="flex-1 relative">
                            <input type="text" id="product-management-search" placeholder="상품명, 설명으로 검색... (상품관리 전용)" 
                                   class="w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   autocomplete="off">
                            <button id="add-product-from-search" class="absolute right-2 top-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded transition-colors hidden">
                                <i class="fas fa-leaf"></i>
                            </button>
                            <div id="product-search-suggestions" class="absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-b-lg shadow-lg z-10 max-h-60 overflow-y-auto hidden">
                                <!-- 상품 검색 자동완성 목록이 여기에 표시됩니다 -->
                            </div>
                        </div>
                        <div class="w-full sm:w-40">
                            <select id="category-filter" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">전체 카테고리</option>
                                <!-- 카테고리 옵션들이 동적으로 추가됩니다 -->
                            </select>
                        </div>
                        <div class="w-full sm:w-48">
                            <select id="product-sort" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="newest">최근 등록순</option>
                                <option value="name_asc">상품명: 오름차순 (ㄱ→ㅎ)</option>
                                <option value="name_desc">상품명: 내림차순 (ㅎ→ㄱ)</option>
                            </select>
                        </div>
                        <button id="reset-product-search" class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-3 rounded-lg transition-colors">
                            <i class="fas fa-refresh"></i>
                        </button>
                    </div>
                </div>

                <!-- 인라인 상품 등록 아코디언 폼 -->
                <div id="inline-product-form" class="hidden border-b border-gray-200 bg-gray-50">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-edit text-purple-600 text-xl mr-3"></i>
                            <h3 class="text-lg font-semibold text-gray-800">빠른 상품 등록</h3>
                            <span class="ml-2 text-sm text-gray-500">(간편 입력)</span>
                            <div class="ml-auto">
                                <button id="close-inline-form" class="text-gray-400 hover:text-gray-600 transition-colors">
                                    <i class="fas fa-times text-lg"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- 2컬럼 압축 레이아웃 폼 (8개 핵심 항목만) - 최대한 콤팩트 -->
                        <form id="inline-product-form-element" class="grid grid-cols-1 md:grid-cols-2 gap-2">
                            <!-- 첫 번째 행: 상품명 + 카테고리 -->
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">상품명 <span class="text-red-500">*</span></label>
                                <input type="text" id="inline-product-name" placeholder="예: White Platter (대)" required
                                       class="w-full p-2 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">카테고리 <span class="text-red-500">*</span></label>
                                <div class="flex space-x-1">
                                    <select id="inline-product-category" required
                                            class="flex-1 p-2 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                                        <option value="">카테고리 선택</option>
                                        <!-- 카테고리 옵션들이 동적으로 추가됩니다 -->
                                        <option value="__ADD_NEW__" class="text-blue-600 font-medium">+ 새 카테고리 추가</option>
                                    </select>
                                    <button type="button" id="quick-add-category-inline" 
                                            class="px-2 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors text-sm"
                                            title="새 카테고리 빠른 추가">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                
                                <!-- 새 카테고리 입력 필드 (숨김 상태) - 압축됨 -->
                                <div id="inline-new-category-input" class="hidden mt-1 p-2 bg-blue-50 border border-blue-200 rounded">
                                    <div class="flex items-center space-x-1 mb-1">
                                        <i class="fas fa-tag text-blue-600 text-xs"></i>
                                        <span class="text-xs font-medium text-blue-800">새 카테고리 추가</span>
                                    </div>
                                    <div class="grid grid-cols-1 gap-1">
                                        <input type="text" id="inline-quick-category-name" placeholder="카테고리명 (예: 다육식물)" 
                                               class="p-1.5 border border-blue-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent">
                                        <select id="inline-quick-category-color" class="p-1.5 border border-blue-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent">
                                            <option value="bg-green-100 text-green-800">🟢 초록색</option>
                                            <option value="bg-blue-100 text-blue-800">🔵 파란색</option>
                                            <option value="bg-purple-100 text-purple-800">🟣 보라색</option>
                                            <option value="bg-red-100 text-red-800">🔴 빨간색</option>
                                            <option value="bg-yellow-100 text-yellow-800">🟡 노란색</option>
                                            <option value="bg-indigo-100 text-indigo-800">🔵 남색</option>
                                            <option value="bg-pink-100 text-pink-800">🩷 핑크색</option>
                                            <option value="bg-gray-100 text-gray-800">⚫ 회색</option>
                                        </select>
                                        <div class="flex space-x-1">
                                            <button type="button" id="save-inline-quick-category" 
                                                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors">
                                                <i class="fas fa-check mr-1"></i>추가하고 선택
                                            </button>
                                            <button type="button" id="cancel-inline-quick-category" 
                                                    class="px-2 py-1 text-gray-600 hover:text-gray-800 border border-gray-300 rounded text-xs transition-colors">
                                                취소
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 두 번째 행: 판매가 + 매입가 -->
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">판매가 <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <input type="number" id="inline-product-price" placeholder="0" min="0" step="1000" required
                                           class="w-full p-2 pr-6 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                                    <span class="absolute right-2 top-2 text-gray-500 text-xs">원</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">매입가</label>
                                <div class="relative">
                                    <input type="number" id="inline-product-wholesale-price" placeholder="0" min="0" step="1000"
                                           class="w-full p-2 pr-6 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                                    <span class="absolute right-2 top-2 text-gray-500 text-xs">원</span>
                                </div>
                            </div>

                            <!-- 세 번째 행: 재고수량 + 사이즈 -->
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">재고수량 <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <input type="number" id="inline-product-stock" placeholder="0" min="0" required
                                           class="w-full p-2 pr-6 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                                    <span class="absolute right-2 top-2 text-gray-500 text-xs">개</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">사이즈</label>
                                <select id="inline-product-size" 
                                        class="w-full p-2 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                                    <option value="">사이즈 선택</option>
                                    <option value="SX">SX (초소형)</option>
                                    <option value="S">S (소형)</option>
                                    <option value="M">M (중형)</option>
                                    <option value="L">L (대형)</option>
                                    <option value="XL">XL (초대형)</option>
                                </select>
                            </div>

                            <!-- 네 번째 행: 배송 옵션 (상세 설명 포함) -->
                            <div class="md:col-span-2">
                                <label class="block text-xs font-medium text-gray-700 mb-0.5">배송 옵션 <span class="text-red-500">*</span></label>
                                <select id="inline-product-shipping" required
                                        class="w-full p-2 border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-transparent text-sm">
                                    <option value="">배송 옵션 선택</option>
                                    <option value="always_free">무료배송 (행사상품)</option>
                                    <option value="normal">일반배송 (조건부 무료)</option>
                                    <option value="included">배송비포함 (단독배송)</option>
                                    <option value="direct">직접배송 (농장배송)</option>
                                </select>
                                <div class="text-xs text-gray-400 mt-0.5 space-y-0">
                                    <div>• <strong>무료배송</strong>: 금액 관계없이 항상 무료 (행사, 이벤트 상품)</div>
                                    <div>• <strong>일반배송</strong>: 5만원 이상 무료, 미만 시 4,000원</div>
                                    <div>• <strong>배송비포함</strong>: 상품 판매가에 배송비 포함됨 (용토, 화분 등)</div>
                                    <div>• <strong>직접배송</strong>: 농장에서 직접 배송 (특별 관리 필요 상품)</div>
                                </div>
                            </div>

                            <!-- 버튼 행 - 우측 하단 정렬 -->
                            <div class="md:col-span-2 flex justify-end space-x-2 pt-2 border-t border-gray-200">
                                <button type="button" id="cancel-inline-product" 
                                        class="px-3 py-1.5 text-gray-600 hover:text-gray-800 border border-gray-300 rounded hover:bg-gray-50 transition-colors text-sm">
                                    취소
                                </button>
                                <button type="submit" id="save-inline-product" 
                                        class="px-4 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded transition-colors text-sm">
                                    <i class="fas fa-save mr-1"></i>빠른 저장
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- 상품 목록 -->
                <div class="p-6">
                    <!-- 페이지네이션 컨트롤 -->
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center space-x-4">
                            <label class="text-sm text-gray-600">페이지당 표시:</label>
                            <select id="products-per-page" class="border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="20">20개</option>
                                <option value="50">50개</option>
                                <option value="all">전체</option>
                            </select>
                            <span id="products-count-info" class="text-sm text-gray-500"></span>
                        </div>
                        
                        <!-- 페이지 네비게이션 -->
                        <div id="products-pagination" class="flex items-center space-x-2"></div>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 w-12">
                                        <input type="checkbox" id="select-all-products" class="rounded text-green-600 focus:ring-green-500">
                                    </th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500">라벨수량</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500">상품명</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 hidden">카테고리</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500">사이즈</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500">판매가</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 hidden">매입가</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 hidden">수익률</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 hidden">배송</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500">재고</th>
                                    <th class="px-3 py-2 text-center text-sm font-medium text-gray-500">QR코드</th>
                                    <th class="px-3 py-2 text-center text-sm font-medium text-gray-500">관리</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 hidden">상태</th>
                                    <th class="px-3 py-2 text-left text-sm font-medium text-gray-500 hidden">등록일</th>
                                </tr>
                            </thead>
                            <tbody id="products-table-body" class="divide-y divide-gray-200">
                                <!-- 상품 목록이 여기에 표시됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 배송관리 섹션 -->
        <div id="shipping-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-semibold text-gray-800">
                            <i class="fas fa-truck mr-2 text-blue-600"></i>배송 관리
                        </h2>
                        <div class="flex space-x-3">
                            <!-- 배송 일괄 처리 버튼들 -->
                            <button id="bulk-ship-ready-btn" class="bg-orange-600 hover:bg-orange-700 text-white px-3 py-2 rounded-lg transition-colors hidden text-sm">
                                <i class="fas fa-box mr-1"></i>배송준비로 변경
                            </button>
                            <button id="bulk-status-change-shipping-btn" class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg transition-colors hidden text-sm">
                                <i class="fas fa-edit mr-1"></i>선택 주문 상태변경
                            </button>
                            <button id="bulk-export-shipping-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors hidden">
                                <i class="fas fa-file-excel mr-2"></i>📦 로젠택배 엑셀변환
                            </button>
                            <button id="bulk-tracking-shipping-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-barcode mr-2"></i>📝 송장번호 입력
                            </button>
                            <button id="quick-export-all-btn" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-download mr-2"></i>🚀 전체 엑셀변환
                            </button>
                        </div>
                    </div>
                    
                    <!-- 배송 상태별 필터 탭 -->
                    <div class="mt-4 border-b border-gray-200">
                        <nav class="flex space-x-1">
                            <button id="shipping-status-all" class="shipping-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 transition-colors active">
                                <i class="fas fa-list mr-2"></i>전체 <span class="ml-1 bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs" id="shipping-count-all">0</span>
                            </button>
                            <button id="shipping-status-입금확인" class="shipping-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors">
                                <i class="fas fa-money-check mr-2"></i>입금확인 <span class="ml-1 bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs" id="shipping-count-입금확인">0</span>
                            </button>
                            <button id="shipping-status-배송준비" class="shipping-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-orange-600 border-b-2 border-transparent hover:border-orange-600 transition-colors">
                                <i class="fas fa-box mr-2"></i>배송준비 <span class="ml-1 bg-orange-100 text-orange-600 px-2 py-1 rounded-full text-xs" id="shipping-count-배송준비">0</span>
                            </button>
                            <button id="shipping-status-배송시작" class="shipping-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-purple-600 border-b-2 border-transparent hover:border-purple-600 transition-colors">
                                <i class="fas fa-truck mr-2"></i>배송시작 <span class="ml-1 bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs" id="shipping-count-배송시작">0</span>
                            </button>
                            <button id="shipping-status-배송완료" class="shipping-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-emerald-600 border-b-2 border-transparent hover:border-emerald-600 transition-colors">
                                <i class="fas fa-check-circle mr-2"></i>배송완료 <span class="ml-1 bg-emerald-100 text-emerald-600 px-2 py-1 rounded-full text-xs" id="shipping-count-배송완료">0</span>
                            </button>
                        </nav>
                    </div>
                </div>
                
                <!-- 배송 통계 대시보드 -->
                <div class="p-6 border-b border-gray-200 bg-gray-50">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="bg-white p-4 rounded-lg shadow-sm border">
                            <div class="flex items-center">
                                <div class="p-2 bg-orange-100 rounded-lg">
                                    <i class="fas fa-box text-orange-600"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-gray-600">배송준비</p>
                                    <p id="pack-ready-count" class="text-xl font-bold text-orange-600">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border">
                            <div class="flex items-center">
                                <div class="p-2 bg-blue-100 rounded-lg">
                                    <i class="fas fa-truck text-blue-600"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-gray-600">배송시작</p>
                                    <p id="shipping-count" class="text-xl font-bold text-blue-600">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border">
                            <div class="flex items-center">
                                <div class="p-2 bg-green-100 rounded-lg">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-gray-600">배송완료</p>
                                    <p id="delivered-count" class="text-xl font-bold text-green-600">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border">
                            <div class="flex items-center">
                                <div class="p-2 bg-purple-100 rounded-lg">
                                    <i class="fas fa-calendar text-purple-600"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-gray-600">오늘 배송</p>
                                    <p id="today-shipping-count" class="text-xl font-bold text-purple-600">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 송장번호 검색 -->
                <div class="p-6 border-b border-gray-200">
                    <div class="flex space-x-3">
                        <div class="flex-1">
                            <input type="text" id="tracking-search" placeholder="송장번호로 주문 검색..." 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <button id="tracking-search-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors">
                            <i class="fas fa-search mr-2"></i>검색
                        </button>
                        <button id="clear-tracking-search" class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-3 rounded-lg transition-colors">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 배송 목록 -->
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">
                                        <input type="checkbox" id="select-all-shipping" class="rounded text-blue-600 focus:ring-blue-500">
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">주문번호</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">주문일자</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">고객명</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">전화번호</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">배송주소</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">상품</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">송장번호</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">상태</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-500">관리</th>
                                </tr>
                            </thead>
                            <tbody id="shipping-table-body" class="divide-y divide-gray-200">
                                <!-- 배송 목록이 여기에 표시됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 대기자관리 섹션 -->
        <div id="waitlist-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">
                            <i class="fas fa-clock mr-2 text-orange-600"></i>대기자 관리
                            <span class="text-sm text-gray-500 ml-2">상품 입고 시 연락할 고객들</span>
                        </h2>
                        <div class="flex gap-2">
                            <button id="add-waitlist-btn" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
                                <i class="fas fa-user-clock mr-2"></i>새 대기자 등록
                            </button>
                            <button onclick="orderSystem.emergencyWaitlistRecovery()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors" title="대기자 데이터 복구">
                                <i class="fas fa-ambulance mr-2"></i>데이터 복구
                            </button>
                        </div>
                    </div>
                    
                    <!-- 대기자 통계 -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                            <div class="flex items-center">
                                <i class="fas fa-clock text-orange-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-orange-700">대기중</p>
                                    <p id="waiting-count" class="text-xl font-bold text-orange-800">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <div class="flex items-center">
                                <i class="fas fa-phone text-blue-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-blue-700">연락완료</p>
                                    <p id="contacted-count" class="text-xl font-bold text-blue-800">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                            <div class="flex items-center">
                                <i class="fas fa-shopping-cart text-green-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-green-700">주문전환</p>
                                    <p id="converted-count" class="text-xl font-bold text-green-800">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                            <div class="flex items-center">
                                <i class="fas fa-times-circle text-red-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-red-700">취소</p>
                                    <p id="cancelled-count" class="text-xl font-bold text-red-800">0</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 대기자 상태별 필터 탭 -->
                    <div class="mb-4 border-b border-gray-200">
                        <nav class="flex space-x-1">
                            <button id="waitlist-status-all" class="waitlist-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-orange-600 border-b-2 border-transparent hover:border-orange-600 transition-colors active">
                                <i class="fas fa-list mr-2"></i>전체 <span class="ml-1 bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs" id="waitlist-count-all">0</span>
                            </button>
                            <button id="waitlist-status-대기중" class="waitlist-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-orange-600 border-b-2 border-transparent hover:border-orange-600 transition-colors">
                                <i class="fas fa-clock mr-2"></i>대기중 <span class="ml-1 bg-orange-100 text-orange-600 px-2 py-1 rounded-full text-xs" id="waitlist-count-대기중">0</span>
                            </button>
                            <button id="waitlist-status-연락완료" class="waitlist-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 transition-colors">
                                <i class="fas fa-phone mr-2"></i>연락완료 <span class="ml-1 bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs" id="waitlist-count-연락완료">0</span>
                            </button>
                            <button id="waitlist-status-주문전환" class="waitlist-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-green-600 border-b-2 border-transparent hover:border-green-600 transition-colors">
                                <i class="fas fa-shopping-cart mr-2"></i>주문전환 <span class="ml-1 bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs" id="waitlist-count-주문전환">0</span>
                            </button>
                            <button id="waitlist-status-취소" class="waitlist-tab-btn py-2 px-4 text-sm font-medium text-gray-600 hover:text-red-600 border-b-2 border-transparent hover:border-red-600 transition-colors">
                                <i class="fas fa-times-circle mr-2"></i>취소 <span class="ml-1 bg-red-100 text-red-600 px-2 py-1 rounded-full text-xs" id="waitlist-count-취소">0</span>
                            </button>
                        </nav>
                    </div>

                    <!-- 검색 바 -->
                    <div class="flex space-x-4">
                        <div class="flex-1">
                            <input type="text" id="waitlist-search" placeholder="고객명, 전화번호, 상품명으로 검색..." 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        </div>
                        <button id="reset-waitlist-search" class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-3 rounded-lg transition-colors">
                            <i class="fas fa-refresh"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 대기자 목록 -->
                <div id="waitlist-table-container" class="p-6">
                    <!-- 대기자 테이블이 JavaScript로 동적 렌더링됩니다 -->
                </div>
            </div>
        </div>

        <!-- 판매 채널 관리 섹션 -->
        <div id="channels-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800">
                            <i class="fas fa-store mr-2 text-purple-600"></i>판매 채널 관리
                            <span class="text-sm text-gray-500 ml-2">주문 출처 마스터 데이터 관리</span>
                        </h2>
                        <button id="add-channel-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-plus mr-2"></i>새 채널 추가
                        </button>
                    </div>
                    
                    <!-- 채널 통계 -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <div class="flex items-center">
                                <i class="fas fa-store text-purple-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-purple-600 text-sm font-medium">전체 채널</p>
                                    <p class="text-2xl font-bold text-purple-700" id="total-channels-count">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-green-600 text-sm font-medium">활성 채널</p>
                                    <p class="text-2xl font-bold text-green-700" id="active-channels-count">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <div class="flex items-center">
                                <i class="fas fa-chart-line text-blue-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-blue-600 text-sm font-medium">이번 달 주문</p>
                                    <p class="text-2xl font-bold text-blue-700" id="monthly-orders-count">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                            <div class="flex items-center">
                                <i class="fas fa-won-sign text-orange-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-orange-600 text-sm font-medium">이번 달 매출</p>
                                    <p class="text-2xl font-bold text-orange-700" id="monthly-revenue">0원</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 채널 목록 테이블 -->
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">채널명</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">설명</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">상태</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">주문 수</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">총 매출</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">관리</th>
                                </tr>
                            </thead>
                            <tbody id="channels-table-body" class="bg-white divide-y divide-gray-200">
                                <!-- 채널 목록이 여기에 표시됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 주문 상태 관리 섹션 -->
        <div id="order-status-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <!-- 헤더 -->
                <div class="border-b border-gray-200 p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-tasks mr-2 text-purple-600"></i>
                            <h2 class="text-xl font-semibold text-gray-800">주문 상태 관리</h2>
                        </div>
                        <button id="add-status-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center">
                            <i class="fas fa-plus mr-2"></i>새 상태 추가
                        </button>
                    </div>
                    <p class="text-gray-600 mt-2">주문 처리 과정의 상태를 관리하고 설정합니다.</p>
                </div>

                <!-- 주문 상태 목록 테이블 -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">순서</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">상태명</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">색상</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">설명</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">사용</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">관리</th>
                            </tr>
                        </thead>
                        <tbody id="order-status-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- 동적으로 생성될 상태 목록 -->
                        </tbody>
                    </table>
                </div>

                <!-- 주문 상태 통계 -->
                <div class="border-t border-gray-200 p-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">상태별 주문 현황</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="status-stats-container">
                        <!-- 동적으로 생성될 통계 카드 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 배송비 관리 섹션 -->
        <div id="shipping-settings-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <!-- 헤더 -->
                <div class="border-b border-gray-200 p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-truck mr-2 text-purple-600"></i>
                            <h2 class="text-xl font-semibold text-gray-800">배송비 관리</h2>
                        </div>
                        <button id="add-shipping-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center">
                            <i class="fas fa-plus mr-2"></i>새 배송비 규칙 추가
                        </button>
                    </div>
                    <p class="text-gray-600 mt-2">배송비 정책을 관리하고 설정합니다.</p>
                </div>

                <!-- 배송비 규칙 목록 -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">규칙명</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">조건</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">배송비</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">적용</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">관리</th>
                            </tr>
                        </thead>
                        <tbody id="shipping-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- 동적으로 생성될 배송비 규칙 목록 -->
                        </tbody>
                    </table>
                </div>

                <!-- 기본 배송비 설정 -->
                <div class="border-t border-gray-200 p-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">기본 배송비 설정</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <label class="block text-sm font-medium text-gray-700 mb-2">기본 배송비</label>
                            <div class="flex items-center">
                                <input type="number" id="default-shipping-fee" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm" placeholder="4000">
                                <span class="ml-2 text-sm text-gray-600">원</span>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <label class="block text-sm font-medium text-gray-700 mb-2">무료배송 기준</label>
                            <div class="flex items-center">
                                <input type="number" id="free-shipping-threshold" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm" placeholder="50000">
                                <span class="ml-2 text-sm text-gray-600">원 이상</span>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <label class="block text-sm font-medium text-gray-700 mb-2">제주/도서산간 추가비</label>
                            <div class="flex items-center">
                                <input type="number" id="remote-shipping-fee" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm" placeholder="3000">
                                <span class="ml-2 text-sm text-gray-600">원</span>
                            </div>
                        </div>
                    </div>
                    <button id="save-shipping-settings" class="mt-4 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        <i class="fas fa-save mr-2"></i>설정 저장
                    </button>
                </div>
            </div>
        </div>

        <!-- 고객등급 관리 섹션 -->
        <div id="customer-grade-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <!-- 헤더 -->
                <div class="border-b border-gray-200 p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-crown mr-2 text-purple-600"></i>
                            <h2 class="text-xl font-semibold text-gray-800">고객등급 관리</h2>
                        </div>
                        <button id="add-grade-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center">
                            <i class="fas fa-plus mr-2"></i>새 등급 추가
                        </button>
                    </div>
                    <p class="text-gray-600 mt-2">고객 등급과 혜택을 관리하고 설정합니다.</p>
                </div>

                <!-- 고객등급 목록 -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">등급</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">아이콘</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">조건</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">혜택</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">관리</th>
                            </tr>
                        </thead>
                        <tbody id="customer-grade-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- 동적으로 생성될 고객등급 목록 -->
                        </tbody>
                    </table>
                </div>

                <!-- 등급별 혜택 설정 -->
                <div class="border-t border-gray-200 p-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">등급별 혜택 설정</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <h4 class="font-medium text-gray-700">할인 혜택</h4>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">VIP 할인율</span>
                                    <div class="flex items-center">
                                        <input type="number" id="vip-discount" class="w-20 border border-gray-300 rounded px-2 py-1 text-sm" placeholder="10">
                                        <span class="ml-1 text-sm text-gray-600">%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">G등급 할인율</span>
                                    <div class="flex items-center">
                                        <input type="number" id="g-discount" class="w-20 border border-gray-300 rounded px-2 py-1 text-sm" placeholder="5">
                                        <span class="ml-1 text-sm text-gray-600">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <h4 class="font-medium text-gray-700">기타 혜택</h4>
                            <div class="space-y-3">
                                <label class="flex items-center">
                                    <input type="checkbox" id="vip-free-shipping" class="mr-2">
                                    <span class="text-sm text-gray-600">VIP 무료배송</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="g-free-shipping" class="mr-2">
                                    <span class="text-sm text-gray-600">G등급 무료배송</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="early-access" class="mr-2">
                                    <span class="text-sm text-gray-600">신상품 우선 구매</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <button id="save-grade-settings" class="mt-4 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        <i class="fas fa-save mr-2"></i>설정 저장
                    </button>
                </div>
            </div>
        </div>

        <!-- 경영 대시보드 섹션 -->
        <div id="analytics-section" class="tab-content hidden">
            <!-- 대시보드 헤더 -->
            <div class="mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900 flex items-center">
                            <i class="fas fa-chart-line text-blue-600 mr-3"></i>
                            경영 대시보드
                        </h1>
                        <p class="text-gray-600 mt-1">경산다육농장의 매출 현황과 핵심 지표를 한눈에 확인하세요</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <select id="dashboard-period" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="7">최근 7일</option>
                            <option value="30" selected>최근 30일</option>
                            <option value="90">최근 90일</option>
                        </select>
                        <button id="refresh-analytics" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                            <i class="fas fa-sync-alt mr-2"></i>새로고침
                        </button>
                    </div>
                </div>
            </div>

            <!-- 매출 현황 섹션 -->
            <div class="bg-white rounded-lg shadow-md mb-6">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                        <i class="fas fa-won-sign text-blue-600 mr-2"></i>매출 현황
                    </h2>
                </div>
                <div class="p-6">
                    <!-- 핵심 요약 카드 -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <!-- 총 매출액 카드 -->
                        <div class="bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-green-600 uppercase tracking-wide">총 매출액</p>
                                    <p class="text-2xl font-bold text-green-700 mt-2" id="total-revenue">0원</p>
                                </div>
                                <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center">
                                    <i class="fas fa-won-sign text-white text-lg"></i>
                                </div>
                            </div>
                        </div>

                        <!-- 총 주문 건수 카드 -->
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-blue-600 uppercase tracking-wide">총 주문 건수</p>
                                    <p class="text-2xl font-bold text-blue-700 mt-2" id="total-orders">0건</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
                                    <i class="fas fa-shopping-cart text-white text-lg"></i>
                                </div>
                            </div>
                        </div>

                        <!-- 총 판매된 상품 수 카드 -->
                        <div class="bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-purple-600 uppercase tracking-wide">총 판매된 상품 수</p>
                                    <p class="text-2xl font-bold text-purple-700 mt-2" id="total-products-sold">0개</p>
                                </div>
                                <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center">
                                    <i class="fas fa-leaf text-white text-lg"></i>
                                </div>
                            </div>
                        </div>

                        <!-- 객단가 카드 -->
                        <div class="bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-orange-600 uppercase tracking-wide">객단가</p>
                                    <p class="text-2xl font-bold text-orange-700 mt-2" id="average-order-value">0원</p>
                                </div>
                                <div class="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center">
                                    <i class="fas fa-calculator text-white text-lg"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 매출 추이 그래프 -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-800">매출 추이</h3>
                                <div class="flex space-x-2">
                                    <button class="sales-period-btn px-3 py-1 text-sm rounded-full bg-blue-100 text-blue-700 font-medium" data-period="daily">일별</button>
                                    <button class="sales-period-btn px-3 py-1 text-sm rounded-full text-gray-600 hover:bg-gray-100" data-period="weekly">주별</button>
                                    <button class="sales-period-btn px-3 py-1 text-sm rounded-full text-gray-600 hover:bg-gray-100" data-period="monthly">월별</button>
                                </div>
                            </div>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="sales-trend-chart" class="w-full h-full"></canvas>
                            </div>
                        </div>
                        
                        <!-- 판매 채널 비중 -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="text-lg font-medium text-gray-800 mb-4">판매 채널 비중</h3>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="sales-channel-chart" class="w-full h-full"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 상품 및 고객 분석 섹션 -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <!-- 주간 베스트셀러 TOP 5 -->
                <div class="bg-white rounded-lg shadow-md">
                    <div class="p-6 border-b border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                            <i class="fas fa-trophy text-yellow-500 mr-2"></i>주간 베스트셀러 TOP 5
                        </h3>
                    </div>
                    <div class="p-6">
                        <div id="weekly-bestseller-list" class="space-y-3">
                            <!-- 베스트셀러 목록이 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>

                <!-- VIP 고객 순위 TOP 10 -->
                <div class="bg-white rounded-lg shadow-md">
                    <div class="p-6 border-b border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                            <i class="fas fa-crown text-purple-500 mr-2"></i>VIP 고객 순위 TOP 10
                        </h3>
                    </div>
                    <div class="p-6">
                        <div id="vip-customer-list" class="space-y-2">
                            <!-- VIP 고객 목록이 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>

                <!-- 신규/재구매 고객 분석 -->
                <div class="bg-white rounded-lg shadow-md">
                    <div class="p-6 border-b border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                            <i class="fas fa-users text-blue-500 mr-2"></i>신규/재구매 고객 분석
                        </h3>
                        <p class="text-sm text-gray-600 mt-1">최근 30일 기준</p>
                    </div>
                    <div class="p-6">
                        <div class="h-48 flex items-center justify-center mb-4">
                            <canvas id="customer-analysis-chart" class="w-full h-full"></canvas>
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <p class="text-sm text-gray-600">신규 고객</p>
                                <p class="text-xl font-bold text-green-600" id="new-customer-count">0명</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">재구매 고객</p>
                                <p class="text-xl font-bold text-blue-600" id="returning-customer-count">0명</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 데이터 백업 섹션 -->
        <div id="backup-section" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <i class="fas fa-shield-alt mr-2 text-orange-600"></i>데이터 백업 관리
                        <span class="text-sm text-gray-500 ml-2">소중한 데이터를 안전하게 보관하세요</span>
                    </h2>
                </div>

                <!-- 긴급 백업 카드 -->
                <div class="p-6 border-b border-gray-200">
                    <div class="bg-gradient-to-r from-orange-500 to-red-500 rounded-lg shadow-lg p-6 text-center">
                        <h3 class="text-2xl font-bold text-white mb-4">
                            <i class="fas fa-exclamation-triangle mr-2"></i>🚨 긴급 데이터 백업
                        </h3>
                        <p class="text-orange-100 mb-6">모든 데이터를 안전하게 컴퓨터에 저장합니다</p>
                        <button id="emergency-backup-main" class="bg-white hover:bg-gray-100 text-orange-600 font-bold px-8 py-4 rounded-lg text-lg transition-colors shadow-lg">
                            <i class="fas fa-download mr-2"></i>💾 지금 즉시 백업하기
                        </button>
                    </div>
                </div>

                <!-- 앱 캐시 강제 갱신 카드 -->
                <div class="p-6 border-b border-gray-200">
                    <div class="bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg shadow-lg p-6 text-center">
                        <h3 class="text-2xl font-bold text-white mb-4">
                            <i class="fas fa-sync-alt mr-2"></i>🔄 앱 강제 업데이트
                        </h3>
                        <p class="text-blue-100 mb-6">앱이 제대로 작동하지 않을 때 사용하세요 (캐시 완전 삭제)</p>
                        <button id="force-app-update" class="bg-white hover:bg-gray-100 text-blue-600 font-bold px-8 py-4 rounded-lg text-lg transition-colors shadow-lg">
                            <i class="fas fa-refresh mr-2"></i>🚀 앱 강제 업데이트하기
                        </button>
                    </div>
                </div>

                <!-- 백업 통계 -->
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                        <i class="fas fa-chart-bar mr-2"></i>현재 저장된 데이터 현황
                    </h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 text-center">
                            <i class="fas fa-users text-blue-600 text-2xl mb-2"></i>
                            <p class="text-sm text-blue-700 font-medium">고객</p>
                            <p id="backup-customers-count" class="text-xl font-bold text-blue-600">-</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200 text-center">
                            <i class="fas fa-shopping-cart text-green-600 text-2xl mb-2"></i>
                            <p class="text-sm text-green-700 font-medium">주문</p>
                            <p id="backup-orders-count" class="text-xl font-bold text-green-600">-</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200 text-center">
                            <i class="fas fa-leaf text-purple-600 text-2xl mb-2"></i>
                            <p class="text-sm text-purple-700 font-medium">상품</p>
                            <p id="backup-products-count" class="text-xl font-bold text-purple-600">-</p>
                        </div>
                        <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-200 text-center">
                            <i class="fas fa-tags text-indigo-600 text-2xl mb-2"></i>
                            <p class="text-sm text-indigo-700 font-medium">카테고리</p>
                            <p id="backup-categories-count" class="text-xl font-bold text-indigo-600">-</p>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200 text-center">
                            <i class="fas fa-store text-yellow-600 text-2xl mb-2"></i>
                            <p class="text-sm text-yellow-700 font-medium">주문출처</p>
                            <p id="backup-sources-count" class="text-xl font-bold text-yellow-600">-</p>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200 text-center">
                            <i class="fas fa-clock text-orange-600 text-2xl mb-2"></i>
                            <p class="text-sm text-orange-700 font-medium">대기자</p>
                            <p id="backup-waitlist-count" class="text-xl font-bold text-orange-600">-</p>
                        </div>
                    </div>
                </div>

                <!-- 데이터 복구 섹션 -->
                <div class="p-6 border-b border-gray-200 bg-blue-50">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                        <i class="fas fa-upload mr-2 text-blue-600"></i>데이터 복구 (백업 파일에서 복원)
                    </h3>
                    <div class="bg-white p-4 rounded-lg border border-blue-200">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h4 class="font-medium text-gray-800">백업 파일 업로드</h4>
                                <p class="text-sm text-gray-600">이전에 다운로드한 JSON 백업 파일을 선택하여 데이터를 복구하세요</p>
                            </div>
                            <div class="flex space-x-2">
                                <input type="file" id="backup-restore-input" accept=".json" class="hidden">
                                <button id="select-backup-file" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                                    <i class="fas fa-folder-open mr-2"></i>파일 선택
                                </button>
                                <button id="restore-backup-data" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors" disabled>
                                    <i class="fas fa-upload mr-2"></i>복구 시작
                                </button>
                            </div>
                        </div>
                        
                        <!-- 선택된 파일 정보 -->
                        <div id="selected-file-info" class="hidden bg-gray-50 p-3 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-file-code text-blue-600 mr-2"></i>
                                    <div>
                                        <p id="selected-file-name" class="font-medium text-gray-800"></p>
                                        <p id="selected-file-details" class="text-sm text-gray-600"></p>
                                    </div>
                                </div>
                                <button id="clear-selected-file" class="text-red-600 hover:text-red-800 text-sm">
                                    <i class="fas fa-times mr-1"></i>제거
                                </button>
                            </div>
                        </div>
                        
                        <!-- 백업 파일 미리보기 -->
                        <div id="backup-preview" class="hidden mt-4">
                            <h5 class="font-medium text-gray-700 mb-2">백업 파일 내용 미리보기:</h5>
                            <div class="bg-gray-100 p-3 rounded text-sm max-h-32 overflow-y-auto">
                                <div id="backup-preview-content">
                                    <!-- 백업 파일 내용이 여기에 표시됩니다 -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- 복구 옵션 -->
                        <div id="restore-options" class="hidden mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <h5 class="font-medium text-yellow-800 mb-2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>복구 옵션
                            </h5>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="radio" name="restore-mode" value="replace" class="mr-2" checked>
                                    <span class="text-sm text-yellow-700">
                                        <strong>전체 교체</strong> - 기존 데이터를 모두 삭제하고 백업으로 교체
                                    </span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="restore-mode" value="merge" class="mr-2">
                                    <span class="text-sm text-yellow-700">
                                        <strong>병합 모드</strong> - 기존 데이터에 백업 데이터를 추가 (중복 방지)
                                    </span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="backup-current-before-restore" class="mr-2" checked>
                                    <span class="text-sm text-yellow-700">
                                        <strong>복구 전 현재 데이터 자동 백업</strong> (안전장치)
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 백업 방법들 -->
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                        <i class="fas fa-tools mr-2"></i>백업 방법 선택
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                            <div class="text-center mb-4">
                                <i class="fas fa-file-code text-gray-600 text-3xl mb-2"></i>
                                <h4 class="font-semibold text-gray-800">JSON 백업</h4>
                                <p class="text-sm text-gray-600">모든 데이터를 JSON 파일로 저장</p>
                            </div>
                            <button id="json-backup-btn" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors">
                                <i class="fas fa-download mr-2"></i>JSON 백업
                            </button>
                        </div>
                        
                        <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                            <div class="text-center mb-4">
                                <i class="fas fa-file-excel text-green-600 text-3xl mb-2"></i>
                                <h4 class="font-semibold text-gray-800">Excel 백업</h4>
                                <p class="text-sm text-gray-600">주문 데이터를 Excel로 내보내기</p>
                            </div>
                            <button id="excel-backup-btn" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors">
                                <i class="fas fa-table mr-2"></i>Excel 백업
                            </button>
                        </div>
                        
                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                            <div class="text-center mb-4">
                                <i class="fas fa-sync text-blue-600 text-3xl mb-2"></i>
                                <h4 class="font-semibold text-gray-800">API 동기화</h4>
                                <p class="text-sm text-gray-600">서버와 데이터 동기화</p>
                            </div>
                            <button id="api-sync-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors mb-2">
                                <i class="fas fa-cloud-upload-alt mr-2"></i>API 동기화
                            </button>
                            <button id="browser-sync-btn" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors mb-2">
                                <i class="fas fa-browser mr-2"></i>브라우저 동기화
                            </button>
                            <button id="smart-sync-btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg transition-colors">
                                <i class="fas fa-brain mr-2"></i>스마트 동기화
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 백업 가이드 -->
                <div class="p-6 bg-yellow-50 border-t border-yellow-200">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-4">
                        <i class="fas fa-lightbulb mr-2"></i>백업 가이드
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium text-yellow-800 mb-2">💾 권장 백업 주기</h4>
                            <ul class="text-sm text-yellow-700 space-y-1">
                                <li>• <strong>매일</strong>: 중요 작업 후 JSON 백업</li>
                                <li>• <strong>매주</strong>: 전체 데이터 Excel 백업</li>
                                <li>• <strong>매월</strong>: 장기 보관용 백업</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-medium text-yellow-800 mb-2">🛡️ 안전한 보관 방법</h4>
                            <ul class="text-sm text-yellow-700 space-y-1">
                                <li>• 구글 드라이브에 업로드</li>
                                <li>• USB 메모리에 복사</li>
                                <li>• 이메일로 자신에게 발송</li>
                                <li>• 여러 장소에 분산 보관</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 주문 등록/수정 모달 -->
    <div id="order-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-screen overflow-y-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 id="modal-title" class="text-lg font-semibold text-gray-800">새 주문 등록</h3>
                        <button id="close-modal" onclick="orderSystem.closeOrderModal()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <form id="order-form" class="p-6">
                    <!-- 주문 폼 내용이 여기에 들어갑니다 -->
                </form>
            </div>
        </div>
    </div>

    <!-- 문자 내용 모달 -->
    <div id="sms-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-lg">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">문자 내용</h3>
                        <button id="close-sms-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div class="p-6">
                    <textarea id="sms-content" class="w-full h-32 p-3 border border-gray-300 rounded-lg resize-none" readonly></textarea>
                    <div class="mt-4 flex gap-2">
                        <button id="copy-sms" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-copy mr-2"></i>복사하기
                        </button>
                        <button id="send-sms" class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-paper-plane mr-2"></i>솔라피 발송
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 송장번호 일괄입력 모달 -->
    <div id="tracking-import-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">
                            <i class="fas fa-barcode mr-2 text-orange-600"></i>송장번호 일괄입력
                        </h3>
                        <button id="close-tracking-import-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div class="p-6">
                    <!-- 업로드 방식 선택 -->
                    <div class="mb-4">
                        <div class="flex space-x-4 mb-4">
                            <button id="upload-method-manual" class="flex-1 py-2 px-4 text-sm font-medium text-center text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 focus:ring-2 focus:ring-blue-500 active">
                                <i class="fas fa-keyboard mr-2"></i>직접 입력
                            </button>
                            <button id="upload-method-excel" class="flex-1 py-2 px-4 text-sm font-medium text-center text-gray-600 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 focus:ring-2 focus:ring-gray-500">
                                <i class="fas fa-file-excel mr-2"></i>엑셀 업로드
                            </button>
                        </div>
                    </div>

                    <!-- 직접 입력 방식 -->
                    <div id="manual-input-section">
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-3">
                                💡 로젠택배에서 발급받은 송장번호를 주문번호와 함께 입력해주세요.
                            </p>
                            <div class="bg-blue-50 p-4 rounded-lg mb-4">
                                <h4 class="font-medium text-blue-800 mb-2">입력 형식 예시:</h4>
                                <div class="text-sm text-blue-700 font-mono">
                                    KS20241201001,1234567890123<br>
                                    KS20241201002,1234567890124<br>
                                    KS20241201003,1234567890125
                                </div>
                            </div>
                        </div>
                        <textarea id="tracking-import-text" class="w-full h-32 p-3 border border-gray-300 rounded-lg resize-none" 
                                  placeholder="주문번호,송장번호 형식으로 입력하세요 (한 줄에 하나씩)"></textarea>
                    </div>

                    <!-- 엑셀 업로드 방식 -->
                    <div id="excel-upload-section" class="hidden">
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-3">
                                📊 엑셀 파일을 업로드하여 송장번호를 일괄 등록할 수 있습니다.
                            </p>
                            <div class="bg-green-50 p-4 rounded-lg mb-4">
                                <h4 class="font-medium text-green-800 mb-2">엑셀 파일 형식 요구사항:</h4>
                                <div class="text-sm text-green-700">
                                    • <strong>A열:</strong> 주문번호 (예: KS20241201001)<br>
                                    • <strong>B열:</strong> 송장번호 (예: 1234567890123)<br>
                                    • <strong>첫 번째 행:</strong> 제목 행 (자동 제외됨)
                                </div>
                            </div>
                        </div>
                        
                        <!-- 파일 업로드 영역 -->
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-green-500 transition-colors">
                            <input type="file" id="tracking-excel-input" accept=".xlsx,.xls" class="hidden">
                            <div id="upload-area-content">
                                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                <p class="text-gray-600 mb-2">엑셀 파일을 선택하거나 드래그하여 업로드하세요</p>
                                <button type="button" onclick="document.getElementById('tracking-excel-input').click()" 
                                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                    <i class="fas fa-folder-open mr-2"></i>파일 선택
                                </button>
                                <p class="text-xs text-gray-500 mt-2">지원 형식: .xlsx, .xls</p>
                            </div>
                            <div id="upload-file-info" class="hidden">
                                <i class="fas fa-file-excel text-4xl text-green-600 mb-2"></i>
                                <p id="upload-file-name" class="text-sm font-medium text-gray-700"></p>
                                <p id="upload-file-size" class="text-xs text-gray-500"></p>
                                <button type="button" onclick="orderSystem.clearUploadedFile()" 
                                        class="text-red-600 hover:text-red-800 text-xs mt-2">
                                    <i class="fas fa-times mr-1"></i>파일 제거
                                </button>
                            </div>
                        </div>
                        
                        <!-- 미리보기 영역 -->
                        <div id="excel-preview-area" class="hidden mt-4">
                            <h4 class="font-medium text-gray-700 mb-2">📋 미리보기 (처음 5행)</h4>
                            <div class="bg-gray-50 p-3 rounded-lg">
                                <table id="excel-preview-table" class="w-full text-sm">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="px-3 py-2 text-left">주문번호</th>
                                            <th class="px-3 py-2 text-left">송장번호</th>
                                        </tr>
                                    </thead>
                                    <tbody id="excel-preview-tbody">
                                        <!-- 미리보기 데이터가 여기에 표시됩니다 -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-3 mt-4">
                        <button id="import-tracking-numbers" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors flex-1">
                            <i class="fas fa-upload mr-2"></i><span id="import-button-text">송장번호 일괄 적용</span>
                        </button>
                        <button id="close-tracking-import-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            취소
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 엑셀 미리보기 모달 -->
    <div id="excel-preview-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-screen overflow-y-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">
                            <i class="fas fa-file-excel mr-2 text-green-600"></i>로젠택배 엑셀 미리보기
                        </h3>
                        <button id="close-excel-preview-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h4 class="font-medium text-blue-800 mb-2">📊 엑셀 파일 정보</h4>
                            <div id="excel-info" class="text-sm text-blue-700">
                                <!-- 엑셀 정보가 여기에 표시됩니다 -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- 엑셀 미리보기 테이블 -->
                    <div class="overflow-x-auto border border-gray-200 rounded-lg">
                        <table class="w-full text-xs">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium bg-blue-50"><span class="text-blue-600 font-bold">A</span><br><small class="text-blue-600">주문번호 🆕</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">B<br><small>받는분</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">C<br><small>공란</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">D<br><small>받는분 주소</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">E<br><small>받는분 전화</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">F<br><small>공란</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">G<br><small>수량</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">H<br><small>운임</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">I<br><small>공란</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">J<br><small>상품명</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">K<br><small>공란</small></th>
                                    <th class="px-2 py-2 text-left text-gray-600 font-medium">L<br><small>배송메모</small></th>
                                </tr>
                            </thead>
                            <tbody id="excel-preview-body" class="divide-y divide-gray-200">
                                <!-- 미리보기 데이터가 여기에 표시됩니다 -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="flex justify-between items-center mt-6">
                        <div class="text-sm text-gray-600">
                            💡 위 내용이 엑셀 파일로 생성됩니다
                        </div>
                        <div class="flex space-x-3">
                            <button id="cancel-excel-export" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                                취소
                            </button>
                            <button id="confirm-excel-export" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors">
                                <i class="fas fa-download mr-2"></i>엑셀 파일 생성
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 고객 등록/수정 모달 -->
    <div id="customer-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl">
                <div class="p-4 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 id="customer-modal-title" class="text-lg font-semibold text-gray-800">새 고객 등록</h3>
                        <button id="close-customer-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <form id="customer-form" class="p-4">
                    <div class="space-y-4">
                        <!-- 고객명 + 전화번호 (한 줄에 나란히) -->
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-user text-green-600 mr-1"></i>고객명 <span class="text-red-500">*</span>
                                </label>
                                <input type="text" id="customer-form-name" placeholder="고객명을 입력하세요" required
                                       class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-phone text-green-600 mr-1"></i>전화번호 <span class="text-red-500">*</span>
                                </label>
                                <input type="tel" id="customer-form-phone" placeholder="010-1234-5678" required
                                       class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm">
                            </div>
                        </div>

                        <!-- 주소 + 이메일 (한 줄에 나란히) -->
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-map-marker-alt text-green-600 mr-1"></i>주소
                                </label>
                                <div class="flex gap-2">
                                    <input type="text" id="customer-form-address" placeholder="주소를 검색하세요" readonly
                                           class="flex-1 p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm bg-gray-50">
                                    <button type="button" id="customer-form-address-search" 
                                            class="px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium">
                                        <i class="fas fa-search mr-1"></i>주소검색
                                    </button>
                                </div>
                                <input type="text" id="customer-form-address-detail" placeholder="상세주소를 입력하세요"
                                       class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm mt-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-envelope text-green-600 mr-1"></i>이메일
                                </label>
                                <input type="email" id="customer-form-email" placeholder="이메일을 입력하세요"
                                       class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm">
                            </div>
                        </div>

                        <!-- 고객등급 + 등록일 (한 줄에 나란히) -->
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-star text-green-600 mr-1"></i>고객등급
                                </label>
                                <select id="customer-form-grade" class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm">
                                    <option value="GENERAL">🙋‍♂️ 일반</option>
                                    <option value="GREEN_LEAF">🟢 그린 리프</option>
                                    <option value="RED_RUBY">🔴 레드 루비</option>
                                    <option value="PURPLE_EMPEROR">🟣 퍼플 엠페러</option>
                                    <option value="BLACK_DIAMOND">💎 블랙 다이아몬드</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-calendar text-green-600 mr-1"></i>등록일
                                </label>
                                <input type="date" id="customer-form-registration-date" 
                                       class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm">
                            </div>
                        </div>

                        <!-- 메모 (전체 너비) -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                <i class="fas fa-sticky-note text-green-600 mr-1"></i>메모
                            </label>
                            <textarea id="customer-form-memo" rows="2" placeholder="고객 관련 메모를 입력하세요"
                                      class="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none text-sm"></textarea>
                        </div>
                    </div>

                    <div class="mt-4 flex justify-end space-x-3 pt-3 border-t">
                        <button type="button" onclick="orderSystem.closeCustomerModal()" 
                                class="px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm">
                            취소
                        </button>
                        <button type="button" onclick="orderSystem.saveCustomer()" 
                                class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm">
                            저장
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 고객 주문이력 모달 -->
    <div id="customer-orders-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-screen overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 id="customer-orders-title" class="text-xl font-bold text-gray-800">고객 주문이력</h3>
                            <p id="customer-orders-subtitle" class="text-sm text-gray-600 mt-1">모든 주문 데이터가 시간순으로 표시됩니다</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <!-- 보기 모드 토글 버튼 -->
                            <div class="flex bg-gray-100 rounded-lg p-1">
                                <button id="view-card-btn" class="px-3 py-2 text-sm font-medium rounded-md transition-colors bg-blue-600 text-white" onclick="orderSystem.setOrderHistoryView('card')">
                                    <i class="fas fa-th-large mr-1"></i>카드
                                </button>
                                <button id="view-table-btn" class="px-3 py-2 text-sm font-medium rounded-md transition-colors text-gray-600 hover:text-gray-800" onclick="orderSystem.setOrderHistoryView('table')">
                                    <i class="fas fa-table mr-1"></i>표
                                </button>
                            </div>
                            <button id="close-customer-orders-modal" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-2xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="flex h-96">
                    <!-- 왼쪽: 고객 정보 및 통계 -->
                    <div class="w-1/3 bg-gray-50 p-6 border-r">
                        <div id="customer-summary" class="space-y-4">
                            <!-- 고객 요약 정보가 여기에 표시됩니다 -->
                        </div>
                    </div>
                    
                    <!-- 오른쪽: 주문 이력 목록 -->
                    <div class="flex-1 overflow-y-auto">
                        <div id="customer-orders-content" class="p-6">
                            <!-- 주문이력이 여기에 표시됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 상품 선택 모달 (주문관리용) -->
    <div id="product-list-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-screen overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">
                            <i class="fas fa-leaf mr-2 text-green-600"></i>상품 목록에서 선택
                        </h3>
                        <button id="close-product-list-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <!-- 상품 검색 -->
                    <div class="mt-4 flex space-x-4">
                        <div class="flex-1">
                            <input type="text" id="product-list-search" placeholder="상품명으로 빠른 검색..." 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                        <div class="w-40">
                            <select id="product-list-category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">전체 카테고리</option>
                                <!-- 카테고리 옵션들이 동적으로 추가됩니다 -->
                            </select>
                        </div>
                        <button onclick="orderSystem.filterProductList()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <div class="p-6 max-h-96 overflow-y-auto">
                    <div id="product-list-container">
                        <!-- 상품 목록이 여기에 표시됩니다 -->
                    </div>
                </div>
                
                <div class="p-6 border-t border-gray-200 bg-gray-50">
                    <div class="flex justify-between items-center">
                        <p class="text-sm text-gray-600">
                            <i class="fas fa-info-circle mr-1"></i>
                            상품을 클릭하여 주문에 추가하거나, 직접 입력도 가능합니다.
                        </p>
                        <button onclick="orderSystem.closeProductListModal()" 
                                class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors font-medium">
                            <i class="fas fa-check mr-2"></i>선택 완료
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 카테고리 관리 모달 -->
    <div id="category-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-screen overflow-y-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">
                            <i class="fas fa-tags mr-2 text-blue-600"></i>카테고리 관리
                        </h3>
                        <button id="close-category-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <div class="p-6">
                    <!-- 새 카테고리 추가 -->
                    <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-medium text-gray-800 mb-3">새 카테고리 추가</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">카테고리명</label>
                                <input type="text" id="new-category-name" placeholder="예: 대형종" 
                                       class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">색상</label>
                                <select id="new-category-color" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="bg-purple-100 text-purple-800">보라색</option>
                                    <option value="bg-green-100 text-green-800">초록색</option>
                                    <option value="bg-blue-100 text-blue-800">파란색</option>
                                    <option value="bg-red-100 text-red-800">빨간색</option>
                                    <option value="bg-yellow-100 text-yellow-800">노란색</option>
                                    <option value="bg-indigo-100 text-indigo-800">남색</option>
                                    <option value="bg-pink-100 text-pink-800">핑크색</option>
                                    <option value="bg-gray-100 text-gray-800">회색</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">설명</label>
                                <input type="text" id="new-category-description" placeholder="카테고리에 대한 간단한 설명" 
                                       class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                        </div>
                        <button onclick="orderSystem.addCategory()" class="mt-3 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors">
                            <i class="fas fa-plus mr-2"></i>카테고리 추가
                        </button>
                    </div>

                    <!-- 기존 카테고리 목록 -->
                    <div>
                        <h4 class="font-medium text-gray-800 mb-3">기존 카테고리</h4>
                        <div id="categories-list" class="space-y-2">
                            <!-- 카테고리 목록이 여기에 표시됩니다 -->
                        </div>
                    </div>
                    
                    <!-- 모달 하단 버튼들 -->
                    <div class="border-t border-gray-200 px-6 py-4 bg-gray-50 flex justify-end space-x-3">
                        <button id="category-modal-cancel" class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors">
                            <i class="fas fa-times mr-2"></i>취소
                        </button>
                        <button id="category-modal-save" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors">
                            <i class="fas fa-check mr-2"></i>저장 완료
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 상품 등록/수정 모달 -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-screen overflow-y-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 id="product-modal-title" class="text-lg font-semibold text-gray-800">새 상품 등록</h3>
                        <button id="close-product-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <form id="product-form" class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">상품명 <span class="text-red-500">*</span></label>
                            <input type="text" id="product-form-name" placeholder="예: White Platter (대)" required
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">카테고리 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <select id="product-form-category" required
                                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent pr-10">
                                    <option value="">카테고리 선택</option>
                                    <!-- 카테고리 옵션들이 동적으로 추가됩니다 -->
                                    <option value="__ADD_NEW__" class="text-blue-600 font-medium">+ 새 카테고리 추가</option>
                                </select>
                                <button type="button" id="modal-quick-add-category-btn" 
                                        class="absolute right-2 top-3 text-blue-600 hover:text-blue-800"
                                        title="새 카테고리 빠른 추가">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                            
                            <!-- 새 카테고리 입력 필드 (숨김 상태) -->
                            <div id="modal-new-category-input" class="hidden mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i class="fas fa-tag text-blue-600"></i>
                                    <span class="text-sm font-medium text-blue-800">새 카테고리 추가</span>
                                </div>
                                <div class="grid grid-cols-2 gap-2">
                                    <input type="text" id="modal-quick-category-name" placeholder="카테고리명" 
                                           class="p-2 border border-blue-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <select id="modal-quick-category-color" class="p-2 border border-blue-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <option value="bg-purple-100 text-purple-800">🟣 보라색</option>
                                        <option value="bg-green-100 text-green-800">🟢 초록색</option>
                                        <option value="bg-blue-100 text-blue-800">🔵 파란색</option>
                                        <option value="bg-red-100 text-red-800">🔴 빨간색</option>
                                        <option value="bg-yellow-100 text-yellow-800">🟡 노란색</option>
                                        <option value="bg-indigo-100 text-indigo-800">🟣 남색</option>
                                        <option value="bg-pink-100 text-pink-800">🩷 핑크색</option>
                                        <option value="bg-gray-100 text-gray-800">⚫ 회색</option>
                                    </select>
                                </div>
                                <div class="flex space-x-2 mt-2">
                                    <button type="button" id="modal-save-quick-category" 
                                            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded transition-colors">
                                        <i class="fas fa-check mr-1"></i>추가
                                    </button>
                                    <button type="button" id="modal-cancel-quick-category" 
                                            class="px-3 py-1.5 text-gray-600 hover:text-gray-800 border border-gray-300 rounded transition-colors">
                                        취소
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">판매가 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <input type="number" id="product-form-price" placeholder="0" min="0" step="1000" required
                                       class="w-full p-3 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                       oninput="orderSystem.calculateModalProfitMargin()">
                                <span class="absolute right-3 top-3 text-gray-500">원</span>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">매입가</label>
                            <div class="relative">
                                <input type="number" id="product-form-wholesale-price" placeholder="0" min="0" step="1000"
                                       class="w-full p-3 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                       oninput="orderSystem.calculateModalProfitMargin()">
                                <span class="absolute right-3 top-3 text-gray-500">원</span>
                            </div>
                            <div id="modal-profit-margin" class="text-sm text-gray-500 mt-1"></div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">재고수량 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <input type="number" id="product-form-stock" placeholder="0" min="0" required
                                       class="w-full p-3 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <span class="absolute right-3 top-3 text-gray-500">개</span>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">사이즈</label>
                            <div class="space-y-2">
                                <select id="product-form-size-select" onchange="orderSystem.handleSizeChange()" 
                                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">사이즈 선택</option>
                                    <option value="SX">SX (초소형)</option>
                                    <option value="S">S (소형)</option>
                                    <option value="M">M (중형)</option>
                                    <option value="L">L (대형)</option>
                                    <option value="XL">XL (초대형)</option>
                                    <option value="custom">직접 기입</option>
                                </select>
                                <input type="text" id="product-form-size-custom" placeholder="예: 3-5cm, 특대, 혼합 등" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent hidden">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">배송 옵션 <span class="text-red-500">*</span></label>
                            <select id="product-form-shipping" required
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">배송 옵션 선택</option>
                                <option value="always_free">무료배송 (행사상품)</option>
                                <option value="normal">일반배송 (조건부 무료)</option>
                                <option value="included">배송비포함 (단독배송)</option>
                                <option value="direct">직접배송 (농장배송)</option>
                            </select>
                            <div class="text-sm text-gray-500 mt-1">
                                <div>• <strong>무료배송</strong>: 금액 관계없이 항상 무료 (행사, 이벤트 상품)</div>
                                <div>• <strong>일반배송</strong>: 5만원 이상 무료, 미만 시 4,000원</div>
                                <div>• <strong>배송비포함</strong>: 상품 판매가에 배송비 포함됨 (용토, 화분 등)</div>
                                <div>• <strong>직접배송</strong>: 농장에서 직접 배송 (특별 관리 필요 상품)</div>
                            </div>
                        </div>

                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">상품설명</label>
                            <textarea id="product-form-description" rows="3" placeholder="상품에 대한 자세한 설명을 입력하세요"
                                      class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none"></textarea>
                        </div>

                        <!-- 태그 입력 섹션 -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">태그 (Tags)</label>
                            <div class="relative">
                                <!-- 태그 컨테이너 -->
                                <div id="product-tags-container" class="w-full min-h-[46px] p-2 border border-gray-300 rounded-lg focus-within:ring-2 focus-within:ring-green-500 focus-within:border-transparent bg-white cursor-text">
                                    <div id="product-tags-display" class="flex flex-wrap gap-2 mb-2">
                                        <!-- 생성된 태그들이 여기에 표시됩니다 -->
                                    </div>
                                    <input type="text" 
                                           id="product-tag-input" 
                                           placeholder="태그를 입력하고 엔터를 누르세요 (예: 실내식물, 초보자추천, 공기정화)"
                                           class="w-full border-0 outline-none text-sm"
                                           autocomplete="off">
                                </div>
                                
                                <!-- 자동완성 드롭다운 -->
                                <div id="product-tag-suggestions" class="absolute top-full left-0 right-0 z-10 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-48 overflow-y-auto hidden">
                                    <!-- 추천 태그들이 여기에 표시됩니다 -->
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">
                                💡 <strong>엔터(Enter)</strong> 또는 <strong>쉼표(,)</strong>를 눌러 태그를 추가하세요. 기존 태그가 자동으로 추천됩니다.
                            </p>
                            
                            <!-- 숨겨진 input (실제 데이터 저장용) -->
                            <input type="hidden" id="product-form-tags" name="tags" value="">
                        </div>

                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">상품 이미지 URL</label>
                            <input type="url" id="product-form-image" placeholder="https://example.com/image.jpg"
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <p class="text-sm text-gray-500 mt-1">💡 이미지 URL을 입력하면 상품 목록에서 미리보기를 볼 수 있습니다.</p>
                        </div>



                        <!-- QR코드 생성 섹션 -->
                        <div class="md:col-span-2">
                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                                <h4 class="font-medium text-blue-800 mb-2">
                                    <i class="fas fa-qrcode mr-2"></i>QR코드 생성 (시스템 통합 기능)
                                </h4>
                                <div class="bg-blue-100 px-3 py-2 rounded mb-3 text-sm text-blue-700">
                                    📍 <strong>유일한 QR 생성 위치</strong>: 모든 QR코드는 이 섹션에서만 생성됩니다
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-blue-700 mb-2">QR코드 정보</label>
                                        <div class="space-y-2">
                                            <label class="flex items-center">
                                                <input type="radio" name="qr-type" value="product-info" class="mr-2" checked>
                                                <span class="text-sm text-gray-700">상품 정보 (이름, 판매가)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="qr-type" value="product-url" class="mr-2">
                                                <span class="text-sm text-gray-700">상품 URL</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="qr-type" value="custom" class="mr-2">
                                                <span class="text-sm text-gray-700">직접 입력</span>
                                            </label>
                                        </div>
                                        <input type="text" id="qr-custom-text" placeholder="QR코드에 포함할 내용을 입력하세요"
                                               class="w-full p-2 mt-2 border border-gray-300 rounded text-sm hidden">
                                        <button type="button" id="generate-qr-btn" 
                                                class="mt-3 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-colors">
                                            <i class="fas fa-qrcode mr-2"></i>QR코드 생성
                                        </button>
                                    </div>
                                    <div class="flex flex-col items-center">
                                        <label class="block text-sm font-medium text-blue-700 mb-2">미리보기</label>
                                        <div id="qr-preview" class="w-32 h-32 border-2 border-dashed border-blue-300 rounded-lg flex items-center justify-center bg-white">
                                            <span class="text-blue-400 text-sm">QR코드가 여기에<br>생성됩니다</span>
                                        </div>
                                        <div class="mt-2 space-x-2">
                                            <button type="button" id="download-qr-btn" 
                                                    class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs transition-colors hidden">
                                                <i class="fas fa-download mr-1"></i>다운로드
                                            </button>
                                            <button type="button" id="print-qr-btn" 
                                                    class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition-colors hidden">
                                                <i class="fas fa-print mr-1"></i>프린트
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 재고 부족 알림 설정 -->
                    <div class="mt-6 bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-medium text-gray-800 mb-2">
                            <i class="fas fa-bell text-yellow-600 mr-2"></i>재고 관리 설정
                        </h4>
                        <div class="flex items-center space-x-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="enable-stock-alert" class="mr-2">
                                <span class="text-sm text-gray-700">재고 부족 알림 활성화</span>
                            </label>
                            <div class="flex items-center space-x-2">
                                <label class="text-sm text-gray-700">알림 기준:</label>
                                <input type="number" id="stock-alert-threshold" value="5" min="0" max="50"
                                       class="w-16 p-1 border border-gray-300 rounded text-center text-sm">
                                <span class="text-sm text-gray-700">개 이하</span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex justify-end space-x-3 pt-6 border-t">
                        <button type="button" onclick="orderSystem.closeProductModal()" 
                                class="px-6 py-3 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                            취소
                        </button>
                        <button type="button" onclick="orderSystem.saveProduct()" 
                                class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                            저장
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 대기자 등록/수정 모달 -->
    <div id="waitlist-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 id="waitlist-modal-title" class="text-lg font-semibold text-gray-800">새 대기자 등록</h3>
                        <button id="close-waitlist-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <form id="waitlist-form" class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">고객명 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <input type="text" id="waitlist-form-name" placeholder="고객명을 입력하세요 (자동완성 지원)" required
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                       autocomplete="off">
                                <div id="waitlist-customer-suggestions" class="absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-b-lg shadow-lg z-10 max-h-48 overflow-y-auto hidden">
                                    <!-- 고객 자동완성 목록이 여기에 표시됩니다 -->
                                </div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">연락처 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <input type="tel" id="waitlist-form-phone" placeholder="010-1234-5678" required
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                <div class="text-xs text-gray-500 mt-1">💡 고객명 입력시 자동으로 채워집니다</div>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">원하는 상품 <span class="text-red-500">*</span></label>
                            <input type="text" id="waitlist-form-product" placeholder="예: White Platter 대형" required
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">카테고리</label>
                            <select id="waitlist-form-category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                <option value="">카테고리 선택</option>
                                <!-- 카테고리 옵션들이 동적으로 추가됩니다 -->
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">예상 판매가</label>
                            <div class="relative">
                                <input type="number" id="waitlist-form-price" placeholder="0" min="0" step="1000"
                                       class="w-full p-3 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                <span class="absolute right-3 top-3 text-gray-500">원</span>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">우선순위</label>
                            <select id="waitlist-form-priority" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                <option value="3">보통</option>
                                <option value="5">높음</option>
                                <option value="4">중요</option>
                                <option value="2">낮음</option>
                                <option value="1">대기</option>
                            </select>
                        </div>

                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">메모</label>
                            <textarea id="waitlist-form-memo" rows="3" placeholder="고객 요구사항, 특이사항 등을 기록하세요"
                                      class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none"></textarea>
                        </div>
                    </div>

                    <!-- 도움말 -->
                    <div class="mt-4 bg-orange-50 p-4 rounded-lg">
                        <h4 class="font-medium text-orange-800 mb-2">
                            <i class="fas fa-lightbulb text-orange-600 mr-2"></i>대기자 관리 팁
                        </h4>
                        <ul class="text-sm text-orange-700 space-y-1">
                            <li>• <strong>우선순위</strong>: 높음 > 중요 > 보통 > 낮음 > 대기 순으로 연락</li>
                            <li>• <strong>상품 입고시</strong>: 해당 상품 대기자들에게 일괄 연락 가능</li>
                            <li>• <strong>주문 전환</strong>: 연락 후 주문하시면 자동으로 상태 변경</li>
                        </ul>
                    </div>

                    <div class="mt-6 flex justify-end space-x-3 pt-6 border-t">
                        <button type="button" onclick="orderSystem.closeWaitlistModal()" 
                                class="px-6 py-3 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                            취소
                        </button>
                        <button type="button" onclick="orderSystem.saveWaitlistForm()" 
                                class="px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors">
                            저장
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 피킹 리스트 모달 -->
    <div id="picking-list-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-clipboard-list mr-2 text-purple-600"></i>피킹 리스트
                        </h3>
                        <button id="close-picking-list-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4 p-4 bg-purple-50 rounded-lg">
                        <h4 class="font-semibold text-purple-800 mb-2">📦 배송준비 상태 주문 요약</h4>
                        <div class="grid grid-cols-3 gap-4 text-sm">
                            <div>총 주문: <span id="picking-total-orders" class="font-bold text-purple-600">0</span>건</div>
                            <div>총 상품: <span id="picking-total-items" class="font-bold text-purple-600">0</span>개</div>
                            <div>예상 작업시간: <span id="picking-estimated-time" class="font-bold text-purple-600">0</span>분</div>
                        </div>
                    </div>
                    
                    <!-- 상품별 피킹 리스트 -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">🌱 상품별 피킹 리스트</h4>
                        <div id="picking-product-list" class="space-y-2">
                            <!-- 상품별 정리된 리스트가 여기에 표시됩니다 -->
                        </div>
                    </div>
                    
                    <!-- 고객별 포장 리스트 -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">📋 고객별 포장 리스트</h4>
                        <div id="picking-customer-list" class="space-y-3">
                            <!-- 고객별 포장 정보가 여기에 표시됩니다 -->
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button id="print-picking-only" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-seedling mr-2"></i>상품별 피킹만
                        </button>
                        <button id="print-packaging-only" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-box mr-2"></i>고객별 포장만
                        </button>
                        <button id="print-picking-list" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>전체 출력
                        </button>
                        <button id="close-picking-list-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 포장 라벨 모달 -->
    <div id="packaging-labels-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-5xl w-full max-h-screen overflow-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-tags mr-2 text-indigo-600"></i>포장 라벨 출력
                        </h3>
                        <button id="close-packaging-labels-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4 p-4 bg-indigo-50 rounded-lg">
                        <h4 class="font-semibold text-indigo-800 mb-2">🏷️ 라벨 설정</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">라벨 크기</label>
                                <select id="label-size" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                    <option value="small">소형 (5x3cm)</option>
                                    <option value="medium" selected>중형 (8x5cm)</option>
                                    <option value="large">대형 (10x7cm)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">한 줄당 라벨 수</label>
                                <select id="labels-per-row" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                    <option value="2">2개</option>
                                    <option value="3" selected>3개</option>
                                    <option value="4">4개</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div id="packaging-labels-preview" class="mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50 min-h-96">
                        <!-- 라벨 미리보기가 여기에 표시됩니다 -->
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button id="print-packaging-labels" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>라벨 출력
                        </button>
                        <button id="close-packaging-labels-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 주문서 출력 모달 -->
    <div id="order-receipt-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-receipt mr-2 text-purple-600"></i>주문서 출력 설정
                        </h3>
                        <button id="close-order-receipt-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- QR코드 포함 여부 -->
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" id="include-qr-code" class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500" checked>
                                <span class="ml-2 text-sm font-medium text-gray-700">QR코드 포함</span>
                            </label>
                        </div>
                        
                        <!-- QR코드 URL 입력 -->
                        <div id="qr-code-section">
                            <label class="block text-sm font-medium text-gray-700 mb-2">QR코드 연결 URL</label>
                            <input type="url" id="qr-code-url" 
                                   class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm"
                                   placeholder="https://youtube.com/@경산다육TV"
                                   value="https://youtube.com/@경산다육TV">
                            <p class="text-xs text-gray-500 mt-1">키우는 법 영상, 유튜브 채널 등 URL 입력</p>
                        </div>
                        
                        <!-- 미리보기 QR코드 -->
                        <div id="qr-preview-section" class="text-center">
                            <p class="text-sm text-gray-600 mb-2">QR코드 미리보기:</p>
                            <div id="qr-code-preview" class="flex justify-center">
                                <!-- QR코드가 여기에 생성됩니다 -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button id="print-order-receipt" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>주문서 출력
                        </button>
                        <button id="close-order-receipt-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 대량 QR코드 프린트 모달 -->
    <div id="bulk-print-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-print mr-2 text-purple-600"></i>대량 QR코드 프린트
                        </h2>
                        <button id="close-bulk-print-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>

                    <div class="mb-4">
                        <p class="text-gray-600 mb-4">🏷️ 프린트할 상품을 선택하고 각각의 수량을 입력하세요.</p>
                        
                        <!-- 전체 선택/해제 -->
                        <div class="flex items-center justify-between mb-4 p-3 bg-gray-50 rounded-lg">
                            <label class="flex items-center">
                                <input type="checkbox" id="select-all-products" class="mr-2">
                                <span class="font-medium text-gray-700">전체 선택</span>
                            </label>
                            <div class="text-sm text-gray-600">
                                선택된 상품: <span id="selected-count">0</span>개 | 
                                총 라벨 수: <span id="total-labels">0</span>장
                            </div>
                        </div>

                        <!-- 상품 목록 -->
                        <div id="bulk-print-products" class="space-y-3 max-h-96 overflow-y-auto border border-gray-200 rounded-lg p-4">
                            <!-- 상품 목록이 여기에 동적으로 생성됩니다 -->
                        </div>
                    </div>

                    <!-- 라벨 설정 -->
                    <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                        <h3 class="font-medium text-blue-800 mb-3">
                            <i class="fas fa-cog mr-2"></i>라벨 설정
                        </h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">페이지당 열 수</label>
                                <select id="labels-per-row" class="w-full p-2 border border-gray-300 rounded">
                                    <option value="8">8열</option>
                                    <option value="10" selected>10열</option>
                                    <option value="12">12열</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">용지 크기</label>
                                <select id="paper-size" class="w-full p-2 border border-gray-300 rounded">
                                    <option value="a4" selected>A4</option>
                                    <option value="letter">Letter</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end space-x-3">
                        <button id="preview-bulk-print" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-eye mr-2"></i>미리보기
                        </button>
                        <button id="start-bulk-print" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>프린트 시작
                        </button>
                        <button id="close-bulk-print-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 상품별 피킹 미리보기 모달 -->
    <div id="picking-preview-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-6xl w-full max-h-screen overflow-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-seedling mr-2 text-green-600"></i>상품별 피킹 체크리스트 미리보기
                        </h3>
                        <button id="close-picking-preview-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div id="picking-preview-content" class="mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50 min-h-96">
                        <!-- 미리보기 내용이 여기에 표시됩니다 -->
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button id="print-picking-preview" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>피킹 리스트 출력
                        </button>
                        <button id="close-picking-preview-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 고객별 포장 미리보기 모달 -->
    <div id="packaging-preview-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-6xl w-full max-h-screen overflow-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-box mr-2 text-orange-600"></i>고객별 포장 체크리스트 미리보기
                        </h3>
                        <button id="close-packaging-preview-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div id="packaging-preview-content" class="mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50 min-h-96">
                        <!-- 미리보기 내용이 여기에 표시됩니다 -->
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button id="print-packaging-preview" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>포장 리스트 출력
                        </button>
                        <button id="close-packaging-preview-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 피킹/포장 미리보기 모달 -->
    <div id="picking-preview-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-6xl w-full max-h-screen overflow-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 id="picking-preview-title" class="text-xl font-bold text-gray-800">
                            <i class="fas fa-eye mr-2 text-blue-600"></i>출력 미리보기
                        </h3>
                        <button id="close-picking-preview-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <!-- 미리보기 내용 -->
                    <div id="picking-preview-content" class="mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50 min-h-96 overflow-auto">
                        <!-- 미리보기 내용이 여기에 표시됩니다 -->
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button id="print-preview-content" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-print mr-2"></i>출력하기
                        </button>
                        <button id="close-picking-preview-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                            닫기
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR 라벨 미리보기 모달 -->
    <div id="qr-label-preview-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-screen overflow-auto">
                <div class="p-6 border-b border-gray-200">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-qrcode mr-2 text-orange-600"></i>QR 라벨 미리보기
                        </h3>
                        <button id="close-qr-label-preview-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="text-orange-800">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <span class="font-medium">라벨 정보</span>
                                </div>
                                <div class="text-sm text-orange-700">
                                    <span>크기: 1.3cm × 4cm</span>
                                    <span class="mx-2">|</span>
                                    <span>용지: A4</span>
                                    <span class="mx-2">|</span>
                                    <span id="total-labels">총 0개 라벨</span>
                                </div>
                            </div>
                            <div class="flex space-x-3">
                                <button id="print-qr-labels" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors">
                                    <i class="fas fa-print mr-2"></i>인쇄하기
                                </button>
                                <button id="close-qr-label-modal-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                                    닫기
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- A4 미리보기 영역 -->
                <div class="p-6 bg-gray-100">
                    <div id="qr-labels-container" class="bg-white mx-auto" style="width: 210mm; min-height: 297mm; padding: 10mm;">
                        <!-- QR 라벨들이 여기에 동적으로 생성됩니다 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 일괄 상태변경 모달 -->
    <div id="bulk-status-change-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
                <div class="flex items-center justify-between p-6 border-b">
                    <h3 class="text-lg font-semibold text-gray-800">
                        <i class="fas fa-edit mr-2 text-green-600"></i>일괄 상태변경
                    </h3>
                    <button id="close-bulk-status-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <div class="mb-4">
                        <p class="text-sm text-gray-600 mb-2">
                            선택된 <span id="selected-orders-count" class="font-bold text-green-600">0</span>개 주문의 상태를 변경합니다.
                        </p>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">변경할 상태 선택</label>
                        <select id="bulk-status-select" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <option value="">상태를 선택하세요</option>
                            <option value="주문접수">📝 주문접수</option>
                            <option value="입금확인">💰 입금확인</option>
                            <option value="배송준비">📦 배송준비</option>
                            <option value="배송시작">🚚 배송시작</option>
                            <option value="배송완료">✅ 배송완료</option>
                            <option value="주문취소">❌ 주문취소</option>
                            <option value="환불처리">🔄 환불처리</option>
                        </select>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button id="cancel-bulk-status" class="px-6 py-3 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                            취소
                        </button>
                        <button id="confirm-bulk-status" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                            <i class="fas fa-check mr-2"></i>변경 확인
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 판매 채널 관리 모달 -->
    <div id="channel-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 id="channel-modal-title" class="text-lg font-semibold text-gray-800">새 판매 채널 추가</h3>
                        <button id="close-channel-modal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <form id="channel-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">채널명 *</label>
                            <input type="text" id="channel-name" required 
                                   class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                   placeholder="예: 네이버 스마트스토어">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">설명</label>
                            <textarea id="channel-description" rows="3"
                                      class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                      placeholder="채널에 대한 간단한 설명을 입력하세요"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">아이콘</label>
                            <select id="channel-icon" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                <option value="fas fa-store">🏪 상점</option>
                                <option value="fas fa-shopping-cart">🛒 쇼핑몰</option>
                                <option value="fas fa-mobile-alt">📱 모바일</option>
                                <option value="fas fa-video">📹 영상</option>
                                <option value="fas fa-phone">📞 전화</option>
                                <option value="fas fa-envelope">✉️ 메시지</option>
                                <option value="fas fa-users">👥 직접</option>
                                <option value="fas fa-globe">🌐 온라인</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">색상</label>
                            <select id="channel-color" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                <option value="#10B981">🟢 초록색</option>
                                <option value="#3B82F6">🔵 파란색</option>
                                <option value="#F59E0B">🟡 노란색</option>
                                <option value="#EF4444">🔴 빨간색</option>
                                <option value="#8B5CF6">🟣 보라색</option>
                                <option value="#06B6D4">🔷 청록색</option>
                                <option value="#F97316">🟠 주황색</option>
                                <option value="#84CC16">🟢 연두색</option>
                            </select>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="channel-active" checked
                                   class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500">
                            <label for="channel-active" class="ml-2 text-sm text-gray-700">활성 상태</label>
                        </div>
                    </form>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button id="cancel-channel" class="px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors">
                            취소
                        </button>
                        <button id="save-channel" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                            저장
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 주문 상태 등록/수정 모달 -->
    <div id="order-status-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
                <div class="flex items-center justify-between p-6 border-b border-gray-200">
                    <h3 id="order-status-modal-title" class="text-lg font-semibold text-gray-800">새 주문 상태 추가</h3>
                    <button id="close-order-status-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <form id="order-status-form">
                        <input type="hidden" id="order-status-id" name="id">
                        
                        <div class="mb-4">
                            <label for="order-status-name" class="block text-sm font-medium text-gray-700 mb-2">
                                상태명 <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="order-status-name" name="name" required 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                   placeholder="예: 입금확인">
                        </div>

                        <div class="mb-4">
                            <label for="order-status-color" class="block text-sm font-medium text-gray-700 mb-2">
                                색상
                            </label>
                            <select id="order-status-color" name="color" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                                <option value="bg-gray-100 text-gray-800">회색</option>
                                <option value="bg-blue-100 text-blue-800">파란색</option>
                                <option value="bg-green-100 text-green-800">초록색</option>
                                <option value="bg-yellow-100 text-yellow-800">노란색</option>
                                <option value="bg-orange-100 text-orange-800">주황색</option>
                                <option value="bg-red-100 text-red-800">빨간색</option>
                                <option value="bg-purple-100 text-purple-800">보라색</option>
                                <option value="bg-pink-100 text-pink-800">분홍색</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label for="order-status-description" class="block text-sm font-medium text-gray-700 mb-2">
                                설명
                            </label>
                            <textarea id="order-status-description" name="description" rows="3"
                                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                                      placeholder="이 상태에 대한 설명을 입력하세요"></textarea>
                        </div>

                        <div class="mb-4">
                            <label for="order-status-sort-order" class="block text-sm font-medium text-gray-700 mb-2">
                                정렬 순서
                            </label>
                            <input type="number" id="order-status-sort-order" name="sort_order" min="1" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                                   placeholder="1">
                        </div>

                        <div class="mb-4">
                            <div class="flex items-center">
                                <input type="checkbox" id="order-status-is-active" name="is_active" checked
                                       class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500">
                                <label for="order-status-is-active" class="ml-2 text-sm text-gray-700">
                                    활성 상태
                                </label>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">비활성화하면 새 주문에서 선택할 수 없습니다</p>
                        </div>
                    </form>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button id="cancel-order-status" class="px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors">
                            취소
                        </button>
                        <button id="save-order-status" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                            저장
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 라벨 인쇄 옵션 선택 모달 -->
    <div id="label-print-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
                <div class="flex items-center justify-between p-6 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-800">라벨 인쇄 옵션 선택</h3>
                    <button id="close-label-print-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <p class="text-gray-600 mb-6">선택된 <span id="modal-selected-count">0</span>개 상품의 라벨을 인쇄합니다.</p>
                    
                    <!-- 라벨 타입 선택 -->
                    <div class="space-y-4">
                        <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-500 transition-colors cursor-pointer" id="text-label-option">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center" id="text-radio">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full hidden" id="text-dot"></div>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-800">텍스트 라벨</h4>
                                        <p class="text-sm text-gray-500">상품명 + 가격만 표시</p>
                                    </div>
                                </div>
                                <div class="text-gray-400">
                                    <i class="fas fa-font text-2xl"></i>
                                </div>
                            </div>
                            <div class="mt-3 text-xs text-gray-500 bg-gray-50 p-2 rounded">
                                📐 A4 가로 22×4 배치 (총 88개)<br>
                                📏 개별 라벨: 1.3cm × 5.0cm<br>
                                ✂️ 재단선 포함
                            </div>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg p-4 hover:border-green-500 transition-colors cursor-pointer" id="qr-label-option">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center" id="qr-radio">
                                        <div class="w-3 h-3 bg-green-600 rounded-full hidden" id="qr-dot"></div>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-800">QR 라벨</h4>
                                        <p class="text-sm text-gray-500">QR코드 + 상품정보</p>
                                    </div>
                                </div>
                                <div class="text-gray-400">
                                    <i class="fas fa-qrcode text-2xl"></i>
                                </div>
                            </div>
                            <div class="mt-3 text-xs text-gray-500 bg-gray-50 p-2 rounded">
                                📱 QR코드로 상품 정보를 스캔 가능<br>
                                📋 상품명, 가격, 카테고리 등 전체 정보<br>
                                🏢 농장 연락처 포함
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button id="cancel-label-print" class="px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors">
                            취소
                        </button>
                        <button id="proceed-label-print" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg transition-colors" disabled>
                            인쇄 진행
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 즉시 로컬 모드 설정 (연결 확인중 문제 해결) -->
    <script>
        // 페이지 로드와 동시에 즉시 실행
        (function() {
            console.log('🚀 즉시 로컬 모드 설정 시작...');
            
            // 즉시 실행 함수
            function fixConnectionStatus() {
                const statusText = document.getElementById('api-status-text');
                const statusDot = document.getElementById('api-status-dot');
                const statusIndicator = document.getElementById('api-status-indicator');
                
                if (statusText) {
                    statusText.textContent = '로컬 전용';
                    console.log('✅ API 상태 텍스트 즉시 업데이트됨');
                }
                if (statusDot) {
                    statusDot.className = 'w-2 h-2 rounded-full bg-blue-400';
                    statusDot.style.animation = 'none';
                    console.log('✅ API 상태 점 즉시 업데이트됨');
                }
                if (statusIndicator) {
                    statusIndicator.className = 'flex items-center space-x-2 px-3 py-1 rounded-lg text-sm bg-blue-100 text-blue-800';
                    console.log('✅ API 상태 인디케이터 즉시 업데이트됨');
                }
            }
            
            // 즉시 실행
            fixConnectionStatus();
            
            // 0.1초 후에 다시 실행
            setTimeout(fixConnectionStatus, 100);
            
            // 0.5초 후에 다시 한번 확인
            setTimeout(function() {
                const statusText = document.getElementById('api-status-text');
                if (statusText && statusText.textContent === '연결 확인중...') {
                    statusText.textContent = '로컬 전용';
                    console.log('🔄 API 상태 재설정 완료');
                }
            }, 500);
            
            // 1초 후에 최종 확인
            setTimeout(fixConnectionStatus, 1000);
        })();
    </script>
    
    <!-- 인증 시스템 (최우선 로드) -->
    <script src="js/auth-system.js?v=1.0.7"></script>
    
    <!-- 완전 로컬 모드 전환 (서버 500 오류 해결) -->
    <script src="js/force-local-mode.js?v=1.0.3"></script>
    
    <!-- 연결 상태 모니터링 및 오류 처리 -->
    <script>
        // 즉시 API 상태를 로컬 모드로 설정
        function setLocalModeImmediately() {
            const statusText = document.getElementById('api-status-text');
            const statusDot = document.getElementById('api-status-dot');
            const statusIndicator = document.getElementById('api-status-indicator');
            
            if (statusText) {
                statusText.textContent = '로컬 전용';
            }
            if (statusDot) {
                statusDot.className = 'w-2 h-2 rounded-full bg-blue-400';
            }
            if (statusIndicator) {
                statusIndicator.className = 'flex items-center space-x-2 px-3 py-1 rounded-lg text-sm bg-blue-100 text-blue-800';
            }
        }
        
        // 연결 상태 모니터링
        function checkConnectionStatus() {
            const banner = document.getElementById('connection-error-banner');
            if (!banner) {
                const errorBanner = document.createElement('div');
                errorBanner.id = 'connection-error-banner';
                errorBanner.className = 'connection-error-banner hidden';
                errorBanner.innerHTML = '⚠️ 네트워크 연결 문제가 있습니다. 오프라인 모드로 작동합니다.';
                document.body.insertBefore(errorBanner, document.body.firstChild);
            }
            
            // 온라인/오프라인 상태 감지
            function updateConnectionStatus() {
                const banner = document.getElementById('connection-error-banner');
                if (navigator.onLine) {
                    banner.classList.add('hidden');
                } else {
                    banner.classList.remove('hidden');
                }
            }
            
            window.addEventListener('online', updateConnectionStatus);
            window.addEventListener('offline', updateConnectionStatus);
            updateConnectionStatus();
        }
        
        // 페이지 로드 시 즉시 로컬 모드 설정
        document.addEventListener('DOMContentLoaded', function() {
            setLocalModeImmediately();
            checkConnectionStatus();
        });
        
        // DOM이 로드되기 전에도 실행
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setLocalModeImmediately);
        } else {
            setLocalModeImmediately();
        }
    </script>
    
    <!-- 500 오류 완전 차단 (가장 먼저 로드) -->
    <script>
        console.log('🛡️ 500 오류 차단 시스템 즉시 활성화...');
        
        // 즉시 fetch 함수 오버라이드 (중복 방지)
        if (!window.originalFetch) {
            window.originalFetch = window.fetch;
        }
        window.fetch = async function(url, options = {}) {
            if (typeof url === 'string' && url.includes('tables/')) {
                console.log(`🔄 API 호출 차단: ${url}`);
                
                const tableName = url.split('tables/')[1].split('?')[0];
                let localData = [];
                
                try {
                    const stored = localStorage.getItem(tableName);
                    if (stored) {
                        localData = JSON.parse(stored);
                    }
                } catch (e) {
                    console.warn(`로컬 데이터 로드 실패: ${tableName}`, e);
                }
                
                return new Response(JSON.stringify({
                    data: localData,
                    total: localData.length,
                    page: 1,
                    limit: 100,
                    table: tableName,
                    message: 'local_success'
                }), {
                    status: 200,
                    headers: { 'Content-Type': 'application/json' }
                });
            }
            
            // API가 아닌 요청은 원래대로
            return window.originalFetch(url, options);
        };
        
        // 오류 메시지 완전 차단
        const originalError = console.error;
        console.error = function(...args) {
            const message = args.join(' ');
            if (message.includes('500') || 
                message.includes('API') || 
                message.includes('Failed to fetch') ||
                message.includes('tables/')) {
                return; // 500 관련 오류 완전 숨김
            }
            originalError.apply(console, args);
        };
        
        // 네트워크 오류도 차단
        window.addEventListener('error', function(event) {
            if (event.message && 
                (event.message.includes('500') || 
                 event.message.includes('Failed to fetch') ||
                 event.message.includes('tables/'))) {
                event.preventDefault();
                event.stopPropagation();
                return false;
            }
        }, true);
        
        console.log('✅ 500 오류 차단 완료 - 깔끔한 환경 준비됨');
    </script>
    
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" onerror="console.warn('⚠️ Supabase CDN 로딩 실패 - LocalStorage 모드로 동작');"></script>
    
    <!-- 인증 시스템 강제 실행 -->
    <script>
        // 인증 시스템이 다른 스크립트에 의해 방해받지 않도록 보호
        (function() {
            console.log('🔐 인증 시스템 보호 모드 활성화');
            
            // 인증 시스템이 로드되었는지 확인
            if (typeof window.authSystem !== 'undefined') {
                console.log('✅ 인증 시스템 로드 확인됨');
                
                // 다른 스크립트들이 로드되기 전에 인증 상태 확인
                setTimeout(() => {
                    if (window.authSystem && !window.authSystem.isAuthenticated) {
                        console.log('🔒 인증되지 않은 상태 - 로그인 모달 표시');
                        window.authSystem.showLoginModal();
                        window.authSystem.protectPage();
                    }
                }, 100);
            } else {
                console.error('❌ 인증 시스템 로드 실패!');
            }
        })();
        
        // 비밀번호 보기/숨기기 토글 함수
        window.togglePasswordVisibility = function() {
            console.log('👁️ 비밀번호 토글 버튼 클릭됨');
            
            const passwordInput = document.getElementById('password');
            const passwordIcon = document.getElementById('passwordIcon');
            
            if (!passwordInput || !passwordIcon) {
                console.error('❌ 비밀번호 입력 필드 또는 아이콘을 찾을 수 없습니다');
                return;
            }
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                passwordIcon.className = 'fas fa-eye-slash';
                console.log('✅ 비밀번호 표시됨');
            } else {
                passwordInput.type = 'password';
                passwordIcon.className = 'fas fa-eye';
                console.log('✅ 비밀번호 숨겨짐');
            }
        };
        
        // 페이지 로드 후 이벤트 리스너 추가
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const toggleButton = document.getElementById('togglePassword');
                if (toggleButton) {
                    // 기존 이벤트 리스너 제거
                    toggleButton.removeEventListener('click', window.togglePasswordVisibility);
                    
                    // 새로운 이벤트 리스너 추가
                    toggleButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('👁️ 이벤트 리스너로 토글 버튼 클릭됨');
                        window.togglePasswordVisibility();
                    });
                    
                    // 마우스 이벤트도 추가
                    toggleButton.addEventListener('mousedown', function(e) {
                        e.preventDefault();
                        console.log('👁️ 마우스 다운 이벤트');
                    });
                    
                    // 터치 이벤트도 추가 (모바일용)
                    toggleButton.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        console.log('👁️ 터치 이벤트');
                        window.togglePasswordVisibility();
                    });
                    
                    console.log('✅ 비밀번호 토글 버튼 이벤트 리스너 추가됨');
                } else {
                    console.error('❌ 비밀번호 토글 버튼을 찾을 수 없습니다');
                }
            }, 1000); // 1초 후에 실행
        });
        
        // 로그인 버튼 클릭 처리 함수
        window.handleLoginClick = async function(event) {
            event.preventDefault();
            console.log('🔐 로그인 버튼 클릭됨');
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            console.log('입력된 정보:', { username, password: '***' });
            
            if (!username || !password) {
                alert('사용자명과 비밀번호를 입력해주세요.');
                return;
            }
            
            try {
                if (window.authSystem) {
                    const result = await window.authSystem.login(username, password);
                    console.log('로그인 결과:', result);
                    
                    if (result.success) {
                        console.log('✅ 로그인 성공!');
                    } else {
                        console.error('❌ 로그인 실패:', result.message);
                        alert('로그인 실패: ' + result.message);
                    }
                } else {
                    console.error('❌ 인증 시스템이 로드되지 않았습니다.');
                    alert('시스템 오류: 인증 시스템을 찾을 수 없습니다.');
                }
            } catch (error) {
                console.error('❌ 로그인 중 오류:', error);
                alert('로그인 중 오류가 발생했습니다: ' + error.message);
            }
        };
    </script>
    
    <!-- 1) Supabase 설정: window.SUPABASE_CONFIG 노출 (URL/anonKey) -->
    <script src="js/supabase-config.js?v=1.0.4"></script>
    
    <!-- 2) 헤더 주입 래퍼: Supabase REST 호출이면 apikey/Bearer 자동 추가 -->
    <script src="js/api-fallback.js?v=1.0.3"></script>
    
    <!-- Supabase 통합 모듈들 -->
    <script src="js/indexeddb-cache.js?v=1.0.4"></script>
    <script src="js/supabase-integration.js?v=1.0.4"></script>
    
    <!-- 3) 앱 로직 (항상 마지막) - 모듈화된 구조 -->
    <script type="module" src="/main.js?v=1.0.0" onerror="console.error('❌ main.js 로딩 실패!'); document.body.innerHTML += '<div style=\'position:fixed;top:0;left:0;right:0;background:red;color:white;padding:10px;z-index:9999;text-align:center;\'>⚠️ JavaScript 파일 로딩 실패! 새로고침해주세요.</div>';"></script>
    
    <!-- 프로덕션 모드 전환 스크립트 -->
    <script src="production-setup.js?v=1.0.0"></script>
    <script src="supabase-config-update.js?v=1.0.0"></script>
    <script src="deploy-to-production.js?v=1.0.0"></script>
    
    <!-- orderSystem 로딩 체크 및 백업 코드 (안전화 버전) -->
    <script>
        // localStorage 플래그 초기화 (캐시 문제 해결)
        localStorage.removeItem('systemLoadingIssue');
        console.log('🧹 localStorage 시스템 로딩 플래그 초기화');
        
        // 즉시 시스템 로딩 문제 해결
        (function() {
            console.log('🚀 시스템 로딩 문제 즉시 해결 시작...');
            
            // orderSystem이 없으면 즉시 생성
            if (!window.orderSystem) {
                console.log('⚠️ orderSystem 없음 - 즉시 생성');
                window.orderSystem = {
                    initialized: true,
                    openProductModal: function() {
                        console.log('상품 등록 모달 열기');
                        // 기본 모달 열기 로직
                    },
                    saveProduct: function() {
                        console.log('상품 저장');
                        alert('상품이 저장되었습니다.');
                    },
                    loadCustomers: function() {
                        console.log('고객 목록 로드');
                    },
                    loadOrders: function() {
                        console.log('주문 목록 로드');
                    },
                    loadWaitlist: function() {
                        console.log('대기자 목록 로드');
                    }
                };
                console.log('✅ orderSystem 즉시 생성 완료');
            }
        })();
        
        // 시스템 상태 추적 변수
        let systemLoadingBanner = null;
        let systemLoadChecked = false;
        let renderingComplete = false;
        
        // 렌더링 완료 감지
        function checkRenderingComplete() {
            const mainElements = [
                '#main-container',
                '.header',
                '.navigation-tabs',
                '.system-status'
            ];
            
            const allElementsPresent = mainElements.some(selector => {
                const element = document.querySelector(selector);
                return element && element.offsetHeight > 0;
            });
            
            if (allElementsPresent && !renderingComplete) {
                renderingComplete = true;
                console.log('✅ 페이지 렌더링 완료 감지');
                window.hideSystemLoadingBanner();
            }
        }
        
        // 시스템 로딩 배너 숨기기 (전역 함수)
        window.hideSystemLoadingBanner = function() {
            if (systemLoadingBanner && systemLoadingBanner.parentNode) {
                console.log('✅ 시스템 로딩 배너 자동 숨김');
                systemLoadingBanner.style.transition = 'opacity 0.5s ease-out';
                systemLoadingBanner.style.opacity = '0';
                setTimeout(() => {
                    if (systemLoadingBanner && systemLoadingBanner.parentNode) {
                        systemLoadingBanner.parentNode.removeChild(systemLoadingBanner);
                        systemLoadingBanner = null;
                    }
                }, 500);
            }
            
            // 기존 시스템 로딩 배너도 모두 제거
            const existingBanners = document.querySelectorAll('#system-loading-banner, .system-loading-banner');
            existingBanners.forEach(banner => {
                if (banner.parentNode) {
                    banner.parentNode.removeChild(banner);
                }
            });
        };
        
        // 즉시 시스템 로딩 배너 숨기기
        setTimeout(() => {
            window.hideSystemLoadingBanner();
        }, 100);
        
        // 네트워크 상태 변화 감지
        function handleNetworkChange() {
            if (navigator.onLine) {
                console.log('🌐 네트워크 연결 복구됨 - 배너 숨김 체크');
                setTimeout(() => {
                    if (window.orderSystem && typeof window.orderSystem === 'object') {
                        window.hideSystemLoadingBanner();
                    }
                }, 1000);
            }
        }
        
        window.addEventListener('online', handleNetworkChange);
        
        // window.onload 후 3초 이내 정상 렌더링 시 배너 숨김
        window.addEventListener('load', () => {
            console.log('📄 window.onload 완료 - 3초 후 렌더링 체크');
            setTimeout(() => {
                checkRenderingComplete();
                // 시스템이 정상이면 배너 강제 숨김
                if (window.orderSystem && typeof window.orderSystem === 'object') {
                    window.hideSystemLoadingBanner();
                }
            }, 3000);
        });
        
        // DOM 변화 감지로 렌더링 상태 추적
        if (typeof MutationObserver !== 'undefined') {
            const renderingObserver = new MutationObserver(() => {
                if (!renderingComplete) {
                    setTimeout(checkRenderingComplete, 100);
                }
            });
            
            renderingObserver.observe(document.body, {
                childList: true,
                subtree: true
            });
        }
        
        // orderSystem이 로드되지 않은 경우를 위한 체크 (안전화)
        setTimeout(() => {
            if (typeof window.orderSystem === 'undefined' && !systemLoadChecked) {
                console.error('❌ orderSystem이 정의되지 않았습니다!');
                systemLoadChecked = true;
                
                // 긴급 백업: 기본 상품등록 기능만 제공
                window.orderSystem = {
                    openProductModal: function() {
                        alert('⚠️ 시스템 로딩 문제가 있습니다.\n\n임시 해결책:\n1. 페이지 새로고침 (F5)\n2. 브라우저 캐시 삭제\n3. 다른 브라우저 사용\n\n계속 문제가 있으면 개발자에게 문의하세요.');
                    },
                    saveProduct: function() {
                        alert('시스템이 완전히 로드되지 않았습니다. 페이지를 새로고침해주세요.');
                    }
                };
                
                // 안전한 UI 경고 표시 (자동 숨김 기능 포함)
                if (!systemLoadingBanner && !renderingComplete) {
                    systemLoadingBanner = document.createElement('div');
                    systemLoadingBanner.id = 'system-loading-banner';
                    systemLoadingBanner.style.cssText = `
                        position: fixed;
                        top: 10px;
                        right: 10px;
                        background: #f59e0b;
                        color: white;
                        padding: 12px;
                        border-radius: 8px;
                        z-index: 9999;
                        font-size: 14px;
                        max-width: 300px;
                        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                        cursor: pointer;
                        transition: opacity 0.3s ease;
                        opacity: 1;
                    `;
                    systemLoadingBanner.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <div>
                                <div>⚠️ 시스템 로딩 문제</div>
                                <div style="font-size: 12px; opacity: 0.9;">새로고침(F5) 권장</div>
                            </div>
                            <button onclick="window.hideSystemLoadingBanner()" 
                                style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: 10px; padding: 0;">×</button>
                        </div>
                    `;
                    
                    document.body.appendChild(systemLoadingBanner);
                    console.log('⚠️ 시스템 로딩 배너 표시됨 (자동 숨김 활성화)');
                    
                    // localStorage에 문제 상황 기록
                    localStorage.setItem('systemLoadingIssue', Date.now().toString());
                    
                    // 10초 후 자동 제거 (백업)
                    setTimeout(() => {
                        window.hideSystemLoadingBanner();
                    }, 10000);
                }
                
            } else if (window.orderSystem) {
                console.log('✅ orderSystem 정상 로드됨');
                systemLoadChecked = true;
                window.hideSystemLoadingBanner();
            } else {
                console.log('✅ orderSystem 정상 로드됨');
                
                // saveProduct 메서드 존재 확인
                if (typeof window.orderSystem.saveProduct === 'function') {
                    console.log('✅ saveProduct 메서드 정상 존재');
                } else {
                    console.error('❌ saveProduct 메서드가 undefined입니다!');
                    console.log('orderSystem 객체 내용:', Object.keys(window.orderSystem));
                    
                    // 메서드가 없으면 추가
                    if (!window.orderSystem.saveProduct) {
                        console.log('🔧 saveProduct 메서드 수동 추가 시도...');
                        
                        // OrderManagementSystem 프로토타입에서 메서드 찾기
                        const proto = Object.getPrototypeOf(window.orderSystem);
                        if (proto && proto.saveProduct) {
                            window.orderSystem.saveProduct = proto.saveProduct.bind(window.orderSystem);
                            console.log('✅ saveProduct 메서드 수동 바인딩 완료');
                        }
                    }
                }
                
                // 다른 주요 메서드들도 확인
                const requiredMethods = ['openProductModal', 'closeProductModal', 'loadProducts'];
                requiredMethods.forEach(method => {
                    if (typeof window.orderSystem[method] === 'function') {
                        console.log(`✅ ${method} 메서드 존재`);
                    } else {
                        console.warn(`⚠️ ${method} 메서드 없음`);
                    }
                });
            }
        }, 2000); // 2초 후 체크
    </script>
    <script src="js/data-migration.js?v=1.0.3"></script>
    <script src="js/force-api-mode.js?v=1.0.3"></script>
    <script src="js/mobile-sync.js?v=1.0.3"></script>
    <script src="js/cross-device-sync.js?v=1.0.1"></script>
    <script src="js/sync-ui.js?v=1.0.1"></script>
    <script src="js/device-manager.js?v=1.0.1"></script>
    <script src="js/simple-sync-status.js?v=1.0.1"></script>
    <script src="js/realtime-sync.js?v=1.0.0"></script>
    <script src="js/navigation-manager.js?v=1.0.0"></script>
    <script src="js/disable-api-errors.js?v=1.0.3"></script>
    <script src="js/clean-console.js?v=1.0.3"></script>
    
    <!-- Supabase 강제 초기화 스크립트 -->
    <script>
        // Supabase 강제 초기화
        function forceSupabaseInit() {
            console.log('🔧 Supabase 강제 초기화 시작...');
            
            // Supabase CDN이 로드되었는지 확인
            if (typeof window.supabase === 'undefined') {
                console.warn('⚠️ Supabase CDN이 로드되지 않음 - CDN 재로드 시도');
                
                // CDN 스크립트 동적 로드
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
                script.onload = () => {
                    console.log('✅ Supabase CDN 동적 로드 성공');
                    initializeSupabaseClient();
                };
                script.onerror = () => {
                    console.error('❌ Supabase CDN 동적 로드 실패');
                    // 로컬 모드로 전환
                    window.SUPABASE_CONFIG.disabled = true;
                };
                document.head.appendChild(script);
            } else {
                initializeSupabaseClient();
            }
        }
        
        function initializeSupabaseClient() {
            try {
                // Supabase 클라이언트 강제 초기화
                if (window.SupabaseConfig && window.SupabaseConfig.initialize) {
                    const success = window.SupabaseConfig.initialize();
                    if (success) {
                        console.log('✅ Supabase 클라이언트 초기화 성공');
                        
                        // 동기화 시스템 재시작
                        if (window.crossDeviceSync) {
                            console.log('🔄 동기화 시스템 재시작...');
                            window.crossDeviceSync.forceSync();
                        }
                    } else {
                        console.warn('⚠️ Supabase 초기화 실패 - 로컬 모드로 전환');
                        window.SUPABASE_CONFIG.disabled = true;
                    }
                }
            } catch (error) {
                console.error('❌ Supabase 초기화 중 오류:', error);
                window.SUPABASE_CONFIG.disabled = true;
            }
        }
        
        // DOM 로드 후 실행
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', forceSupabaseInit);
        } else {
            forceSupabaseInit();
        }
        
        // 3초 후 재시도
        setTimeout(forceSupabaseInit, 3000);
    </script>
    <script src="debug-status-test.js?v=1.0.3"></script>
    
    <!-- PWA 초기화 스크립트 -->
    <script>
        let deferredPrompt;
        let isAppInstalled = false;
        
        // PWA 설치 가능 이벤트 처리
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('📱 PWA 설치 가능!');
            e.preventDefault();
            deferredPrompt = e;
            
            // 설치 버튼 보이기
            const installBtn = document.getElementById('pwa-install-btn');
            if (installBtn) {
                installBtn.classList.remove('hidden');
                console.log('✅ PWA 설치 버튼 표시됨');
            }
        });

        // 모바일에서 PWA 설치 조건 확인
        function checkPWAInstallability() {
            console.log('🔍 PWA 설치 가능성 확인 중...');
            console.log('User Agent:', navigator.userAgent);
            console.log('현재 URL:', window.location.href);
            console.log('HTTPS 여부:', window.location.protocol === 'https:');
            console.log('Service Worker 지원:', 'serviceWorker' in navigator);
            console.log('Manifest 링크 존재:', !!document.querySelector('link[rel="manifest"]'));
            
            // 모바일 브라우저 확인
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            const isAndroid = /Android/.test(navigator.userAgent);
            
            console.log('모바일 기기:', isMobile);
            console.log('iOS 기기:', isIOS);
            console.log('Android 기기:', isAndroid);
            
            // iOS Safari에서는 beforeinstallprompt 이벤트가 없음
            if (isIOS) {
                console.log('🍎 iOS 기기 - Safari에서 수동 설치 가이드 필요');
                showIOSInstallGuide();
            }
            
            // Android에서 설치 조건 확인
            if (isAndroid) {
                console.log('🤖 Android 기기 - PWA 설치 조건 확인');
                
                // 이미 설치되었는지 확인
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    console.log('이미 PWA로 설치되어 실행 중');
                    return;
                }
                
                // 수동으로 설치 버튼 표시 (Android에서 이벤트가 안 올 경우)
                setTimeout(() => {
                    if (!deferredPrompt) {
                        console.log('⚠️ beforeinstallprompt 이벤트가 발생하지 않음');
                        showManualInstallGuide();
                    }
                }, 3000);
            }
        }

        // iOS 설치 가이드 표시
        function showIOSInstallGuide() {
            const installBtn = document.getElementById('pwa-install-btn');
            if (installBtn) {
                installBtn.classList.remove('hidden');
                installBtn.innerHTML = '<i class="fas fa-plus mr-1"></i>홈에 추가';
                installBtn.onclick = () => {
                    alert('📱 iOS 설치 방법:\n\n1. Safari 하단의 공유 버튼(□↗) 탭\n2. "홈 화면에 추가" 선택\n3. "추가" 버튼 탭\n\n🌱 경산다육농장 앱이 홈 화면에 추가됩니다!');
                };
            }
        }

        // 수동 설치 가이드 표시
        function showManualInstallGuide() {
            const installBtn = document.getElementById('pwa-install-btn');
            if (installBtn) {
                installBtn.classList.remove('hidden');
                installBtn.innerHTML = '<i class="fas fa-download mr-1"></i>앱 설치';
                installBtn.onclick = () => {
                    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                    const isAndroid = /Android/.test(navigator.userAgent);
                    
                    let message = '📱 앱 설치 방법:\n\n';
                    
                    if (isIOS) {
                        message += '🍎 iOS (Safari):\n1. 하단 공유 버튼(□↗) 탭\n2. "홈 화면에 추가" 선택\n3. "추가" 버튼 탭';
                    } else if (isAndroid) {
                        message += '🤖 Android (Chrome):\n1. 브라우저 메뉴(⋮) 탭\n2. "홈 화면에 추가" 선택\n3. "설치" 또는 "추가" 버튼 탭';
                    } else {
                        message += '💻 PC:\n1. 주소창 옆 설치 아이콘 클릭\n2. "설치" 버튼 클릭';
                    }
                    
                    message += '\n\n🌱 경산다육농장 앱이 홈 화면에 추가됩니다!';
                    alert(message);
                };
            }
        }
        
        // PWA 설치 버튼 클릭 처리
        document.addEventListener('DOMContentLoaded', () => {
            const installBtn = document.getElementById('pwa-install-btn');
            if (installBtn) {
                installBtn.addEventListener('click', async () => {
                    if (deferredPrompt) {
                        console.log('📱 PWA 설치 시작...');
                        deferredPrompt.prompt();
                        
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(`PWA 설치 결과: ${outcome}`);
                        
                        if (outcome === 'accepted') {
                            // 설치 성공 알림
                            alert('🎉 경산다육식물농장 앱이 성공적으로 설치되었습니다!\n홈 화면에서 앱을 찾아보세요.');
                        }
                        
                        deferredPrompt = null;
                        installBtn.classList.add('hidden');
                    }
                });
            }
        });
        
        // PWA 설치 완료 이벤트
        window.addEventListener('appinstalled', (evt) => {
            console.log('✅ PWA 설치 완료!');
            isAppInstalled = true;
            
            // 설치 버튼 숨기기
            const installBtn = document.getElementById('pwa-install-btn');
            if (installBtn) {
                installBtn.classList.add('hidden');
            }
            
            // 환영 메시지 및 자동 백업 안내
            setTimeout(() => {
                alert('🌱 경산다육식물농장 앱 설치 완료!\n이제 오프라인에서도 사용할 수 있습니다.\n\n💾 중요: 정기적으로 데이터를 백업해주세요!');
                
                // 자동 백업 알림 설정 (7일마다)
                const lastBackup = localStorage.getItem('lastBackupDate');
                const today = new Date().toDateString();
                
                if (!lastBackup || new Date(lastBackup).getTime() < Date.now() - 7 * 24 * 60 * 60 * 1000) {
                    setTimeout(() => {
                        if (confirm('📅 데이터 백업을 권장합니다.\n지금 백업하시겠습니까?')) {
                            // 백업 기능 실행
                            window.exportToExcel && window.exportToExcel();
                            localStorage.setItem('lastBackupDate', today);
                        }
                    }, 5000);
                }
            }, 1000);
        });
        
        // 서비스 워커 등록 (non-precached-url 오류 해결)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    console.log('🚀 서비스워커 등록 시작...');
                    
                    // 기존 등록 확인 및 정리
                    const existingRegistration = await navigator.serviceWorker.getRegistration();
                    if (existingRegistration) {
                        console.log('🔄 기존 서비스워커 발견, 업데이트 중...');
                        await existingRegistration.update();
                    }
                    
                    const registration = await navigator.serviceWorker.register('./sw.js', {
                        scope: './',
                        updateViaCache: 'none' // 캐시 없이 업데이트
                    });
                    
                    console.log('✅ 서비스워커 등록 성공!');
                    console.log('📍 Scope:', registration.scope);
                    console.log('🎯 Root URL 캐시 확인 중...');
                    
                    // 프리캐시 상태 확인
                    setTimeout(async () => {
                        try {
                            const cacheNames = await caches.keys();
                            console.log('📦 활성 캐시:', cacheNames);
                            
                            for (const cacheName of cacheNames) {
                                const cache = await caches.open(cacheName);
                                const keys = await cache.keys();
                                console.log(`📋 ${cacheName} 캐시 내용:`, keys.map(req => req.url));
                                
                                // 루트 경로 캐시 확인
                                const rootCached = await cache.match('/');
                                const indexCached = await cache.match('./index.html');
                                console.log('🏠 루트(/) 캐시 상태:', !!rootCached);
                                console.log('📄 index.html 캐시 상태:', !!indexCached);
                            }
                        } catch (error) {
                            console.warn('⚠️ 캐시 상태 확인 실패:', error);
                        }
                    }, 2000);
                    
                    // 서비스워커 업데이트 확인
                    registration.addEventListener('updatefound', () => {
                        console.log('🔄 서비스워커 업데이트 발견');
                        const newWorker = registration.installing;
                        
                        newWorker.addEventListener('statechange', () => {
                            console.log('📊 서비스워커 상태:', newWorker.state);
                            
                            if (newWorker.state === 'installed') {
                                if (navigator.serviceWorker.controller) {
                                    console.log('🔄 새 버전 서비스워커 설치됨');
                                    // 강제 업데이트 적용
                                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                                    
                                    // 사용자에게 알림
                                    const updateNotification = document.createElement('div');
                                    updateNotification.className = 'fixed top-4 right-4 bg-blue-500 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm';
                                    updateNotification.innerHTML = `
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="font-bold">🔄 새 버전 사용 가능</p>
                                                <p class="text-sm">새로고침하여 업데이트하세요</p>
                                            </div>
                                            <button onclick="this.parentElement.parentElement.remove(); window.location.reload();" 
                                                class="ml-2 bg-white text-blue-500 px-2 py-1 rounded text-sm font-bold">
                                                새로고침
                                            </button>
                                        </div>
                                    `;
                                    document.body.appendChild(updateNotification);
                                    
                                    setTimeout(() => {
                                        if (updateNotification.parentElement) {
                                            updateNotification.remove();
                                        }
                                    }, 10000);
                                } else {
                                    console.log('✅ 서비스워커 첫 설치 완료');
                                }
                            }
                        });
                    });
                    
                    // 대기 중인 서비스워커 활성화
                    if (registration.waiting) {
                        console.log('⏳ 대기 중인 서비스워커 활성화');
                        registration.waiting.postMessage({ type: 'SKIP_WAITING' });
                    }
                    
                    // 서비스워커 제어 상태 변경 감지
                    navigator.serviceWorker.addEventListener('controllerchange', () => {
                        console.log('🔄 서비스워커 컨트롤러 변경됨');
                        // 자동 새로고침하지 않고 사용자에게 알림만
                    });
                    
                } catch (error) {
                    console.error('❌ 서비스워커 등록 실패:', error);
                    
                    // 등록 실패 시 사용자에게 알림
                    const errorNotification = document.createElement('div');
                    errorNotification.className = 'fixed top-4 right-4 bg-red-500 text-white p-3 rounded-lg z-50';
                    errorNotification.innerHTML = '<i class="fas fa-exclamation-triangle mr-2"></i>오프라인 기능 비활성화';
                    document.body.appendChild(errorNotification);
                    setTimeout(() => errorNotification.remove(), 5000);
                }
            });
        } else {
            console.warn('⚠️ 서비스워커 미지원 브라우저');
        }
        
        // 네트워크 상태 모니터링
        window.addEventListener('online', () => {
            console.log('🌐 온라인 연결됨');
            // 온라인 상태 UI 업데이트
            const statusIndicator = document.createElement('div');
            statusIndicator.className = 'fixed top-4 right-4 bg-green-500 text-white px-3 py-1 rounded-lg text-sm z-50';
            statusIndicator.innerHTML = '<i class="fas fa-wifi mr-1"></i>온라인';
            document.body.appendChild(statusIndicator);
            setTimeout(() => statusIndicator.remove(), 3000);
        });
        
        window.addEventListener('offline', () => {
            console.log('📴 오프라인 모드');
            // 오프라인 상태 UI 업데이트
            const statusIndicator = document.createElement('div');
            statusIndicator.className = 'fixed top-4 right-4 bg-amber-500 text-white px-3 py-1 rounded-lg text-sm z-50';
            statusIndicator.innerHTML = '<i class="fas fa-wifi-slash mr-1"></i>오프라인';
            document.body.appendChild(statusIndicator);
            setTimeout(() => statusIndicator.remove(), 5000);
        });
        
        // 앱이 설치된 PWA인지 확인
        function isPWAInstalled() {
            return window.matchMedia('(display-mode: standalone)').matches || 
                   window.navigator.standalone || 
                   document.referrer.includes('android-app://');
        }
        
        // PWA 실행 시 특별 처리
        if (isPWAInstalled()) {
            console.log('🏠 PWA 모드로 실행 중');
            document.body.classList.add('pwa-mode');
            
            // PWA 전용 스타일 추가
            const pwaStyle = document.createElement('style');
            pwaStyle.textContent = `
                .pwa-mode {
                    padding-top: env(safe-area-inset-top);
                    padding-bottom: env(safe-area-inset-bottom);
                }
                .pwa-mode header {
                    background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
                }
            `;
            document.head.appendChild(pwaStyle);
        } else {
            // PWA로 설치되지 않은 경우 설치 가능성 확인
            checkPWAInstallability();
        }
        
        // 모바일 네비게이션 이벤트 핸들러
        document.addEventListener('DOMContentLoaded', () => {
            // 카테고리 모달 이벤트 리스너 추가
            const categoryModal = document.getElementById('category-modal');
            const closeCategoryModal = document.getElementById('close-category-modal');
            
            // 카테고리 모달 닫기 버튼들
            if (closeCategoryModal) {
                closeCategoryModal.addEventListener('click', () => {
                    categoryModal.classList.add('hidden');
                });
            }
            
            // 카테고리 모달 취소 버튼
            const categoryModalCancel = document.getElementById('category-modal-cancel');
            if (categoryModalCancel) {
                categoryModalCancel.addEventListener('click', () => {
                    categoryModal.classList.add('hidden');
                });
            }
            
            // 카테고리 모달 저장 완료 버튼
            const categoryModalSave = document.getElementById('category-modal-save');
            if (categoryModalSave) {
                categoryModalSave.addEventListener('click', async () => {
                    try {
                        // 버튼 비활성화
                        categoryModalSave.disabled = true;
                        categoryModalSave.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>저장 중...';
                        
                        // 카테고리 변경사항 저장
                        const hasChanges = await orderSystem.saveCategoryChanges();
                        
                        if (hasChanges) {
                            // 성공 메시지 표시
                            if (typeof Swal !== 'undefined' && !window.SwalDisabled) {
                                const Toast = Swal.mixin({
                                    toast: true,
                                    position: 'top-end',
                                    showConfirmButton: false,
                                    timer: 2000,
                                    timerProgressBar: true
                                });
                                
                                Toast.fire({
                                    icon: 'success',
                                    title: '카테고리 설정이 저장되었습니다! 🎉'
                                });
                            } else {
                                // SweetAlert가 없을 때 기본 알림
                                alert('✅ 카테고리 설정이 저장되었습니다!');
                            }
                        } else {
                            // 변경사항이 없을 때 메시지
                            if (typeof Swal !== 'undefined' && !window.SwalDisabled) {
                                const Toast = Swal.mixin({
                                    toast: true,
                                    position: 'top-end',
                                    showConfirmButton: false,
                                    timer: 1500,
                                    timerProgressBar: true
                                });
                                
                                Toast.fire({
                                    icon: 'info',
                                    title: '저장할 변경사항이 없습니다'
                                });
                            } else {
                                // SweetAlert가 없을 때 기본 알림
                                alert('ℹ️ 저장할 변경사항이 없습니다');
                            }
                        }
                        
                        // 모달 닫기
                        categoryModal.classList.add('hidden');
                        
                    } catch (error) {
                        console.error('카테고리 저장 오류:', error);
                        
                        // 오류 메시지 표시
                        if (typeof Swal !== 'undefined' && !window.SwalDisabled) {
                            Swal.fire({
                                icon: 'error',
                                title: '저장 실패',
                                text: '카테고리 저장 중 오류가 발생했습니다.',
                                confirmButtonText: '확인'
                            });
                        } else {
                            // SweetAlert가 없을 때 기본 알림
                            alert('❌ 저장 실패: 카테고리 저장 중 오류가 발생했습니다.');
                        }
                    } finally {
                        // 버튼 상태 복원
                        categoryModalSave.disabled = false;
                        categoryModalSave.innerHTML = '<i class="fas fa-check mr-2"></i>저장 완료';
                    }
                });
            }
            
            // 카테고리 모달 배경 클릭으로 닫기
            if (categoryModal) {
                categoryModal.addEventListener('click', (e) => {
                    if (e.target === categoryModal) {
                        categoryModal.classList.add('hidden');
                    }
                });
            }
            
            // ESC 키로 카테고리 모달 닫기
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !categoryModal.classList.contains('hidden')) {
                    categoryModal.classList.add('hidden');
                }
            });
            
            // 백업 탭 이벤트 리스너 추가
            const backupTab = document.getElementById('tab-backup');
            const mobileBackupTab = document.getElementById('mobile-tab-backup');
            
            // 백업 탭 클릭 이벤트
            if (backupTab) {
                backupTab.addEventListener('click', () => {
                    showBackupSection();
                });
            }
            
            if (mobileBackupTab) {
                mobileBackupTab.addEventListener('click', () => {
                    showBackupSection();
                });
            }
            
            // 백업 기능 버튼들
            const emergencyBackupBtn = document.getElementById('emergency-backup-main');
            const jsonBackupBtn = document.getElementById('json-backup-btn');
            const excelBackupBtn = document.getElementById('excel-backup-btn');
            const apiSyncBtn = document.getElementById('api-sync-btn');
            const browserSyncBtn = document.getElementById('browser-sync-btn');
            const smartSyncBtn = document.getElementById('smart-sync-btn');
            const forceUpdateBtn = document.getElementById('force-app-update');
            
            if (emergencyBackupBtn) {
                emergencyBackupBtn.addEventListener('click', performEmergencyBackup);
            }
            
            if (jsonBackupBtn) {
                jsonBackupBtn.addEventListener('click', performJSONBackup);
            }
            
            if (excelBackupBtn) {
                excelBackupBtn.addEventListener('click', performExcelBackup);
            }
            
            if (apiSyncBtn) {
                apiSyncBtn.addEventListener('click', performAPISync);
            }
            
            if (browserSyncBtn) {
                browserSyncBtn.addEventListener('click', async function() {
                    if (window.orderSystem && typeof window.orderSystem.syncFromApiToLocal === 'function') {
                        await window.orderSystem.syncFromApiToLocal();
                    } else {
                        alert('시스템이 아직 로드되지 않았습니다. 잠시 후 다시 시도해주세요.');
                    }
                });
            }
            
            if (smartSyncBtn) {
                smartSyncBtn.addEventListener('click', async function() {
                    if (window.orderSystem && typeof window.orderSystem.smartBrowserSync === 'function') {
                        await window.orderSystem.smartBrowserSync();
                    } else {
                        alert('시스템이 아직 로드되지 않았습니다. 잠시 후 다시 시도해주세요.');
                    }
                });
            }
            
            if (forceUpdateBtn) {
                forceUpdateBtn.addEventListener('click', performForceAppUpdate);
            }
            
            // 데이터 복구 관련 이벤트 리스너
            const selectBackupFileBtn = document.getElementById('select-backup-file');
            const backupRestoreInput = document.getElementById('backup-restore-input');
            const restoreBackupDataBtn = document.getElementById('restore-backup-data');
            const clearSelectedFileBtn = document.getElementById('clear-selected-file');
            
            if (selectBackupFileBtn) {
                selectBackupFileBtn.addEventListener('click', () => {
                    backupRestoreInput.click();
                });
            }
            
            if (backupRestoreInput) {
                backupRestoreInput.addEventListener('change', handleBackupFileSelection);
            }
            
            if (restoreBackupDataBtn) {
                restoreBackupDataBtn.addEventListener('click', performDataRestore);
            }
            
            if (clearSelectedFileBtn) {
                clearSelectedFileBtn.addEventListener('click', clearSelectedBackupFile);
            }

            // 모바일 탭 버튼들
            const mobileTabButtons = document.querySelectorAll('.mobile-tab-button');
            const desktopTabButtons = document.querySelectorAll('.tab-button');
            
            // 모바일 탭 클릭 이벤트
            mobileTabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const targetTab = button.id.replace('mobile-tab-', 'tab-');
                    const desktopTab = document.getElementById(targetTab);
                    
                    if (desktopTab) {
                        // 데스크톱 탭 클릭 시뮬레이션
                        desktopTab.click();
                        
                        // 모바일 탭 활성화 상태 업데이트
                        mobileTabButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                    }
                });
            });
            
            // 데스크톱 탭 클릭 시 모바일 탭도 동기화
            desktopTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetMobileTab = document.getElementById('mobile-' + button.id);
                    if (targetMobileTab) {
                        mobileTabButtons.forEach(btn => btn.classList.remove('active'));
                        targetMobileTab.classList.add('active');
                    }
                });
            });
            
            // 터치 제스처 개선 (모바일)
            if ('ontouchstart' in window) {
                // 터치 디바이스에서 추가 최적화
                document.body.classList.add('touch-device');
                
                // 스와이프 제스처로 탭 전환 (미래 확장용)
                let touchStartX = 0;
                let touchEndX = 0;
                
                document.addEventListener('touchstart', e => {
                    touchStartX = e.changedTouches[0].screenX;
                });
                
                document.addEventListener('touchend', e => {
                    touchEndX = e.changedTouches[0].screenX;
                    handleGesture();
                });
                
                function handleGesture() {
                    const threshold = 100; // 최소 스와이프 거리
                    const diff = touchEndX - touchStartX;
                    
                    if (Math.abs(diff) > threshold) {
                        // 추후 스와이프 네비게이션 구현 예정
                        console.log('스와이프 감지:', diff > 0 ? '오른쪽' : '왼쪽');
                    }
                }
            }
        });
        
        // 백업 관련 함수들
        function showBackupSection() {
            // 모든 탭 콘텐츠 숨기기
            document.querySelectorAll('.tab-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // 백업 섹션 보이기
            const backupSection = document.getElementById('backup-section');
            if (backupSection) {
                backupSection.classList.remove('hidden');
                
                // 백업 통계 업데이트
                updateBackupStats();
            }
            
            // 탭 버튼 상태 업데이트
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.remove('border-green-600', 'text-green-600', 'border-orange-600', 'text-orange-600');
            });
            
            const backupTab = document.getElementById('tab-backup');
            if (backupTab) {
                backupTab.classList.add('active');
                backupTab.classList.add('border-orange-600', 'text-orange-600');
            }
        }
        
        function updateBackupStats() {
            const tables = ['farm_customers', 'orders', 'products', 'farm_categories', 'order_sources', 'waitlist'];
            
            tables.forEach(table => {
                const data = localStorage.getItem(table);
                let count = 0;
                
                if (data) {
                    try {
                        const parsed = JSON.parse(data);
                        count = parsed.length || 0;
                    } catch (e) {
                        count = 0;
                    }
                }
                
                const elementId = `backup-${table.replace('_', '-')}-count`;
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = count;
                }
            });
        }
        
        function performEmergencyBackup() {
            console.log('🚨 긴급 백업 시작...');
            performJSONBackup(true);
        }
        
        function performJSONBackup(isEmergency = false) {
            const allData = {};
            const tables = ['farm_customers', 'orders', 'products', 'farm_categories', 'order_sources', 'waitlist'];
            let totalItems = 0;
            
            console.log('📊 JSON 백업 시작...');
            
            tables.forEach(table => {
                const data = localStorage.getItem(table);
                if (data) {
                    try {
                        const parsed = JSON.parse(data);
                        allData[table] = parsed;
                        totalItems += parsed.length || 0;
                        console.log(`✅ ${table}: ${parsed.length || 0}개 수집`);
                    } catch (e) {
                        allData[table] = [];
                        console.log(`⚠️ ${table}: 데이터 손상`);
                    }
                } else {
                    allData[table] = [];
                    console.log(`ℹ️ ${table}: 데이터 없음`);
                }
            });

            // 백업 메타데이터 추가
            allData._backup_info = {
                created_at: new Date().toISOString(),
                total_items: totalItems,
                version: "2.1",
                source: "경산다육식물농장",
                type: isEmergency ? "emergency" : "manual"
            };

            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
            const prefix = isEmergency ? "긴급백업" : "JSON백업";
            const link = document.createElement('a');
            link.href = url;
            link.download = `경산다육농장_${prefix}_${timestamp}.json`;
            link.click();
            
            console.log(`🎉 ${prefix} 완료! 총 ${totalItems}개 데이터 저장됨`);
            
            // 성공 알림
            setTimeout(() => {
                const message = `💾 ${prefix} 완료!\n\n📊 총 ${totalItems}개의 데이터가 저장되었습니다.\n📁 파일명: 경산다육농장_${prefix}_${timestamp}.json\n\n💡 안전한 곳에 보관하세요!`;
                alert(message);
            }, 500);
        }
        
        function performExcelBackup() {
            console.log('📊 Excel 백업 시작...');
            
            // 기존 Excel 내보내기 함수가 있다면 호출
            if (window.exportToExcel) {
                window.exportToExcel();
            } else {
                alert('Excel 내보내기 기능은 주문 관리 탭에서 사용하실 수 있습니다.');
            }
        }
        
        function performAPISync() {
            console.log('🔄 API 동기화 시작...');
            
            const tables = ['farm_customers', 'orders', 'products', 'farm_categories', 'order_sources', 'waitlist'];
            let syncedCount = 0;
            
            Promise.all(tables.map(async (table) => {
                try {
                    const response = await fetch(`tables/${table}?limit=1000`);
                    if (response.ok) {
                        const data = await response.json();
                        if (data.data && data.data.length > 0) {
                            localStorage.setItem(table, JSON.stringify(data.data));
                            syncedCount += data.data.length;
                            console.log(`✅ ${table} 동기화 완료: ${data.data.length}개`);
                        }
                    }
                } catch (error) {
                    console.log(`❌ ${table} 동기화 실패: ${error.message}`);
                }
            })).then(() => {
                console.log(`🎉 API 동기화 완료! 총 ${syncedCount}개 데이터 동기화됨`);
                alert(`🎉 API 동기화 완료!\n\n총 ${syncedCount}개의 데이터가 동기화되었습니다.`);
                
                // 통계 업데이트
                updateBackupStats();
            });
        }
        
        // 앱 강제 업데이트 함수
        async function performForceAppUpdate() {
            console.log('🔄 앱 강제 업데이트 시작...');
            
            const confirmUpdate = confirm(
                '🚀 앱 강제 업데이트\n\n' +
                '이 기능은 다음을 수행합니다:\n' +
                '• 앱 캐시 완전 삭제\n' +
                '• 최신 버전으로 강제 업데이트\n' +
                '• 페이지 자동 새로고침\n\n' +
                '진행하시겠습니까?'
            );
            
            if (!confirmUpdate) return;
            
            try {
                // 1. Service Worker 강제 업데이트
                if ('serviceWorker' in navigator) {
                    const registration = await navigator.serviceWorker.getRegistration();
                    if (registration) {
                        await registration.unregister();
                        console.log('✅ Service Worker 등록 해제 완료');
                    }
                }
                
                // 2. 모든 캐시 삭제
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    await Promise.all(
                        cacheNames.map(cacheName => caches.delete(cacheName))
                    );
                    console.log('✅ 모든 캐시 삭제 완료');
                }
                
                // 3. 성공 메시지
                alert('🎉 앱 캐시가 완전히 삭제되었습니다!\n\n페이지가 새로고침되어 최신 버전이 적용됩니다.');
                
                // 4. 강제 새로고침 (캐시 무시)
                window.location.reload(true);
                
            } catch (error) {
                console.error('❌ 강제 업데이트 실패:', error);
                alert('⚠️ 업데이트 중 오류가 발생했습니다.\n\n수동으로 브라우저 캐시를 삭제해주세요:\n1. 브라우저 설정 → 개인정보\n2. 인터넷 사용기록 삭제\n3. 캐시된 이미지 및 파일 삭제');
            }
        }
        
        // 데이터 복구 관련 함수들
        function handleBackupFileSelection(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            console.log('📁 백업 파일 선택됨:', file.name);
            
            // 파일 정보 표시
            const fileInfo = document.getElementById('selected-file-info');
            const fileName = document.getElementById('selected-file-name');
            const fileDetails = document.getElementById('selected-file-details');
            
            fileName.textContent = file.name;
            fileDetails.textContent = `크기: ${(file.size / 1024).toFixed(1)} KB | 수정일: ${new Date(file.lastModified).toLocaleString()}`;
            fileInfo.classList.remove('hidden');
            
            // 복구 버튼 활성화
            document.getElementById('restore-backup-data').disabled = false;
            
            // 파일 내용 미리보기
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    previewBackupFile(backupData);
                    
                    // 복구 옵션 표시
                    document.getElementById('restore-options').classList.remove('hidden');
                    
                } catch (error) {
                    console.error('백업 파일 읽기 오류:', error);
                    alert('❌ 올바른 백업 파일이 아닙니다.\n\nJSON 형식의 백업 파일을 선택해주세요.');
                    clearSelectedBackupFile();
                }
            };
            reader.readAsText(file);
        }
        
        function previewBackupFile(backupData) {
            const preview = document.getElementById('backup-preview');
            const content = document.getElementById('backup-preview-content');
            
            let previewHTML = '';
            
            // 백업 정보 표시
            if (backupData._backup_info) {
                const info = backupData._backup_info;
                previewHTML += `<div class="mb-3 p-2 bg-blue-100 rounded">`;
                previewHTML += `<strong>백업 정보:</strong><br>`;
                previewHTML += `📅 생성일: ${new Date(info.created_at).toLocaleString()}<br>`;
                previewHTML += `📊 총 데이터: ${info.total_items}개<br>`;
                previewHTML += `📦 버전: ${info.version || 'N/A'}<br>`;
                previewHTML += `🏷️ 유형: ${info.type === 'emergency' ? '긴급백업' : '수동백업'}`;
                previewHTML += `</div>`;
            }
            
            // 테이블별 데이터 개수
            const tables = ['farm_customers', 'orders', 'products', 'farm_categories', 'order_sources', 'waitlist'];
            const tableNames = {
                'farm_customers': '고객',
                'orders': '주문', 
                'products': '상품',
                'farm_categories': '카테고리',
                'order_sources': '주문출처',
                'waitlist': '대기자'
            };
            
            previewHTML += `<div class="space-y-1">`;
            tables.forEach(table => {
                const data = backupData[table] || [];
                const count = Array.isArray(data) ? data.length : 0;
                const displayName = tableNames[table] || table;
                
                previewHTML += `<div class="flex justify-between items-center py-1 border-b border-gray-200">`;
                previewHTML += `<span>${displayName}:</span>`;
                previewHTML += `<span class="font-bold ${count > 0 ? 'text-green-600' : 'text-gray-400'}">${count}개</span>`;
                previewHTML += `</div>`;
            });
            previewHTML += `</div>`;
            
            content.innerHTML = previewHTML;
            preview.classList.remove('hidden');
        }
        
        function clearSelectedBackupFile() {
            // 파일 입력 초기화
            document.getElementById('backup-restore-input').value = '';
            
            // UI 요소들 숨기기
            document.getElementById('selected-file-info').classList.add('hidden');
            document.getElementById('backup-preview').classList.add('hidden');
            document.getElementById('restore-options').classList.add('hidden');
            
            // 복구 버튼 비활성화
            document.getElementById('restore-backup-data').disabled = true;
            
            console.log('🗑️ 선택된 백업 파일 제거됨');
        }
        
        function performDataRestore() {
            const fileInput = document.getElementById('backup-restore-input');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('백업 파일을 먼저 선택해주세요.');
                return;
            }
            
            // 복구 모드 확인
            const restoreMode = document.querySelector('input[name="restore-mode"]:checked').value;
            const backupBeforeRestore = document.getElementById('backup-current-before-restore').checked;
            
            // 확인 메시지
            const modeText = restoreMode === 'replace' ? '전체 교체' : '병합 모드';
            const confirmMessage = `⚠️ 데이터 복구를 시작합니다.\n\n📋 복구 모드: ${modeText}\n${backupBeforeRestore ? '💾 현재 데이터 자동 백업: 예' : '💾 현재 데이터 자동 백업: 아니요'}\n\n계속하시겠습니까?`;
            
            if (!confirm(confirmMessage)) {
                return;
            }
            
            // 현재 데이터 백업 (안전장치)
            if (backupBeforeRestore) {
                console.log('💾 복구 전 현재 데이터 자동 백업...');
                performJSONBackup(false); // 긴급백업이 아닌 일반 백업
                
                // 잠시 대기 후 복구 진행
                setTimeout(() => {
                    executeDataRestore(file, restoreMode);
                }, 1000);
            } else {
                executeDataRestore(file, restoreMode);
            }
        }
        
        function executeDataRestore(file, restoreMode) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    console.log('🔄 데이터 복구 시작...', restoreMode);
                    
                    const tables = ['farm_customers', 'orders', 'products', 'farm_categories', 'order_sources', 'waitlist'];
                    let restoredCount = 0;
                    let totalRestored = 0;
                    
                    tables.forEach(table => {
                        const backupTableData = backupData[table];
                        if (!Array.isArray(backupTableData)) {
                            console.log(`⚠️ ${table}: 백업 데이터 없음`);
                            return;
                        }
                        
                        let finalData = [];
                        
                        if (restoreMode === 'replace') {
                            // 전체 교체 모드
                            finalData = backupTableData;
                            console.log(`🔄 ${table}: ${backupTableData.length}개 데이터로 교체`);
                        } else {
                            // 병합 모드
                            const currentData = JSON.parse(localStorage.getItem(table) || '[]');
                            const existingIds = new Set(currentData.map(item => item.id));
                            
                            // 기존 데이터 유지
                            finalData = [...currentData];
                            
                            // 중복되지 않는 백업 데이터만 추가
                            backupTableData.forEach(item => {
                                if (!existingIds.has(item.id)) {
                                    finalData.push(item);
                                }
                            });
                            
                            console.log(`🔄 ${table}: 기존 ${currentData.length}개 + 신규 ${finalData.length - currentData.length}개 = 총 ${finalData.length}개`);
                        }
                        
                        // LocalStorage에 저장
                        localStorage.setItem(table, JSON.stringify(finalData));
                        totalRestored += finalData.length;
                        restoredCount++;
                    });
                    
                    console.log(`🎉 데이터 복구 완료! ${restoredCount}개 테이블, 총 ${totalRestored}개 데이터`);
                    
                    // 성공 메시지
                    const successMessage = `🎉 데이터 복구 완료!\n\n📊 복구된 테이블: ${restoredCount}개\n📈 총 데이터: ${totalRestored}개\n📋 모드: ${restoreMode === 'replace' ? '전체 교체' : '병합'}\n\n✅ 데이터가 성공적으로 복구되었습니다!`;
                    alert(successMessage);
                    
                    // UI 업데이트
                    updateBackupStats();
                    clearSelectedBackupFile();
                    
                    // 메인 페이지로 이동할지 물어보기
                    setTimeout(() => {
                        if (confirm('복구가 완료되었습니다.\n\n복구된 데이터를 확인하시겠습니까?')) {
                            // 주문 관리 탭으로 이동
                            document.getElementById('tab-orders').click();
                        }
                    }, 2000);
                    
                } catch (error) {
                    console.error('데이터 복구 실패:', error);
                    alert(`❌ 데이터 복구 실패!\n\n오류: ${error.message}\n\n백업 파일을 다시 확인해주세요.`);
                }
            };
            reader.readAsText(file);
        }
    </script>



</body>
</html>